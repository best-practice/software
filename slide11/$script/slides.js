if(typeof window.HTMLElement!=="undefined"){HTMLElement.prototype.toId=function(){return this}}else{if(typeof window.Element!=="undefined"){Element.prototype.toId=function(){return this}}}function stringHashCode(d){var e=0,b,c,a;if(d.length==0){return e}for(b=0,a=d.length;b<a;b++){c=d.charCodeAt(b);e=((e<<5)-e)+c;e|=0}return e}function getCookie__(c){if(document.cookie.length>0){var b,a=document.cookie.indexOf(c+"=");if(a!=-1){a=a+c.length+1;b=document.cookie.indexOf(";",a);if(b==-1){b=document.cookie.length}return unescape(document.cookie.substring(a,b))}}return""}function setCookie__(a,c,e,d){e=e||1;var b=new Date();b.setTime(b.getTime()+e*24*60*60*1000);d=d||"/";document.cookie=a+"="+escape(c)+";expires="+b.toGMTString()+";path="+d+";"}function delCookie__(b,c){if(document.cookie.length>0){var a=document.cookie.indexOf(b+"=");if(a!=-1){var d=new Date();d.setTime(d.getTime()-1);c=c||"/";document.cookie=b+"=;expires="+d.toGMTString()+";path="+c+";"}}}function location__(b){var a=document.createElement("a");a.href=b;if(a.host==""){a.href=a.href}return a}function getSynRequest(c,b){var a=null;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{if(window.ActiveXObject){a=new ActiveXObject("Microsoft.XMLHTTP")}}if(a!=null){if(b){a.open("POST",c,false);a.send(b)}else{a.open("GET",c,false);a.send(null)}if(a.status==200){return a.responseText}}return""}var SOFTWARE_PRJ_NAME="slide11";var SLIDE_CLASSES=["far-past","past","current","next","far-next"];var PM_TOUCH_SENSITIVITY=15;var SLIDE_HALF_WIDTH=450;var SLIDE_HALF_HEIGHT=350;var SLIDE_START_STYLE="narrow";var SLIDE_NO_TURNING=0;var SLIDE_PAGE_TAG=2;var SLIDE_PAGE_FORMAT="";var SLIDE_GROUP_ID="0";var SLIDE_HAS_PARENT=false;var PINP_IS_READY=false;var PINP_FIX_AUTO=0;var PINP_FIX_SIZE=false;var PINP_FIXSIZE_X=450;var PINP_FIXSIZE_Y=350;var PINP_FIX_FIT_X=0;var PINP_FIX_FIT_Y=0;var PINP_FIX_RATE=0;var PINP_EXTEND_STYLE=window.PINP_EXTEND_STYLE||"";var PINP_WEB_BASE=window.PINP_WEB_BASE||"";var PINP_PLUGINS={};var WEB_BROWSER_TYPE="";var WEB_BROWSER_VER="";var TRANS_END_FUNC="";var TRANS_CSS_NAME="transform";var slideEls=[];var curSlide=0;var startByReadonly_=false;var beenReadonly_=false;var noSlideFrame_=false;var noSlideTrans_=false;var noSlideGround_=false;var lastSelectedItem=null;var widgetSelector=null;var currSelectNode=[];var lastModifyPageId="";var lastModifyTime=new Date();var usedPlugins_={};var usedAssistor_={};var waitStopItem_=[];function setPageModified_(a){if(typeof a!="string"){var b=slideEls[curSlide];if(!b){return}a=b.id}lastModifyPageId=a;lastModifyTime=new Date()}function getSlideEl(a){if((a<0)||(a>=slideEls.length)){return null}else{return slideEls[a]}}function getCurrSelected(){return document.querySelector("article.current > div.in-design.curr-design")}var lastPopEditNode_=null;var lastPopEditId_=0;function isValidContent(b){if(!b){return false}var a=b.parentNode;while(a){if(a.nodeName=="ARTICLE"){return true}else{a=a.parentNode}}return false}var noneEditing_=["svg-paper","img-group","rotate-card","table-set","frame-build","code-block","hopop-menu","hopop-table"];function canInlineEdit(c){for(var a=0,b;b=noneEditing_[a];a++){if(c.classList.contains(b)){return false}}return true}function selectOneItem(d,c){if(d.classList.contains("scroll-hidden-default")&&(d.scrollTop!=0||d.scrollLeft!=0)){d.scrollTop=0;d.scrollLeft=0;setTimeout(function(){selectOneItem(d,c)},0);return}var j=document.getElementById("item-holder");var k=document.getElementById("item-resizer");if(!j||!k){return}var a=document.querySelectorAll("article > div.curr-design");for(var e=0,l;l=a[e];e++){l.classList.remove("curr-design");var m=l.style.zIndex;if(m){m=parseInt(m);if(m>=10000){l.style.zIndex=(m-10000)+""}}}d.classList.add("curr-design");lastSelectedItem=d;j.parentNode.removeChild(j);k.parentNode.removeChild(k);var g=d.innerHTML;d.appendChild(j);d.appendChild(k);k.style.left=(d.clientWidth-8)+"px";if(d.hasAttribute("_height")){k.style.top=(d.clientHeight-8)+"px";k.style.cursor="se-resize"}else{k.style.top="0px";k.style.cursor="e-resize"}j.style.display="block";k.style.display="block";var m=d.style.zIndex;if(m){m=parseInt(m);if(m>0&&m<10000){d.style.zIndex=(10000+m)+""}}showWidgetHint(d);if(!startByReadonly_){if(lastPopEditId_&&apiNode.getPopContent&&isValidContent(lastPopEditNode_)){var f=apiNode.getPopContent(lastPopEditId_);if(typeof f=="string"&&f!="<nochange/>"&&f!="<error/>"){lastPopEditNode_.innerHTML=f;if(lastPopEditNode_.classList.contains("ebook-title")){updateDocTitle(lastPopEditNode_)}if(lastPopEditNode_.classList.contains("rotate-txt")){apiNode.remakeContent(lastPopEditNode_)}apiNode.setPageModified()}}lastPopEditNode_=null;lastPopEditId_=0;var h=" "+d.getAttribute("_config")+" ";if(h.indexOf(" default-large-small ")>=0||h.indexOf(" large-small-default ")>=0||h.indexOf(" small-default-large ")>=0){if(c){g=c.innerHTML;lastPopEditNode_=c}else{var b=d.querySelector("div.rotate-txt");if(b&&b.parentNode===d){lastPopEditNode_=b;g=b.innerHTML}else{if(canInlineEdit(d)){lastPopEditNode_=d}}}if(lastPopEditNode_&&apiNode.setPopContent){lastPopEditId_=lastPopEditNode_.toId();apiNode.setPopContent(lastPopEditId_,g,d.className,PINP_SLIDE_FONT)}}if(!lastPopEditNode_&&apiNode.hidePopContent){apiNode.hidePopContent()}}}function hideMenuAndSelector(){if(widgetSelector){widgetSelector.style.display="none";while(currSelectNode.length){var a=currSelectNode.pop();a.classList.remove("multi-select")}}document.getElementById("slide-menu").style.display="none"}var showHintCount_=0;function hideWidgetHint(){var a=document.getElementById("position-hint");if(a){a.style.display="none";a.innerHTML=""}}function hideWidgetHint_(){if(showHintCount_>1){showHintCount_-=1;return}showHintCount_=0;hideWidgetHint()}function showWidgetHint(b,f){if(!b){b=getCurrSelected();if(!b){return}}if(!b.classList.contains("in-design")){return}var e=document.getElementById("position-hint");if(e){var d=parseInt(b.getAttribute("_width")||"0");if(d==0){return}var a=parseInt(b.getAttribute("_left")||"0");var g=parseInt(b.getAttribute("_top")||"0");var c=parseInt(b.getAttribute("_height")||"0");if(c==0){c=b.offsetHeight}e.style.display="block";e.innerHTML="("+a+", "+g+", "+d+", "+c+")"}if(f){showHintCount_+=1;setTimeout(hideWidgetHint_,f)}}function renewDesignPos(f){var a=parseInt(f.getAttribute("_left")||"0");var h=parseInt(f.getAttribute("_top")||"0");var d=parseInt(f.getAttribute("_width")||"200");var e=parseInt(f.getAttribute("_zindex")||"1000");var b=f.style.zIndex;f.style.left=(SLIDE_HALF_WIDTH+a)+"px";f.style.top=(SLIDE_HALF_HEIGHT+h)+"px";f.style.width=d+"px";if(b&&parseInt(b)>=10000){f.style.zIndex=(e+10000)+""}else{f.style.zIndex=e+""}var g=document.getElementById("item-resizer");if(f.hasAttribute("_height")){var c=parseInt(f.getAttribute("_height"));f.style.height=c+"px";if(g&&g.parentNode===f){g.style.left=(d-8)+"px";g.style.top=(c-8)+"px"}}else{if(g&&g.parentNode===f){g.style.left=(d-8)+"px";g.style.top="0px"}}}function initDesignPos(l){var e=parseInt(l.getAttribute("_zindex")||"1000");l.style.zIndex=e+"";if(e>=1){var j=parseInt(l.getAttribute("_left")||"0");var h=parseInt(l.getAttribute("_top")||"0");var a=parseInt(l.getAttribute("_width")||"200");l.style.left=(SLIDE_HALF_WIDTH+j)+"px";l.style.top=(SLIDE_HALF_HEIGHT+h)+"px";l.style.width=a+"px";if(l.hasAttribute("_height")){var c=parseInt(l.getAttribute("_height"));l.style.height=c+"px"}}var k=l.getAttribute("_rotate");if(k){l.style[TRANS_CSS_NAME]="rotate("+k+"deg)"}var f=l.getAttribute("_config")||"";f=f.trim();if(f){var g=f.split(/\u0020+/g);for(var d=0,m;m=g[d];d++){if(m.indexOf("default-")!=0){l.classList.add(m)}}}}function handleDomMouseMove(b){if(itemInMoving_){if(!beenReadonly_&&itemMovingNode_){var k=(b._clientX||b.clientX)-itemMoveFromX_;var j=(b._clientY||b.clientY)-itemMoveFromY_;if(itemMoveActed_){var h=parseInt(itemMovingNode_.getAttribute("_left")||"0")+k;var f=parseInt(itemMovingNode_.getAttribute("_top")||"0")+j;itemMovingNode_.style.left=(SLIDE_HALF_WIDTH+h)+"px";itemMovingNode_.style.top=(SLIDE_HALF_HEIGHT+f)+"px"}else{if(Math.abs(k)>=4||Math.abs(j)>=4){itemMoveActed_=true}}}}else{if(itemInResizing_){if(!beenReadonly_&&itemResizeNode_){var n=document.getElementById("item-resizer");if(n&&n.parentNode!==itemResizeNode_){n=null}var k=(b._clientX||b.clientX)-itemResizeFromX_;var c=parseInt(itemResizeNode_.getAttribute("_width")||"200");c=Math.max(c+k,16);itemResizeNode_.style.width=c+"px";if(n){n.style.left=(c-8)+"px"}if(itemResizeNode_.hasAttribute("_height")){var j=(b._clientY||b.clientY)-itemResizeFromY_;var d=parseInt(itemResizeNode_.getAttribute("_height"));d=Math.max(d+j,16);itemResizeNode_.style.height=d+"px";if(n){n.style.top=(d-8)+"px"}}}}else{if(selectedMoving_){var m=b._clientX||b.clientX;var l=b._clientY||b.clientY;var k=m-selectMoveFromX_,j=l-selectMoveFromY_;if(selectMoveActed_){var a=[],e=getCurrSelected();if(e){a.push(e)}else{Array.prototype.push.apply(a,currSelectNode)}for(var g=0,o;o=a[g];g++){var h=parseInt(o.getAttribute("_left"))+k;var f=parseInt(o.getAttribute("_top"))+j;o.style.left=(h+SLIDE_HALF_WIDTH)+"px";o.style.top=(f+SLIDE_HALF_HEIGHT)+"px"}}else{if(Math.abs(k)>=4||Math.abs(j)>=4){selectMoveActed_=true}}}else{if(inDomMouseMoving_){if(widgetSelector){var m=b._clientX||b.clientX;var l=b._clientY||b.clientY;var k=Math.abs(m-domMouseDnFromX_);var j=Math.abs(l-domMouseDnFromY_);if(k>5&&j>5){widgetSelector.style.left=Math.min(m,domMouseDnFromX_)+"px";widgetSelector.style.top=Math.min(l,domMouseDnFromY_)+"px";widgetSelector.style.width=k+"px";widgetSelector.style.height=j+"px";widgetSelector.style.display="block"}else{widgetSelector.style.display="none"}}}}}}}function isInteract__(b,i,j,c,a,g,d,f){var e=a+d,h=g+f;if(a>=j||e<=b){return 0}else{if(g>=c||h<=i){return 0}else{return 1}}}function isInclude__(b,i,j,c,a,g,d,f){var e=a+d,h=g+f;if(a>=b&&g>=i&&e<j&&h<c){return 1}else{return 0}}var selectJustMoved_=false;function clearInMovingCls(){var a=document.querySelectorAll("div.in-moving");for(var b=0,c;c=a[b];b++){c.classList.remove("in-moving")}}function handleDomMouseUp(v){try{var E=false;if(itemInMoving_||itemInResizing_){if(itemInMoving_){clearInMovingCls()}if(itemMoveActed_&&itemMovingNode_){var j=parseInt(itemMovingNode_.style.left)-SLIDE_HALF_WIDTH;var q=parseInt(itemMovingNode_.style.top)-SLIDE_HALF_HEIGHT;itemMovingNode_.setAttribute("_left",j+"");itemMovingNode_.setAttribute("_top",q+"");E=true}else{if(itemInResizing_&&itemResizeNode_){var s=parseInt(itemResizeNode_.style.width);itemResizeNode_.setAttribute("_width",s+"");if(itemResizeNode_.hasAttribute("_height")){var n=parseInt(itemResizeNode_.style.height);itemResizeNode_.setAttribute("_height",n+"")}renewDesignPos(itemResizeNode_);if(itemResizeNode_.classList.contains("pinp-shape")){buildShape(itemResizeNode_,true)}else{if(itemResizeNode_.classList.contains("svg-shape")){buildShape2(itemResizeNode_,true)}}E=true}}if(E){setPageModified_()}}else{if(selectedMoving_){clearInMovingCls();if(selectMoveActed_){var t=[],u=getCurrSelected();if(u){t.push(u)}else{Array.prototype.push.apply(t,currSelectNode)}for(var w=0,D;D=t[w];w++){var j=parseInt(D.style.left)-SLIDE_HALF_WIDTH;var q=parseInt(D.style.top)-SLIDE_HALF_HEIGHT;D.setAttribute("_left",j+"");D.setAttribute("_top",q+"")}if(t.length){setPageModified_()}E=true;selectJustMoved_=true;setTimeout(function(){selectJustMoved_=false},500)}}else{if(inDomMouseMoving_){var p=v._clientX||v.clientX;var o=v._clientY||v.clientY;var d=Math.abs(p-domMouseDnFromX_),a=Math.abs(o-domMouseDnFromY_);var l=null,m=false;if(widgetSelector&&d>5&&a>5){if(p<domMouseDnFromX_&&o<domMouseDnFromY_){m=true}l=getSlideEl(curSlide);E=true}if(l){var G={x:0,y:0};GetOffset_(l,G);p=Math.min(p,domMouseDnFromX_)-G.x-SLIDE_HALF_WIDTH;o=Math.min(o,domMouseDnFromY_)-G.y-SLIDE_HALF_HEIGHT;var z=p+d,f=o+a;var F=[];for(var w=0,D;D=l.children[w];w++){if(D.nodeName=="DIV"){var g=parseInt(D.getAttribute("_zindex")||"0");if(g>0){var A=parseInt(D.getAttribute("_left")||"0");var h=parseInt(D.getAttribute("_top")||"0");var C=parseInt(D.getAttribute("_width")||"0");var k=parseInt(D.getAttribute("_height")||"0");if(k==0){k=D.clientHeight}if(m){if(isInteract__(p,o,z,f,A,h,C,k)){F.push(D)}}else{if(isInclude__(p,o,z,f,A,h,C,k)){F.push(D)}}}}}while(currSelectNode.length){var D=currSelectNode.pop();D.classList.remove("multi-select")}if(F.length){apiNode.unselect();if(F.length==1){selectOneItem(F[0])}else{for(var w=0,D;D=F[w];w++){D.classList.add("multi-select");currSelectNode.push(D)}}}}}}}if(!E&&v.button==0){try{var c=false,r=v.target;while(r){if(r.id=="slide-menu"){c=true;break}r=r.parentNode}if(!c&&!v.shiftKey&&!v.altKey&&!v.ctrlKey){hideMenuAndSelector();apiNode.unselect()}}catch(B){}}}catch(B){}if(widgetSelector){widgetSelector.style.display="none"}itemInMoving_=false;itemMoveActed_=false;itemMovingNode_=null;itemInResizing_=false;itemResizeNode_=null;inDomMouseMoving_=false;selectedMoving_=false;selectMoveActed_=false}var inDomMouseMoving_=false;var domMouseDnFromX_=0;var domMouseDnFromY_=0;var selectedMoving_=false;var selectMoveActed_=false;var selectMoveFromX_=0;var selectMoveFromY_=0;function handleDomMouseDown(f){if(!beenReadonly_&&f.button==0&&!f.shiftKey&&!f.ctrlKey&&!f.altKey){if(!itemInMoving_&&!itemInResizing_){var e=null,c=f._target||f.target;while(c){if(c.nodeName=="ARTICLE"){if(e&&e.nodeName=="DIV"){if(e.classList.contains("curr-design")||e.classList.contains("multi-select")){selectedMoving_=true;selectMoveActed_=false;selectMoveFromX_=f._clientX||f.clientX;selectMoveFromY_=f._clientY||f.clientY}}break}e=c;c=c.parentNode}if(selectedMoving_){var a=document.querySelectorAll("div.in-design.curr-design,div.in-design.multi-select");for(var b=0,d;d=a[b];b++){d.classList.add("in-moving")}}else{inDomMouseMoving_=true;domMouseDnFromX_=f._clientX||f.clientX;domMouseDnFromY_=f._clientY||f.clientY}}}}var itemInMoving_=false;var itemMovingNode_=null;var itemMoveActed_=false;var itemMoveFromX_=0;var itemMoveFromY_=0;function itemMovMouseDown(b){if(!beenReadonly_&&b.button==0&&!b.ctrlKey&&!b.shiftKey&&!b.altKey){var a=b.target;if(a.id=="item-holder"&&a.parentNode.nodeName=="DIV"){itemInMoving_=true;itemMovingNode_=a.parentNode;itemMovingNode_.classList.add("in-moving");itemMoveActed_=false;itemMoveFromX_=b.clientX;itemMoveFromY_=b.clientY;b.stopPropagation()}}}var itemInResizing_=false;var itemResizeNode_=null;var itemResizeFromX_=0;var itemResizeFromY_=0;function itemResizeMouseDown(b){if(!beenReadonly_&&b.button==0&&!b.ctrlKey&&!b.shiftKey&&!b.altKey){var a=b.target;itemResizeNode_=getCurrSelected();if(a&&a.parentNode===itemResizeNode_){itemInResizing_=true;itemResizeFromX_=b.clientX;itemResizeFromY_=b.clientY;b.stopPropagation()}else{itemResizeNode_=null}}}function GetOffset_(a,b){if(!a){return}b.x+=a.offsetLeft;b.y+=a.offsetTop;GetOffset_(a.offsetParent,b)}function slidePageDragOver(a){if(!beenReadonly_){var c=false,b=getCookie__("drag_task");if(window.inPreview__==2){if(b=="run_js"||b=="put_img"||b=="put_audio"){c=true}}else{if(b=="run_cse"||b=="put_img"||b=="put_audio"){c=true}}if(c){a.preventDefault();a.dataTransfer.dropEffect="copy"}}}function slidePageDragDrop(u){if(beenReadonly_){return}var r;if(WEB_BROWSER_TYPE=="ie"){r=u.dataTransfer.getData("text")||""}else{r=u.dataTransfer.getData("text/args")||""}if(typeof r!="string"||r.indexOf("image,")!=0){return}r=r.slice(6);var w=r.split(",");if(w.length<2){return}var v="",z=-1,A=0,s=0;var C=getCookie__("drag_task");if(window.inPreview__==2){if(C=="put_img"){A=parseInt(w[0]);s=parseInt(w[1])}else{if(C!="run_js"){return}}v=w.slice(2).join(",")}else{z=parseInt(w[0]);v=w[1]}if(v){v=location__(v).pathname;if(v[0]!="/"){v="/"+v}}if(C=="run_cse"&&z==1){u.preventDefault();var B={x:0,y:0};GetOffset_(this,B);var k=(u._clientX||u.clientX)-B.x-SLIDE_HALF_WIDTH;var j=(u._clientY||u.clientY)-B.y-SLIDE_HALF_HEIGHT;apiNode.setDropMouseXY(k,j);apiNode.runCseFile(window.decodeURI(v)+".cse")}else{if(C=="put_img"&&(z==0||z==-1)){u.preventDefault();if(v.indexOf(CURR_USR_PATH)==0&&v.length>CURR_USR_PATH.length){v=v.slice(CURR_USR_PATH.length)}var m=slideEls[curSlide];if(m&&m.id){var k=u._clientX||u.clientX;var j=u._clientY||u.clientY;var h=false,d=getCurrSelected();if(d){var c=d.getBoundingClientRect();if(k>=c.left&&k<c.left+c.width&&j>=c.top&&j<c.top+c.height){if(d.classList.contains("pinp-image")||d.classList.contains("img-group")||d.classList.contains("rotate-card")){var n=d.querySelector("img");if(n&&(n.parentNode===d||n.parentNode.classList.contains("img-group"))){n.setAttribute("src",v);h=true}}else{if(d.classList.contains("svg-shape")){var l=d.querySelector("div.shape-canvas");if(l&&l.style.backgroundImage){var f="background-image:url("+v+");",q=window.getComputedStyle(l);if(q.backgroundColor){f="background-color:"+q.backgroundColor+";"+f}if(q.backgroundRepeat){f+="background-repeat:"+q.backgroundRepeat+";"}if(q.backgroundAttachment){f+="background-attachment:"+q.backgroundAttachment+";"}if(q.backgroundPosition){f+="background-position:"+q.backgroundPosition+";"}if(q.backgroundSize){f+="background-size:"+q.backgroundSize+";"}l.setAttribute("style",f);h=true}}else{if(d.classList.contains("pinp-shape")){var i=d.querySelectorAll("div.img-resource > img");if(i.length==1){d._hasBuild=false;var t=i[0].parentNode;t.innerHTML='<img src="'+v+'" onload="buildShape(this)" />';h=true}}else{if(d.classList.contains("pinp-goto")){d.setAttribute("_style","background-image:url('"+v+"')");d.style.backgroundImage="url('"+v+"')";h=true}}}}}}var a=m.id;if(h){apiNode.setPageModified(a)}else{var B={x:0,y:0};GetOffset_(this,B);k=k-B.x-SLIDE_HALF_WIDTH;j=j-B.y-SLIDE_HALF_HEIGHT;var o="<div _config='round0-default-round2-round3 default-thin-medium-thick solid-dotted-dashed default-shadow default-large-small default-looser-impacted p1-p2-p3-p0 center-right-default' class='pinp-image' _zindex='996' _left='"+k+"' _top='"+j+"' _width='400' _height='320'><img draggable='false' src='"+v+"' /><div class='rotate-txt'></div></div>\n";apiNode.innerHTML=o;if(apiNode.children.length){var e=apiNode.children[0];m.appendChild(e);n=e.querySelector("img");if(n.complete){e.setAttribute("_width",n.naturalWidth+"");e.setAttribute("_height",n.naturalHeight+"")}else{n.onload=function(){e.setAttribute("_width",n.naturalWidth+"");e.setAttribute("_height",n.naturalHeight+"");e.style.width=n.naturalWidth+"px";e.style.height=n.naturalHeight+"px";selectOneItem(e);apiNode.setPageModified(a)}}apiNode.initPagePos(a);apiNode.renewCurrSlide();selectOneItem(e);apiNode.setPageModified(a)}apiNode.innerHTML=""}}}else{if(C=="put_audio"&&z==0){u.preventDefault();if(v.indexOf(CURR_USR_PATH)==0&&v.length>CURR_USR_PATH.length){v=v.slice(CURR_USR_PATH.length)}var m=slideEls[curSlide];if(m&&m.id){var k=u._clientX||u.clientX;var j=u._clientY||u.clientY;var h=false,d=getCurrSelected();var b="",p=v.split(".").pop().toLowerCase();if(p=="mp3"){b="audio/mpeg"}else{if(p=="wav"){b="audio/wav"}else{if(p=="ogg"){b="audio/ogg"}}}if(d&&b){var c=d.getBoundingClientRect();if(k>=c.left&&k<c.left+c.width&&j>=c.top&&j<c.top+c.height){if(d.classList.contains("pinp-audio")){var g=d.querySelector("audio");if(g&&b){d.setAttribute("title",v.split("/").pop());g.innerHTML='<source src="'+v+'" type="'+b+'">';h=true}}}}var a=m.id;if(h){apiNode.setPageModified(a)}else{if(b){var B={x:0,y:0};GetOffset_(this,B);k=k-B.x-SLIDE_HALF_WIDTH;j=j-B.y-SLIDE_HALF_HEIGHT;var o="<div class='pinp-audio web-item' _config='default-hidden' _zindex='1000' _left='"+k+"' _top='"+j+"' _width='420' _height='50'><audio controls><source src='"+v+"' type='"+b+"'></audio></div>";apiNode.innerHTML=o;if(apiNode.children.length){var e=apiNode.children[0];m.appendChild(e);apiNode.initPagePos(a);apiNode.renewCurrSlide();selectOneItem(e);e.setAttribute("title",v.split("/").pop());e.play=function(){};apiNode.setPageModified(a)}apiNode.innerHTML=""}}}}else{if(C=="run_js"&&z==-1){u.preventDefault();var B={x:0,y:0};GetOffset_(this,B);var k=(u._clientX||u.clientX)-B.x-SLIDE_HALF_WIDTH;var j=(u._clientY||u.clientY)-B.y-SLIDE_HALF_HEIGHT;apiNode.newTaskConfig(false);apiNode.setDropMouseXY(k,j);apiNode.runJsFile(window.decodeURI(v)+".js")}}}}}function updateDocTitle(a){if(a&&a.classList.contains("ebook-title")){if(document.querySelector("article > div.ebook-title")===a){sArticleTitle=extractDocTitle(a);document.title=sArticleTitle;window.SLIDE_TITLE=sArticleTitle;apiNode.setWinTitle(sArticleTitle)}}}var divItemDblClick_=false;function tryEditWebItem(d,k){var h=null,c=null;for(var g=0,n;n=d.childNodes[g];g++){if(n.nodeType==1&&n.nodeName=="SCRIPT"&&(n.getAttribute("type")||"").toLowerCase()=="text/ractive"){h=n}else{if(n.nodeType==8){c=n}}}if(h&&c){var q=" "+d.className+" ";q=q.replace(" web-item "," ").replace(" web-panel "," ").replace(" row-panel "," ").replace(" col-panel "," ").replace(" absolute-pos "," ");q=q.replace(" in-design "," ").replace(" curr-design "," ").trim();if(k){var m=[];var f=q.split(" ");for(var e=f.length-1;e>=0;e--){var j=f[e];if(j){var l=usedAssistor_[j];if(l){m=l;break}}}var p=h.outerHTML+"\n<!--"+c.nodeValue+"-->";apiNode.editPlugin(d.toId(),true,p,"","","",m)}else{var o=h.getAttribute("_widget")||"";var a=h.getAttribute("_src")||"";apiNode.editPlugin(d.toId(),false,c.nodeValue,o,a,q,[])}}}function itemDivOnclick(b){var c=b._target||b.target;var f=c;var g=b.ctrlKey||b.altKey;var h=!g&&b.shiftKey;while(c){if(c.nodeName=="DIV"&&c.classList.contains("in-design")){if(g){if(!c.classList.contains("read-only")){if(beenReadonly_){alert("Slide does not in design mode, run in maximized window?")}else{if(c.classList.contains("web-item")){tryEditWebItem(c,b.ctrlKey)}else{apiNode.editContent(c.toId(),b.ctrlKey,f.toId())}}}}else{if(h&&widgetSelector){var a=getCurrSelected();if(a){if(a!==c){apiNode.unselect();while(currSelectNode.length){var i=currSelectNode.pop();i.classList.remove("multi-select")}a.classList.add("multi-select");currSelectNode.push(a);c.classList.add("multi-select");currSelectNode.push(c)}}else{if(currSelectNode.length){var d=currSelectNode.indexOf(c);if(d==-1){c.classList.add("multi-select");currSelectNode.push(c)}else{currSelectNode[d].classList.remove("multi-select");currSelectNode.splice(d,1)}}else{selectOneItem(c,(f.nodeName=="TD"&&c.classList.contains("table-set"))?f:undefined)}}document.getElementById("slide-menu").style.display="none";b.stopPropagation();return}else{if(!selectJustMoved_){var e=false;if(!h){e=divItemDblClick_;if(!e){divItemDblClick_=true;setTimeout(function(){divItemDblClick_=false},300)}}if(e&&apiNode.dbclickEdit){apiNode.dbclickEdit(c,f)}else{selectOneItem(c,(f.nodeName=="TD"&&c.classList.contains("table-set"))?f:undefined)}}}}break}else{if(c.nodeName=="TD"){f=c}c=c.parentNode}}if(!selectJustMoved_){hideMenuAndSelector()}b.stopPropagation()}function itemDivOnclick2(c){if(c.ctrlKey||c.altKey){var b=c._target||c.target;var a=b;while(b){if(b.nodeName=="DIV"&&b.classList.contains("in-design")){if(b.classList.contains("read-only")){break}if(beenReadonly_){alert("Slide does not in design mode, run in maximized window?")}else{apiNode.editContent(b.toId(),c.ctrlKey,a.toId())}break}else{if(b.nodeName=="TD"){a=b}b=b.parentNode}}}hideMenuAndSelector();apiNode.unselect();c.preventDefault();c.stopPropagation()}function itemDivOnMouseOn(a){if(!itemInMoving_&&!itemInResizing_&&!inDomMouseMoving_){if(this.classList.contains("curr-design")||this.classList.contains("multi-select")){showWidgetHint(this)}}}function itemDivOnMouseOut(a){if(this.classList.contains("in-design")){if(showHintCount_>=1){showHintCount_-=1}hideWidgetHint()}}function updateSlideClass(c,f){var e=getSlideEl(c);if(!e){return}if(f){var b=f=="current";var h=!beenReadonly_;if(b){e.ondragover=slidePageDragOver;e.ondrop=slidePageDragDrop;apiNode.unselect();if(widgetSelector){while(currSelectNode.length){var g=currSelectNode.pop();g.classList.remove("multi-select")}}}else{e.ondragover=null;e.ondrop=null}for(var d=0,g;g=e.children[d];d++){if(g.nodeName!="DIV"){continue}if(h&&b){g.classList.add("in-design");var a=parseInt(g.getAttribute("_zindex")||"1000");if(a>=1){g.onclick=itemDivOnclick}else{g.onclick=itemDivOnclick2}g.onmouseover=itemDivOnMouseOn;g.onmouseout=itemDivOnMouseOut}else{g.classList.remove("in-design");g.onclick=null;g.onmouseover=null;g.onmouseout=null}}}if(f){if(f=="current"&&!e.classList.contains("current")&&!window.PINP_DISABLE_NOTICE){if(window.parent.window&&window.onSwitchSlideOk){e.addEventListener(TRANS_END_FUNC,window.onSwitchSlideOk,false)}}e.classList.add(f)}for(var d in SLIDE_CLASSES){if(f!=SLIDE_CLASSES[d]){e.classList.remove(SLIDE_CLASSES[d])}}}function offsetOfSlide(c,b,a){if(!b){return false}if(b===a){return true}c.x+=b.offsetLeft;c.y+=b.offsetTop;alert(b.nodeName+":"+b.offsetLeft+"-"+b.offsetTop);return offsetOfSlide(c,b.offsetParent,a)}var hasRestoreAll_=false;function delayRestoreRes(e){var b;if(e){b=e.querySelectorAll("img[_lazy]")}else{b=document.querySelectorAll("img[_lazy]");hasRestoreAll_=true}for(var c=0,d;d=b[c];c++){var a=d.getAttribute("_lazy");d.removeAttribute("_lazy");d.setAttribute("src",a)}}function updateSlides_(){for(var a=0;a<slideEls.length;a++){if(a==curSlide){updateSlideClass(a,"current")}else{updateSlideClass(a)}}if(!beenReadonly_&&!SLIDE_HAS_PARENT){setCookie__("PINP_EDITING_ID"+SLIDE_GROUP_ID,stringHashCode(location.pathname)+"",0.2)}}function stopAllWebPlayer(f){while(waitStopItem_.length){var e=waitStopItem_.pop();e.onPlayDone=null;if(e.parentNode){if(f){var d=e.getAttribute("_prepost");if(d){var a=d.split("-");if(a.length>=4){var c=parseInt(a[2]);if(parseInt(a[2])==19){continue}}}}if(e.stop){e.stop()}else{if(e.pause){e.pause()}}}}}var slideInSwitchPage_=false;function updateSlides(h,d,j){if(slideInSwitchPage_&&!h){setTimeout(function(){updateSlides(true,d,j)},700);return}slideInSwitchPage_=true;setTimeout(function(){slideInSwitchPage_=false},700);hideMenuAndSelector();stopAllWebPlayer(true);for(var G=0;G<slideEls.length;G++){switch(G){case curSlide-2:updateSlideClass(G,"far-past");break;case curSlide-1:updateSlideClass(G,"past");break;case curSlide:updateSlideClass(G,"current");break;case curSlide+1:updateSlideClass(G,"next");break;case curSlide+2:updateSlideClass(G,"far-next");break;default:updateSlideClass(G);break}}if(!d){if(curSlide>0&&!hasRestoreAll_){delayRestoreRes()}triggerLeaveEvent(curSlide-1);triggerEnterEvent(curSlide)}enableSlideFrames(curSlide);enableSlideFrames(curSlide-1);enableSlideFrames(curSlide+2);if(window.onSlidePageChange){window.onSlidePageChange(curSlide)}var g=false;var e=getSlideEl(curSlide);if(e){if(document.readyState=="complete"){var l=e.getBoundingClientRect();var u=e.querySelectorAll("img[id]");for(var G=0,J;J=u[G];G++){var p=J.id||"";var H=p.slice(0,3);if(H=="ch-"||H=="se-"||H=="wd-"){var o=false,b=0;var k=e.querySelector('div[name="'+p+'"]');if(H=="ch-"||H=="se-"){b=-4;if(k){var B=k.querySelectorAll("table td");if(k.nodeName=="DIV"&&B.length==1){var K=B[0];var r=J.getAttribute("title")||"";if(r!=K.textContent){if(H=="ch-"){K.innerHTML="<h4>"+r+"</h4>"}else{K.innerHTML="<h5>"+r+"</h5>"}o=true}}}else{var r=J.getAttribute("title")||"";k=document.createElement("div");k.setAttribute("_zindex","1000");k.setAttribute("_left","0");k.setAttribute("_top","0");k.setAttribute("name",p);if(H=="ch-"){k.setAttribute("_config","default-hidden default-easein-spread-opacity maroon-purple-dimgray-white default-green-olive-teal");k.className="ebook-chapter build maroon-purple-dimgray-white in-design";k.setAttribute("_width","180");k.setAttribute("_height","60");k.innerHTML="<table class='ease-in'><tbody><tr><td><h4>"+r+"</h4></td></tr></tbody></table>"}else{k.setAttribute("_config","default-hidden default-easein-spread-opacity maroon-purple-dimgray-white olive-teal-default-green");k.className="ebook-section build maroon-purple-dimgray-white olive-teal-default-green in-design";k.setAttribute("_width","220");k.setAttribute("_height","40");k.innerHTML="<table class='ease-in'><tbody><tr><td><h5>"+r+"</h5></td></tr></tbody></table>"}e.appendChild(k);k.style.zIndex=1000;k.onclick=itemDivOnclick;k.onmouseover=itemDivOnMouseOn;k.onmouseout=itemDivOnMouseOut;o=true}}if(k){var c=J.getBoundingClientRect();var v=c.left-l.left;var t=c.top-l.top;t+=Math.floor((J.clientHeight-k.clientHeight)/2);v+=b;k.style.left=v+"px";k.style.top=t+"px";k.setAttribute("_left",Math.floor(v-SLIDE_HALF_WIDTH+0.5)+"");k.setAttribute("_top",Math.floor(t-SLIDE_HALF_HEIGHT+0.5)+"")}if(o&&!beenReadonly_){setPageModified_()}}}if(beenReadonly_){if(LAST_PREPOST_NODE){var n=LAST_PREPOST_NODE.querySelector("div > ul.build:only-child");if(!n&&LAST_PREPOST_NODE.classList.contains("build")){n=LAST_PREPOST_NODE}if(n){var q=n.querySelectorAll(".to-build");for(var z=0,A;A=q[z];z++){A.classList.remove("to-build")}}trySetPostBuild(LAST_PREPOST_NODE,false)}LAST_PREPOST_NODE=null}}if(SLIDE_PAGE_TAG&3){var D=(SLIDE_PAGE_TAG&1)==1?document.getElementById("page-tag"):document.getElementById("page-tag2");if((SLIDE_PAGE_TAG&4)||(curSlide>0&&curSlide>contentsIndex)){var F="javascript:apiNode.gotoPage(";if(contentsIndex<0){F+="0)"}else{F+=contentsIndex+")"}var w="",I="",s=SLIDE_PAGE_FORMAT;if(curSlide<bChapterSect2.length){w=bChapterSect2[curSlide][0];I=bChapterSect2[curSlide][1]}s=s.replace("%title%",sArticleTitle).replace("%index%",F).replace("%chapter%",w).replace("%section%",I).replace("%current%",(curSlide+1)+"").replace("%total%",slideEls.length+"");D.innerHTML=s}else{D.innerHTML=""}}if(beenReadonly_){var f=e.querySelectorAll("table.ease-in.to-build");for(var G=0,J;J=f[G];G++){J.classList.remove("to-build")}}var E=e.querySelectorAll("*.every-build");if(E.length){g=true;setTimeout(function(){for(var y=0,x;x=E[y];y++){if(x.nodeName=="IFRAME"){if(x.classList.contains("to-build")){continue}var L=x.contentWindow.window;if(L&&L.everyBuild){L.everyBuild()}}}},500)}if(beenReadonly_){var C=e.querySelectorAll("iframe.to-build");if(C.length){setTimeout(function(){for(var y=0,x;x=C[y];y++){var L=x.contentWindow.window;x.classList.remove("to-build");if(L&&L.buildContent){L.buildContent(true)}}},500)}}if(beenReadonly_){var a=e.querySelector('article > div[class*="prebuild-"]');if(a){var m=a.getAttribute("_prepost")||"";if(m&&m.split("-")[4]=="1"){setTimeout(function(){buildNextItem()},500)}}}}if(!beenReadonly_){if(!SLIDE_HAS_PARENT){setCookie__("PINP_EDITING_PG"+SLIDE_GROUP_ID,(curSlide+1)+"",0.2)}if(j){if(g){setTimeout(function(){j()},600)}else{j()}}}}function updateSlidesEx(){updateSlides(false,true)}var LAST_PREPOST_NODE=null;function onPrePostFinish(f){var e=f.target;e.removeEventListener(TRANS_END_FUNC,onPrePostFinish);var g=false;for(var a=0,d;d=e.classList[a];a++){if(d.indexOf("prebuild-")==0){e.classList.remove(d);g=true;break}else{if(d.indexOf("postbuild-")==0){e.classList.remove(d);break}}}if(g){LAST_PREPOST_NODE=e;var c=getSlideEl(curSlide);if(c){var b=c.querySelectorAll('article > div[class*="prebuild-"]');processJoinedStep(c,b,false)}}}function maxZLevelOfPage(){var d=getSlideEl(curSlide);if(!d){return 2000}var b=0;for(var c=0,e;e=d.children[c];c++){if(e.nodeName=="DIV"){var a=parseInt(e.getAttribute("_zindex")||"0");if(a>b){b=a}}}return b+1}function minZLevelOfPage(){var d=getSlideEl(curSlide);if(!d){return 1}var b=10000;for(var c=0,e;e=d.children[c];c++){if(e.nodeName=="DIV"){var a=parseInt(e.getAttribute("_zindex")||"10000");if(a>0&&a<b){b=a}}}if(a==1){return 1}else{return b-1}}function trySetPostBuild(f,d){var l=f.getAttribute("_prepost");if(l&&f.className.indexOf("prebuild-")==-1){var j=l.split("-");if(j.length>=4){var h=parseInt(j[2]);if(h>=1&&h<=17){var k=parseInt(f.getAttribute("_left")||"0");var i=parseInt(f.getAttribute("_top")||"0");var g=parseInt(f.getAttribute("_width")||"200");var e=parseInt(f.getAttribute("_height")||"0");if(!e){e=f.clientHeight||100}if(d){if(h!=11&&h!=12&&h!=13){f.addEventListener(TRANS_END_FUNC,onPrePostFinish,false);f.classList.add("postbuild-"+j[3])}}if(h<=4){if(h==1){f.style.marginTop=(-SLIDE_HALF_HEIGHT-i-e)+"px"}else{if(h==2){f.style.marginLeft=(SLIDE_HALF_WIDTH-k)+"px"}else{if(h==3){f.style.marginTop=(SLIDE_HALF_HEIGHT-i)+"px"}else{f.style.marginLeft=(-SLIDE_HALF_WIDTH-k-g)+"px"}}}f.style.opacity="0"}else{if(h<=8){if(h==5){f.style.marginLeft=(SLIDE_HALF_WIDTH-k)+"px";f.style.marginTop=(-SLIDE_HALF_HEIGHT-i-e)+"px";f.style[TRANS_CSS_NAME]="rotate(-215deg) scale(0.2,0.2)"}else{if(h==6){f.style.marginLeft=(SLIDE_HALF_WIDTH-k)+"px";f.style.marginTop=(SLIDE_HALF_HEIGHT-i)+"px";f.style[TRANS_CSS_NAME]="rotate(215deg) scale(0.2,0.2)"}else{if(h==7){f.style.marginLeft=(-SLIDE_HALF_WIDTH-k-g)+"px";f.style.marginTop=(SLIDE_HALF_HEIGHT-i)+"px";f.style[TRANS_CSS_NAME]="rotate(-215deg) scale(0.2,0.2)"}else{f.style.marginLeft=(-SLIDE_HALF_WIDTH-k-g)+"px";f.style.marginTop=(-SLIDE_HALF_HEIGHT-i-e)+"px";f.style[TRANS_CSS_NAME]="rotate(215deg) scale(0.2,0.2)"}}}f.style.opacity="0"}else{if(h==9){f.style[TRANS_CSS_NAME]="scale(0.1,0.1)";f.style.opacity="0"}else{if(h==10){f.style[TRANS_CSS_NAME]="rotate(1800deg) scale(0.1,0.1)";f.style.opacity="0"}else{if(h==11){var a=maxZLevelOfPage();f.style.zIndex=a+""}else{if(h==12){var a=minZLevelOfPage();f.style.zIndex=a+""}else{if(h==13){var c=f.getAttribute("_zindex");if(c){f.style.zIndex=c}f.style.opacity=""}else{if(h==14){f.style[TRANS_CSS_NAME]="scale(0.6,0.6)"}else{if(h==15){f.style[TRANS_CSS_NAME]="scale(0.8,0.8)"}else{if(h==16){f.style[TRANS_CSS_NAME]="scale(1.2,1.2)"}else{f.style[TRANS_CSS_NAME]="scale(1.4,1.4)"}}}}}}}}}}return true}}}return false}function trySetPreBuild(h){var g=h.getAttribute("_prepost");if(g){var c=g.split("-");if(c.length>=2){var e=parseInt(c[0]);if(e==0){if(c.length>=4&&parseInt(c[2])==13){h.style.opacity="0"}h.classList.add("prebuild-"+c[1])}else{if(e>=1&&e<=17){var a=parseInt(h.getAttribute("_left")||"0");var i=parseInt(h.getAttribute("_top")||"0");var f=parseInt(h.getAttribute("_width")||"200");var d=parseInt(h.getAttribute("_height")||"0");if(!d){d=h.clientHeight||100}if(e<=4){if(e==1){h.style.marginTop=(-SLIDE_HALF_HEIGHT-i-d)+"px"}else{if(e==2){h.style.marginLeft=(SLIDE_HALF_WIDTH-a)+"px"}else{if(e==3){h.style.marginTop=(SLIDE_HALF_HEIGHT-i)+"px"}else{h.style.marginLeft=(-SLIDE_HALF_WIDTH-a-f)+"px"}}}h.style.opacity="0"}else{if(e<=8){if(e==5){h.style.marginLeft=(SLIDE_HALF_WIDTH-a)+"px";h.style.marginTop=(-SLIDE_HALF_HEIGHT-i-d)+"px";h.style[TRANS_CSS_NAME]="rotate(-215deg) scale(0.2,0.2)"}else{if(e==6){h.style.marginLeft=(SLIDE_HALF_WIDTH-a)+"px";h.style.marginTop=(SLIDE_HALF_HEIGHT-i)+"px";h.style[TRANS_CSS_NAME]="rotate(215deg) scale(0.2,0.2)"}else{if(e==7){h.style.marginLeft=(-SLIDE_HALF_WIDTH-a-f)+"px";h.style.marginTop=(SLIDE_HALF_HEIGHT-i)+"px";h.style[TRANS_CSS_NAME]="rotate(-215deg) scale(0.2,0.2)"}else{h.style.marginLeft=(-SLIDE_HALF_WIDTH-a-f)+"px";h.style.marginTop=(-SLIDE_HALF_HEIGHT-i-d)+"px";h.style[TRANS_CSS_NAME]="rotate(215deg) scale(0.2,0.2)"}}}h.style.opacity="0"}else{if(e==9){h.style[TRANS_CSS_NAME]="scale(0.1,0.1)";h.style.opacity="0"}else{if(e==10){h.style[TRANS_CSS_NAME]="rotate(1800deg) scale(0.1,0.1)";h.style.opacity="0"}else{if(e<=13){if(e==13){h.style.opacity="0"}}else{if(e==14){h.style[TRANS_CSS_NAME]="scale(0.6,0.6)"}else{if(e==15){h.style[TRANS_CSS_NAME]="scale(0.8,0.8)"}else{if(e==16){h.style[TRANS_CSS_NAME]="scale(1.2,1.2)"}else{h.style[TRANS_CSS_NAME]="scale(1.4,1.4)"}}}}}}}}}}h.classList.add("prebuild-"+c[1])}}}function removePrebuildCls(c){for(var a=0,b;b=c.classList[a];a++){if(b.indexOf("prebuild-")==0){c.classList.remove(b);break}}}function tryPauseWebPlay(e){if(e.classList.contains("web-item")&&e.play){var d=e.getAttribute("_prepost");if(d&&e.className.indexOf("prebuild-")==-1){var a=d.split("-");if(a.length>=4){var c=parseInt(a[2]);if(c!=19){if(e.pause){e.pause()}}}}}}function setupWebPlay(a){waitStopItem_.push(a);a.onPlayDone=function(){a.onPlayDone=null;var e=getSlideEl(curSlide);if(e){var c=false,b=a.parentNode;while(b){if(b===e){c=true;break}b=b.parentNode}if(c){var d=e.querySelectorAll('article > div[class*="prebuild-"]');processJoinedStep(e,d,false)}}}}function processJoinedStep(e,l,o){var f=0;for(var m=0,q;q=l[m];m++){var r=q.getAttribute("_prepost")||"";if(!r){break}if(m==0&&!o&&r.split("-")[4]!="1"){break}else{if(r.indexOf("0-")==0){if(LAST_PREPOST_NODE&&LAST_PREPOST_NODE!==q){var n=LAST_PREPOST_NODE;LAST_PREPOST_NODE=null;setTimeout(function(){if(!trySetPostBuild(n,true)){tryPauseWebPlay(n)}},0)}f+=1;removePrebuildCls(q);trySetPostBuild(q,true)}else{break}}}for(var m=f,q;q=l[m];m++){var b=q.getAttribute("_prepost")||"";if(b){var k=false;if(b.split("-")[4]=="1"){var p=false;if(b.indexOf("11-")==0){var c=maxZLevelOfPage();q.style.zIndex=c+"";k=true}else{if(b.indexOf("12-")==0){var c=minZLevelOfPage();q.style.zIndex=c+"";k=true}else{if(b.indexOf("13-")==0){var d=q.getAttribute("_zindex");if(d){q.style.zIndex=d}q.style.opacity="";k=true}else{if(b.indexOf("18-")==0){if(q.classList.contains("web-item")&&q.play){setupWebPlay(q);k=true;p=true}}}}}if(k){if(LAST_PREPOST_NODE&&LAST_PREPOST_NODE!==q){var j=LAST_PREPOST_NODE;LAST_PREPOST_NODE=null;setTimeout(function(){if(!trySetPostBuild(j,true)){tryPauseWebPlay(j)}},0)}removePrebuildCls(q);LAST_PREPOST_NODE=q;if(p){var h=parseInt(b.split("-")[1]||"3");q.play(h)}else{var a=e.querySelectorAll('article > div[class*="prebuild-"]');processJoinedStep(e,a,false)}return true}q.addEventListener(TRANS_END_FUNC,onPrePostFinish,false);if(LAST_PREPOST_NODE&&LAST_PREPOST_NODE!==q){var g=LAST_PREPOST_NODE;LAST_PREPOST_NODE=null;setTimeout(function(){if(!trySetPostBuild(g,true)){tryPauseWebPlay(g)}},0)}q.style.marginLeft="";q.style.marginTop="";q.style.opacity="";q.style[TRANS_CSS_NAME]="";return true}else{break}}else{break}}if(f){return true}else{return false}}function buildNextItem(){if(!beenReadonly_){return false}var k,d=getSlideEl(curSlide);if(!d){return false}var m=false;if(LAST_PREPOST_NODE){var i=LAST_PREPOST_NODE.querySelector("div > ul.build:only-child");if(!i&&LAST_PREPOST_NODE.classList.contains("build")){i=LAST_PREPOST_NODE}if(i){k=i.querySelector(".to-build");if(k){k.classList.remove("to-build");return true}}if(trySetPostBuild(LAST_PREPOST_NODE,true)){m=true}else{tryPauseWebPlay(LAST_PREPOST_NODE)}LAST_PREPOST_NODE=null}k=d.querySelector('article > div[class*="prebuild-"]');if(k){var i=k.querySelector("div > ul.build:only-child");if(!i&&k.classList.contains("build")){i=k}if(i){removePrebuildCls(k);k.style.marginLeft="";k.style.marginTop="";k.style.opacity="";k.style[TRANS_CSS_NAME]="";var h=i.querySelector(".to-build");if(h){LAST_PREPOST_NODE=k;h.classList.remove("to-build");return true}else{k=d.querySelector('article > div[class*="prebuild-"]')}}if(k){var a=k.getAttribute("_prepost");if(a){var j=false,g=false,l=false;if(a.indexOf("0-")==0){l=true}else{if(a.indexOf("11-")==0){var b=maxZLevelOfPage();k.style.zIndex=b+"";g=true}else{if(a.indexOf("12-")==0){var b=minZLevelOfPage();k.style.zIndex=b+"";g=true}else{if(a.indexOf("13-")==0){var c=k.getAttribute("_zindex");if(c){k.style.zIndex=c}k.style.opacity="";g=true}else{if(a.indexOf("18-")==0){if(k.classList.contains("web-item")&&k.play){setupWebPlay(k);g=true;j=true}}}}}}if(g){removePrebuildCls(k);LAST_PREPOST_NODE=k;if(j){var e=parseInt(a.split("-")[1]||"3");k.play(e)}else{var f=d.querySelectorAll('article > div[class*="prebuild-"]');processJoinedStep(d,f,false)}return true}if(l){var f=d.querySelectorAll('article > div[class*="prebuild-"]');if(f.length&&f[0]===k){processJoinedStep(d,f,true);return true}}}k.addEventListener(TRANS_END_FUNC,onPrePostFinish,false);k.style.marginLeft="";k.style.marginTop="";k.style.opacity="";k.style[TRANS_CSS_NAME]="";return true}}k=d.querySelector(".to-build");if(!k){return m}else{k.classList.remove("to-build");return true}}function cancelInlineEdit(){if(!startByReadonly_&&apiNode.hidePopContent){apiNode.hidePopContent();lastPopEditNode_=null;lastPopEditId_=0}}function prevSlide(){if(!PINP_IS_READY){return}if(curSlide>0){cancelInlineEdit();curSlide--;updateSlides()}}function nextSlide(){if(!PINP_IS_READY){return}if(buildNextItem()){return}if(curSlide<slideEls.length-1){cancelInlineEdit();curSlide++;updateSlides()}}function firstSlide(){if(!PINP_IS_READY){return}if(curSlide!=0){cancelInlineEdit();curSlide=0;updateSlides()}}function lastSlide(){if(!PINP_IS_READY){return}var a=slideEls.length-1;if(a>=0&&curSlide!=a){cancelInlineEdit();curSlide=a;updateSlides()}}function disableSlideFrames(e){var b=getSlideEl(e);if(!b){return}var d=b.getElementsByTagName("iframe");for(var a=0,c;c=d[a];a++){c.setAttribute("src","about:blank")}}function enableSlideFrames(e){var b=getSlideEl(e);if(!b){return}var d=b.getElementsByTagName("iframe");for(var a=0,c;c=d[a];a++){enableFrame(c)}}function enableFrame(c){var b=c.getAttribute("src");var a=c.getAttribute("_src");if(a&&b!=a&&a!="about:blank"){c.setAttribute("src",a)}}function setupFrames(){var f=document.querySelectorAll("article > div");for(var a=0,b;b=f[a];a++){initDesignPos(b)}if(beenReadonly_){f=document.querySelectorAll("article > div[_prepost]");for(var a=0,b;b=f[a];a++){trySetPreBuild(b)}}var e=document.querySelectorAll("iframe");for(var a=0,d;d=e[a];a++){d.setAttribute("_src",d.getAttribute("src"));d.setAttribute("src","about:blank")}var c=curSlide;if(PINP_IS_READY){enableSlideFrames(c);enableSlideFrames(c+1);enableSlideFrames(c+2)}else{setTimeout(function(){enableSlideFrames(c);enableSlideFrames(c+1);enableSlideFrames(c+2)},400)}}function triggerEnterEvent(e){var d=getSlideEl(e);if(!d){return}var b=d.getAttribute("onslideenter");if(b){var c=new Function(b);setTimeout(function(){c.call(d)},0)}var a=document.createEvent("Event");a.initEvent("slideenter",true,true);a.slideNumber=e+1;d.dispatchEvent(a)}function triggerLeaveEvent(e){var c=getSlideEl(e);if(!c){return}var d=c.getAttribute("onslideleave");if(d){var b=new Function(d);setTimeout(function(){b.call(c)},0)}var a=document.createEvent("Event");a.initEvent("slideleave",true,true);a.slideNumber=e+1;c.dispatchEvent(a)}function handleDocKeyDown(a){switch(a.keyCode){case 39:case 40:case 13:case 32:case 34:if(!beenReadonly_&&a.ctrlKey&&!a.shiftKey&&!a.altKey&&(a.keyCode==39||a.keyCode==40)){if(a.keyCode==39){moveDesignItem_(1,0)}else{moveDesignItem_(0,1)}showWidgetHint(null,4000)}else{if(!beenReadonly_&&!a.ctrlKey&&!a.shiftKey&&a.altKey&&(a.keyCode==39||a.keyCode==40)){if(a.keyCode==39){resizeDesignItem_(1,0)}else{resizeDesignItem_(0,1)}showWidgetHint(null,4000)}else{if(!PINP_FIX_AUTO){nextSlide()}}}if(a.preventDefault){a.preventDefault()}break;case 37:case 38:case 33:if(!beenReadonly_&&a.ctrlKey&&!a.shiftKey&&!a.altKey&&(a.keyCode==37||a.keyCode==38)){if(a.keyCode==37){moveDesignItem_(-1,0)}else{moveDesignItem_(0,-1)}showWidgetHint(null,4000)}else{if(!beenReadonly_&&!a.ctrlKey&&!a.shiftKey&&a.altKey&&(a.keyCode==37||a.keyCode==38)){if(a.keyCode==37){resizeDesignItem_(-1,0)}else{resizeDesignItem_(0,-1)}showWidgetHint(null,4000)}else{if(!PINP_FIX_AUTO){prevSlide()}}}if(a.preventDefault){a.preventDefault()}break;case 36:if(a.ctrlKey&&!a.shiftKey&&!a.altKey){if(!PINP_FIX_AUTO){firstSlide()}if(a.preventDefault){a.preventDefault()}}break;case 35:if(a.ctrlKey&&!a.shiftKey&&!a.altKey){if(!PINP_FIX_AUTO){lastSlide()}if(a.preventDefault){a.preventDefault()}}break;case 27:hideMenuAndSelector();if(a.preventDefault){a.preventDefault()}break;case 113:apiNode.swithScreen();break;case 46:var c=false,o=false;if(!beenReadonly_){if(!a.shiftKey&&!a.altKey){o=!a.ctrlKey;c=true}}if(c){if(o&&!confirm("do you want delete selected widget?")){return}if(a.preventDefault){a.preventDefault()}apiNode.delDesignItem();if(widgetSelector){var p=false;while(currSelectNode.length){var q=currSelectNode.pop();q.classList.remove("multi-select");if(q.classList.contains("in-design")){q.parentNode.removeChild(q);p=true}}if(p){setPageModified_()}}}break;case 67:if(!beenReadonly_&&a.ctrlKey&&!a.shiftKey&&!a.altKey){if(a.preventDefault){a.preventDefault()}apiNode.copyItem(true)}break;case 88:if(!beenReadonly_&&a.ctrlKey&&!a.shiftKey&&!a.altKey){if(a.preventDefault){a.preventDefault()}if(apiNode.copyItem(true)){if(!apiNode.delDesignItem()){if(widgetSelector){var p=false;while(currSelectNode.length){var q=currSelectNode.pop();q.classList.remove("multi-select");if(q.classList.contains("in-design")){q.parentNode.removeChild(q);p=true}}if(p){setPageModified_()}}}}}break;case 86:if(!beenReadonly_&&a.ctrlKey&&!a.shiftKey&&!a.altKey){if(a.preventDefault){a.preventDefault()}apiNode.pasteItem()}break;case 9:if(!beenReadonly_&&a.ctrlKey&&!a.altKey){if(a.preventDefault){a.preventDefault()}var b=[],n=document.querySelectorAll("article.current > div.in-design");for(var f=0,q;q=n[f];f++){if(parseInt(q.getAttribute("_zindex")||"0")>0){b.push(q)}}if(b.length==1){selectOneItem(b[0])}else{if(b.length>1){var k=[];for(var f=0,q;q=b[f];f++){var l=false;var e=parseInt(q.style.top);var h=parseInt(q.style.left);for(var d=0,g;g=k[d];d++){var r=g[0];if(e<r){k.splice(d,0,[e,h,q]);l=true;break}else{if(e==r){if(h<g[1]){k.splice(d,0,[e,h,q]);l=true;break}}}}if(!l){k.push([e,h,q])}}var m=null;for(var f=0,q;q=k[f];f++){q=q[2];if(q.classList.contains("curr-design")){if(a.shiftKey){var j=f-1;if(j<0){j=k.length-1}m=k[j][2]}else{var j=f+1;if(j>=k.length){j=0}m=k[j][2]}break}}if(!m){m=k[0][2]}selectOneItem(m)}}}break}}var touchDX=0;var touchDY=0;var touchStartX=0;var touchStartY=0;function handleTouchStart(a){if(a.touches.length==1){touchDX=0;touchDY=0;touchStartX=a.touches[0].pageX;touchStartY=a.touches[0].pageY;document.body.addEventListener("touchmove",handleTouchMove,true);document.body.addEventListener("touchend",handleTouchEnd,true)}}function handleTouchMove(a){if(a.touches.length>1){cancelTouch()}else{touchDX=a.touches[0].pageX-touchStartX;touchDY=a.touches[0].pageY-touchStartY}}function handleTouchEnd(c){var b=Math.abs(touchDX);var a=Math.abs(touchDY);if((b>PM_TOUCH_SENSITIVITY)&&(a<(b*2/3))){if(touchDX>0){prevSlide()}else{nextSlide()}}cancelTouch()}function cancelTouch(){document.body.removeEventListener("touchmove",handleTouchMove,true);document.body.removeEventListener("touchend",handleTouchEnd,true)}function isSlideReadonly(){if(window.SLIDE_RELEASED){return true}else{if(window.inPreview__){if(window.inPreview__!=2){return true}}}if(window.screenX==0&&window.screenY==0&&Math.abs(screen.width-window.innerWidth)<=1&&Math.abs(screen.height-window.innerHeight)<=1){return true}else{return false}}function moveDesignItem_(a,h){a=a||0;h=h||0;if(!beenReadonly_&&(a||h)){var e=getCurrSelected();if(e){var g=parseInt(e.getAttribute("_left")||"0");var f=parseInt(e.getAttribute("_top")||"0");e.setAttribute("_left",(g+a)+"");e.setAttribute("_top",(f+h)+"");renewDesignPos(e);setPageModified_()}else{if(widgetSelector){var b=false;for(var c=0,d;d=currSelectNode[c];c++){if(d.classList.contains("in-design")){var g=parseInt(d.getAttribute("_left")||"0");var f=parseInt(d.getAttribute("_top")||"0");d.setAttribute("_left",(g+a)+"");d.setAttribute("_top",(f+h)+"");renewDesignPos(d);b=true}}if(b){setPageModified_()}}}}}function resizeDesignItem_(a,e){a=a||0;e=e||0;if(!beenReadonly_&&(a||e)){var d=getCurrSelected();if(d){var c=parseInt(d.getAttribute("_width")||"0");var b=parseInt(d.getAttribute("_height")||"0");if(!c){return}if(b){d.setAttribute("_width",(c+a)+"");d.setAttribute("_height",(b+e)+"")}else{if(a==0){return}d.setAttribute("_width",(c+a)+"")}renewDesignPos(d);if(d.classList.contains("pinp-shape")){buildShape(d,true)}else{if(d.classList.contains("svg-shape")){buildShape2(d,true)}}setPageModified_()}}}function onDelPreLnNum(b){b.preventDefault();b.stopPropagation();document.getElementById("slide-menu").style.display="none";var a=getCurrSelected();if(!a||!a.classList.contains("code-block")){return}var c=a.querySelector("pre");if(c){c.removeAttribute("class");apiNode.setPageModified()}}function onAddPreLnNum(d){d.preventDefault();d.stopPropagation();document.getElementById("slide-menu").style.display="none";var c=getCurrSelected();if(!c||!c.classList.contains("code-block")){return}var e=c.querySelector("pre");if(e){var b=prompt("Input first line number","1");if(b){b=b.trim();if(b){var a=parseInt(b);if((a+"")===b){e.className="linenums:"+b;apiNode.setPageModified()}}}}}function onSetGotoPage(c){c.preventDefault();c.stopPropagation();document.getElementById("slide-menu").style.display="none";var b=getCurrSelected();if(!b||!b.classList.contains("pinp-goto")){return}var a=b.getAttribute("_widget")||"1";var a=prompt("Input page number (or offset of page)",a);if(a){a=a.trim();if(a){b.setAttribute("_widget",a);apiNode.setPageModified()}}}function onSetTimeDelay(c){c.preventDefault();c.stopPropagation();document.getElementById("slide-menu").style.display="none";var b=getCurrSelected();if(!b||!b.classList.contains("pinp-delay")){return}var a=b.getAttribute("_widget")||"2.0";var a=prompt("Input delay seconds",a);if(a){a=a.trim();if(a){var d=parseFloat(a);if(typeof d=="number"){b.setAttribute("_widget",d+"");apiNode.setPageModified()}}}}function changeDesignCls(a){a.preventDefault();a.stopPropagation();document.getElementById("slide-menu").style.display="none";var j=a.target;while(j){if(j.nodeName=="LI"){break}j=j.parentNode}if(!j){return}var p=j.getAttribute("_config")||"";var c=getCurrSelected();if(!c){return}var l=p.split("-"),b=l.length;if(b>=2){l.push(l.shift());var m=l.join("-");var k=c.getAttribute("_config")||"";if(k){k=" "+k+" "}k=k.replace(" "+p+" "," "+m+" ").trim();c.setAttribute("_config",k);c.classList.remove(p);if(m.indexOf("default-")!=0){c.classList.add(m)}for(var d=0,o;o=c.classList[d];d++){var f=pluginOf(o,true);if(f&&f[m]){try{f[m](c)}catch(h){}break}}var g=c.querySelector("iframe.build");if(g&&g.parentNode===c){var n=g.contentWindow.window;if(n&&n.buildContent){n.buildContent()}}apiNode.setPageModified()}}function setItemScreenStyle(b,c,a){if(!b){return}b.classList.remove("taller-screen");b.classList.remove("taller-screen2");b.classList.remove("taller-screen3");b.classList.remove("taller-screen4");b.classList.remove("taller-screen5");if(!a){b.classList.remove("wide-screen")}else{b.classList.add("wide-screen")}if(c){b.classList.add(c)}}function setSlideScreenStyle(f){if(f=="wide"&&SLIDE_HALF_WIDTH==550){return}else{if(f=="narrow"&&SLIDE_HALF_WIDTH==450){return}}var a=document.querySelector("section.slides");if(a){a.style.display="none"}if(f=="wide"){SLIDE_HALF_WIDTH=550;SLIDE_HALF_HEIGHT=350;var e=document.querySelectorAll("section.slides > article");for(var c=0,d;d=e[c];c++){setItemScreenStyle(d,"",true)}setItemScreenStyle(document.getElementById("prev-slide-area"),"",true);setItemScreenStyle(document.getElementById("next-slide-area"),"",true);setItemScreenStyle(document.getElementById("page-tag"),"",true);setItemScreenStyle(document.getElementById("page-tag2"),"",true)}else{if(f=="narrow"){SLIDE_HALF_WIDTH=450;SLIDE_HALF_HEIGHT=350;var e=document.querySelectorAll("section.slides > article");for(var c=0,d;d=e[c];c++){setItemScreenStyle(d,"",false)}setItemScreenStyle(document.getElementById("prev-slide-area"),"",false);setItemScreenStyle(document.getElementById("next-slide-area"),"",false);setItemScreenStyle(document.getElementById("page-tag"),"",false);setItemScreenStyle(document.getElementById("page-tag2"),"",false)}else{SLIDE_HALF_WIDTH=550;var b="",h=window.screen.availHeight;if(h>=800){SLIDE_HALF_HEIGHT=400;b="taller-screen5"}else{if(h>=780){SLIDE_HALF_HEIGHT=390;b="taller-screen4"}else{if(h>=760){SLIDE_HALF_HEIGHT=380;b="taller-screen3"}else{if(h>=740){SLIDE_HALF_HEIGHT=370;b="taller-screen2"}else{if(h>=720){SLIDE_HALF_HEIGHT=360;b="taller-screen"}else{SLIDE_HALF_HEIGHT=350}}}}}var e=document.querySelectorAll("section.slides > article");for(var c=0,d;d=e[c];c++){setItemScreenStyle(d,b,true)}setItemScreenStyle(document.getElementById("prev-slide-area"),b,true);setItemScreenStyle(document.getElementById("next-slide-area"),b,true);setItemScreenStyle(document.getElementById("page-tag"),b,true);setItemScreenStyle(document.getElementById("page-tag2"),b,true)}}var g=document.querySelectorAll("article > div");for(var c=0,d;d=g[c];c++){initDesignPos(d)}if(a){a.style.display="block"}}var sArticleTitle="";var bChapterSects=[];var bChapterSect2=[];var bTableCharts=[];var contentsIndex=-1;function resetChapterSects(a){bChapterSects=[];bChapterSect2=[];bTableCharts=[];contentsIndex=-1;var f="",l="";var p=-1;for(var h=0,o;o=a[h];h++){var m=[];for(var e=0,k;k=o.children[e];e++){if(k.nodeName=="DIV"){if(k.classList.contains("ebook-chapter")){f=k.textContent.trim();m.push("chapter",f)}else{if(k.classList.contains("ebook-section")){l=k.textContent.trim();m.push("section",l)}else{if(contentsIndex<0&&k.classList.contains("ebook-contents")){contentsIndex=h}}}}}bChapterSects.push(m);bChapterSect2.push([f,l]);var j=o.querySelectorAll("img[id]");for(var d=0,g;g=j[d];d++){var c=g.id||"";if(c.slice(0,3)=="wd-"){var n=g.getAttribute("title")||"";if(n){bTableCharts.push([h,n,c])}}}}}function setupSvgPaper(b){var a;if(b){a=b.querySelectorAll("div.svg-shape")}else{a=document.querySelectorAll("div.svg-paper > div.svg-shape")}for(var e=0,k;k=a[e];e++){var h=parseInt(k.getAttribute("_left")||"0");var g=parseInt(k.getAttribute("_top")||"0");var c=parseInt(k.getAttribute("_width")||"100");var d=parseInt(k.getAttribute("_height")||"60");k.style.left=h+"px";k.style.top=g+"px";k.style.width=c+"px";k.style.height=d+"px";var f=parseInt(k.getAttribute("_zindex")||"1000");k.style.zIndex=f+"";var j=k.getAttribute("_rotate");if(j){k.style[TRANS_CSS_NAME]="rotate("+j+"deg)"}}}function hideMaskArea(){var a=document.getElementById("dialog-mask");if(a){a.clipString=undefined;a.innerHTML="";a.style.display="none"}}function saveWidgetStyle(){var a=document.querySelectorAll("article > div.pinp-gradient[style]");for(var b=0,c;c=a[b];b++){c.setAttribute("_style",c.getAttribute("style"))}}function extractDocTitle(e){var d,c=e.cloneNode(true);var g=c.querySelector("br");if(g){var f=g.parentNode;for(var b=f.childNodes.length-1;b>=0;b--){var a=f.childNodes[b];f.removeChild(a);if(a===g){break}}d=c.textContent}else{d=e.textContent}return d.trim().slice(0,128)}function pluginOf(a,c){if(!a){return null}var b=PINP_PLUGINS[a];if(b){if(!b.title){return null}}else{b={};if(!c){PINP_PLUGINS[a]=b}}return b}function pinpPrettyLoaded(){if(startByReadonly_){prettyPrint()}}function resetRootSect(g,b){if(!b){g.style.width=window.innerWidth+"px";g.style.height=Math.max(window.innerHeight,700)+"px"}var d=g.getBoundingClientRect();var a=Math.floor(d.left+d.width/2);var f=Math.floor(d.top+d.height/2);var e=document.getElementById("page-tag");if(e){e.style.left=a+"px";e.style.top=f+"px"}var c=document.getElementById("page-tag2");if(c){c.style.left=a+"px";c.style.top=f+"px"}}function notifyCache(a,c){var d=c.split("/")[1]||"";if(d.indexOf("u-")!=0&&window.parent.window&&window.parent.window!==window){var b="[PINPSLIDE_11]"+JSON.stringify({method:"cache",param:[a,c]});window.parent.window.postMessage(b,"*")}}function jumpInDoc(e){var b=e.target,d=null;while(b){if(b.nodeName=="DIV"&&b.classList.contains("pinp-goto")){d=b;break}else{b=b.parentNode}}if(d){var c=d.getAttribute("_widget")||"1";var a=c.slice(0,1);var f=1;if(a=="+"){f=curSlide+parseInt(c.slice(1))}else{if(a=="-"){f=curSlide-parseInt(c.slice(1))}else{f=parseInt(c)-1}}apiNode.gotoPage(f)}}var lastGotoPage_=1;function parseParam(e){if(e){e=e.slice(1)}var h={};var a=e.split("&");var g=a.length-1;while(g>=0){var c=a[g].split("=");g-=1;var f=(c[0]||"").trim();if(f){if(c.length==1){h[f]=""}else{h[f]=c[1]}}}return h}function handleDomLoaded(event){var sUA=navigator.userAgent;var i1=sUA.indexOf(" GROUP(");if(i1>0){var i2=sUA.indexOf(")",i1);if(i2>0){SLIDE_GROUP_ID=sUA.slice(i1+7,i2).split(",")[0]}}sUA=sUA.toLowerCase();var m=sUA.match(/trident.*rv[ :]*([\d.]+)/);if(m){if(parseFloat(m[1])>=11){WEB_BROWSER_TYPE="ie";WEB_BROWSER_VER=m[1];TRANS_END_FUNC="MSTransitionEnd";TRANS_CSS_NAME="-ms-transform"}}else{m=sUA.match(/firefox\/([\d.]+)/);if(m){WEB_BROWSER_TYPE="firefox";WEB_BROWSER_VER=m[1];TRANS_END_FUNC="transitionend";TRANS_CSS_NAME="transform"}else{m=sUA.match(/chrome\/([\d.]+)/);if(m){WEB_BROWSER_TYPE="chrome";WEB_BROWSER_VER=m[1];TRANS_END_FUNC="webkitTransitionEnd";TRANS_CSS_NAME="-webkit-transform"}else{m=sUA.match(/opera.([\d.]+)/);if(m){WEB_BROWSER_TYPE="opera";WEB_BROWSER_VER=m[1];TRANS_END_FUNC="oTransitionEnd";TRANS_CSS_NAME="transform"}else{m=sUA.match(/safari\/([\d.]+)/);if(m){WEB_BROWSER_TYPE="safari";WEB_BROWSER_VER=m[1];TRANS_END_FUNC="webkitTransitionEnd";TRANS_CSS_NAME="-webkit-transform"}else{m=sUA.match(/webkit\/([\d.]+)/);if(m){WEB_BROWSER_TYPE="webkit";WEB_BROWSER_VER=m[1];TRANS_END_FUNC="webkitTransitionEnd";TRANS_CSS_NAME="-webkit-transform"}}}}}}if(WEB_BROWSER_TYPE==""||WEB_BROWSER_VER==""){if(sUA.match(/msie ([\d.]+)/)){alert("IE version too low for PINP Slide, please use IE11 or higher")}else{alert("PINP Slide only support: firefox/chrome/safari/opera/IE")}document.body.innerHTML="<h2>Unknown browser type</h2>";return}SLIDE_HAS_PARENT=window.parent.window&&window.parent.window!==window;startByReadonly_=isSlideReadonly();beenReadonly_=startByReadonly_;var headNode=document.querySelector("head");if(!headNode){return}var setTitleToHead_=function(sTit){var node=headNode.querySelector("title");if(!node){node=document.createElement("title");headNode.appendChild(node)}node.innerHTML=sTit};var addScriptToHead_=function(sSrc,fn){var node=document.createElement("script");if(typeof fn=="function"){node.onload=fn}node.src=sSrc;headNode.appendChild(node)};var param=parseParam(location.search);if(window.SLIDE_LOAD_TXT){if(param.editing){if(param.paper){var s=getSynRequest("/software/pages/svg_paper_editor.txt");if(s){var node=document.body;node.className="noselect-txt";node.setAttribute("onclick","bodyOnClick(event)");node.setAttribute("ondblclick","bodyOnDblClick(event)");node.setAttribute("onmousemove","bodyMouseMove(event)");node.setAttribute("onmouseup","bodyMouseUp(event)");node.setAttribute("onresize","bodyOnResize(event)");node.setAttribute("onload","initSvgPaper()");node.removeAttribute("style");node.innerHTML=s}setTitleToHead_("SVG paper editor");addScriptToHead_("/software/"+SOFTWARE_PRJ_NAME+"/$plugins/svg_paper.min.js");addScriptToHead_("/software/pages/svg_paper_editor.js");return}else{if(param.inline=="1"||param.inline=="2"){var s2=(param.inline=="2"?"2":"");var s=getSynRequest("/software/pages/inline_editor"+s2+".txt");if(s){document.body.removeAttribute("style");document.body.innerHTML=s}setTitleToHead_("Inline editor");addScriptToHead_("/software/pages/js/jquery.popline.js",function(event){addScriptToHead_("/software/pages/inline_editor"+s2+".js")});return}else{if(param.preview){window.CURR_USR_PATH=document.location.pathname;if(CURR_USR_PATH.slice(-1)!="/"){CURR_USR_PATH=CURR_USR_PATH.slice(0,CURR_USR_PATH.lastIndexOf("/")+1)}document.body.setAttribute("name","frm-preview");window.inPreview__=1;window.SLIDE_RELEASED=true;window.SLIDE_START_STYLE="narrow";window.SLIDE_NO_TURNING=1;window.SLIDE_PAGE_TAG=0;window.SLIDE_PAGE_FORMAT="";window.SLIDE_PAGE_UPDN="";window.SLIDE_TITLE="Presentation";startByReadonly_=true;beenReadonly_=true;var s=getSynRequest("/software/pages/slide_preview.txt");if(s){document.body.innerHTML=s}setTitleToHead_("PINP preview");addScriptToHead_("/software/pages/js/messenger.js");addScriptToHead_("/software/pages/js/preview.js");return}else{window.inPreview__=2;window.SLIDE_RELEASED=false;startByReadonly_=false;beenReadonly_=false;document.body.style.backgroundColor="rgba(0,0,0,0)";addScriptToHead_("/software/pages/js/online.js")}}}}var loadSetupTxt=function(sAbs,sContent){var sectNode=document.querySelector("section.slides");if(!sectNode){return}var bUrlList=[],dConfig={},sAbstract="";if(sAbs){var bTmp=sAbs.split("\n");var sTmp=(bTmp[0]||"").trim().replace(/["<>]/gm,"");if(sTmp){window.SLIDE_TITLE=sTmp;var node=headNode.querySelector("title");if(!node){node=document.createElement("title");headNode.appendChild(node)}node.innerHTML=sTmp}sTmp=(bTmp[1]||"").trim();if(sTmp){sAbstract='<div class="pinp-mask slideshow-info ebook-abstract" _zindex="998" _config="small-default-large round0-default-round2-round3 default-looser-impacted p1-p2-p3-p0" _prepost="0-3-3-1-0" _left="-450" _top="210" _width="900" _height="140" style="background-color: rgba(0, 0, 0, 0.498039); border-color: rgb(128, 128, 128); border-width: 0px;"><p>'+sTmp+"</p></div>\n"}sTmp=(bTmp[2]||"").trim();if(sTmp){sTmp=sTmp.replace(/"/gm,"");if(sTmp&&sTmp[0]=="<"&&sTmp[sTmp.length-1]==">"){sTmp=sTmp.slice(1,sTmp.length-1)}var node=document.createElement("meta");node.setAttribute("name","keywords");node.setAttribute("content",sTmp);headNode.appendChild(node)}sTmp=(bTmp[3]||"").trim();if(sTmp){try{bUrlList=JSON.parse(sTmp);if(bUrlList instanceof Array){dConfig.images=bUrlList}else{if(bUrlList instanceof Object){dConfig=bUrlList;bUrlList=dConfig.images||[]}else{bUrlList=[];dConfig.images=bUrlList}}}catch(e){}if(sContent){bUrlList=[];dConfig.images=bUrlList}}}var bPages=[],bLib=[],sExtFile="";if(sContent){var b=sContent.split("COMPONENT_OF_PINP_");var iPgLen=b.length,bCurr=null,dLib={"slideshow-img":true,"slideshow-info":true};while(iPgLen>0){iPgLen-=1;var item=b[iPgLen],s=item.slice(0,6);if(s=="SLIDE,"){var i2=item.indexOf(",",6);if(i2>6&&i2<=16){var iTag=parseInt(item.slice(6,i2).trim());if(iTag==2){if(item.slice(i2,i2+8)==",<page/>"){bCurr=[];bPages.unshift(bCurr)}}else{if(iTag==0||iTag==1){if(bPages.length==0){bCurr=[];bPages.unshift(bCurr)}bCurr.unshift([iTag,item.slice(i2+1).trim()])}}}}else{if(s=="PLGIN,"){var i2=item.indexOf(",",6);if(i2>6&&i2<=70){var sName=item.slice(6,i2).trim();if(!dLib[sName]){dLib[sName]=true;bLib.unshift([sName,item.slice(i2+1).trim()])}}}else{if(s=="EXTFL,"){var i2=item.indexOf(",",6);if(i2>6&&i2<=70){sExtFile+=item.slice(i2+1)}}else{if(iPgLen>0){b[iPgLen-1]=b[iPgLen-1]+item}}}}}if(bPages.length&&bPages[0].length==0){bPages.shift()}}var hasPgWidget=bPages.length>0;var onlyOnePage=bUrlList.length<=1&&!hasPgWidget;while(bUrlList.length<bPages.length){bUrlList.push(["",""])}var turnPos=dConfig["turning-pos"];if(!turnPos){turnPos=""}else{turnPos=Math.floor(parseFloat(turnPos)*100);if(turnPos>=100){turnPos=""}else{turnPos=turnPos+"%"}}window.SLIDE_PAGE_UPDN=turnPos;if(sExtFile){var tmpNode=document.createElement("div");tmpNode.innerHTML=sExtFile;for(var i=0,item;item=tmpNode.children[i];i++){headNode.appendChild(item)}}var bkgColor=dConfig["background-color"];if(!bkgColor){if(hasPgWidget){bkgColor="rgb(216,216,216)"}else{if(onlyOnePage){bkgColor="rgb(255,255,255)"}else{bkgColor="rgb(0,0,0)"}}}var node=document.createElement("style");node.setAttribute("id","background-css");node.innerHTML="body {background:"+bkgColor+";}";sectNode.appendChild(node);if(bLib.length){var libNode=document.querySelector("div.plugin-code");if(libNode){var sHtml="";for(var i=0,item;item=bLib[i];i++){try{var oneNode=libNode.querySelector('div[name="'+item[0]+'"]');if(!oneNode){sHtml+=item[1]}}catch(e){}}if(sHtml){var tmpNode=document.createElement("div");tmpNode.innerHTML=sHtml;for(var i=0,item;item=tmpNode.children[i];i++){libNode.appendChild(item)}}}}var index=0;for(var i=0,item;item=bUrlList[i];i++){var sKey=item[0],sUrl=item[1]||"";if((!sKey&&!sUrl)||sKey){var bCurr=bPages[index];var node=document.createElement("article");node.setAttribute("id","article-"+index);index+=1;var sHtml="";if(!sKey&&sUrl){sKey="/software/"+sess.SLIDE_VERNAME+"/$images/nothing.png"}if(sKey){sHtml+='<div class="pinp-image slideshow-img" _zindex="996" _config="fullsize-fixed contain-fit '+(onlyOnePage?"round0-default-round2-round3":"default-round2-round3-round0")+'" _left="-450" _top="-350" _width="900" _height="700">';sHtml+='<img draggable="false" _lazy="'+sKey+'"';if(sUrl){sHtml+=' _jump="'+sUrl+'"'}sHtml+='><div class="rotate-txt"></div></div>\n'}if(index==1&&sAbstract){sHtml+=sAbstract}if(bCurr){for(var i2=0,item2;item2=bCurr[i2];i2++){sHtml+=item2[1]+"\n"}}if(sHtml){node.innerHTML=sHtml}sectNode.appendChild(node)}}if(index==0){var node=document.createElement("article");node.setAttribute("id","article-0");var sHtml="",bCurr=bPages[0];if(sAbstract){sHtml+=sAbstract}if(bCurr){for(var i2=0,item2;item2=bCurr[i2];i2++){sHtml+=item2[1]+"\n"}}if(sHtml){node.innerHTML=sHtml}sectNode.appendChild(node)}};loadSetupTxt(getSynRequest("$abstract.txt"),getSynRequest("$index.txt"))}if(startByReadonly_&&param.autoplay){var iTmp=parseInt(param.autoplay);if(iTmp>0){PINP_FIX_AUTO=iTmp}}var sTmp=param.size;if(startByReadonly_&&sTmp){var bTmp=sTmp.split("-");if(bTmp.length==2){var bTmp2=bTmp[1].split(/x|X/g);if(bTmp2.length==2){PINP_FIX_RATE=Math.max(0,parseInt(bTmp2[1])/parseInt(bTmp2[0]))}}var bTmp=bTmp[0].split(/x|X/g);if(bTmp.length==2){var iWd=Math.max(0,parseFloat(bTmp[0]));var iHi=Math.max(0,parseFloat(bTmp[1]));if(iWd<1){PINP_FIX_FIT_X=(iWd==0?1:iWd);if(iHi<1){if(!PINP_FIX_RATE){PINP_FIX_FIT_Y=(iHi==0?1:iHi)}}else{PINP_FIXSIZE_Y=Math.min(Math.max(32,iHi),window.innerHeight)}PINP_FIX_SIZE=true}else{if(iHi<1&&iWd>=32){PINP_FIX_RATE=0;PINP_FIXSIZE_X=Math.min(iWd,window.innerWidth);PINP_FIX_FIT_Y=(iHi==0?1:iHi);PINP_FIX_SIZE=true}else{if(iWd>=32&&iHi>=32){PINP_FIX_RATE=0;PINP_FIXSIZE_X=Math.min(iWd,window.innerWidth);PINP_FIXSIZE_Y=Math.min(iHi,window.innerHeight);PINP_FIX_SIZE=true}else{PINP_FIX_RATE=0}}}}else{PINP_FIX_RATE=0}}if(startByReadonly_){sTmp=param["background-color"];if(sTmp){document.body.style.backgroundColor=decodeURIComponent(sTmp)}sTmp=param["turning-pos"];if(sTmp){var iTmp=Math.floor(parseFloat(sTmp)*100);window.SLIDE_PAGE_UPDN=(iTmp>=100?"":(iTmp+"%"))}sTmp=param["no-frame"];if(sTmp){var node=document.querySelector("section.slides");if(node){if(parseInt(sTmp)){node.classList.add("no-frame")}else{node.classList.remove("no-frame")}}}sTmp=param["no-ground"];if(sTmp){var node=document.querySelector("section.slides");if(node){if(parseInt(sTmp)){node.classList.add("no-ground")}else{node.classList.remove("no-ground")}}}sTmp=param["no-trans"];if(sTmp){var node=document.querySelector("section.slides");if(node){if(parseInt(sTmp)){node.classList.add("no-trans")}else{node.classList.remove("no-trans")}}}sTmp=param["no-sidebar"];if(sTmp){if(parseInt(sTmp)){window.SLIDE_NO_TURNING=1}else{window.SLIDE_NO_TURNING=0}}}if(PINP_WEB_BASE&&PINP_WEB_BASE[PINP_WEB_BASE.length-1]=="/"){PINP_WEB_BASE=PINP_WEB_BASE.slice(0,PINP_WEB_BASE.length-1)}if(window.require){require.config({baseUrl:PINP_WEB_BASE+"/"})}var initJump=false;var slideNo=parseInt(location.hash.substr(1)||"0");if(slideNo){curSlide=slideNo-1;initJump=true}else{curSlide=0;if(!beenReadonly_&&!SLIDE_HAS_PARENT){var pg=getCookie__("PINP_EDITING_PG"+SLIDE_GROUP_ID);var pgId=getCookie__("PINP_EDITING_ID"+SLIDE_GROUP_ID);if(pg&&pgId){var sTmp=stringHashCode(location.pathname)+"";pg=parseInt(pg);if(pg&&pgId==sTmp){curSlide=pg-1;initJump=true}}}}var el=document.createElement("meta");el.name="viewport";el.content="width=device-width,height=device-height,initial-scale=1.0";headNode.appendChild(el);el=document.createElement("meta");el.name="apple-mobile-web-app-capable";el.content="yes";headNode.appendChild(el);if(PINP_EXTEND_STYLE){el=document.createElement("style");el.innerHTML=PINP_EXTEND_STYLE;headNode.appendChild(el)}el=document.createElement("link");el.rel="stylesheet";el.type="text/css";el.href=PINP_WEB_BASE+"/software/"+SOFTWARE_PRJ_NAME+"/$script/styles.css";document.body.appendChild(el);el=document.createElement("style");el.innerHTML="body {"+(PINP_FIX_SIZE?"":"min-height:700px;")+"overflow:hidden;} pre {font-family: "+PINP_SOURCECODE_FONT+";} .slides > article {font-family: "+PINP_SLIDE_FONT+";} img[id^='ch-'],img[id^='se-'],img[id^='wd-']{visibility:hidden;}"+(window.inPreview__==2?"#slide-menu li {font-size:18px;line-height:22px;":"");document.body.appendChild(el);if(!beenReadonly_){document.body.classList.add("noselect-txt")}var updateFixSize=function(){if(!PINP_FIX_SIZE){return}if(PINP_FIX_FIT_X){PINP_FIXSIZE_X=Math.floor(window.innerWidth*PINP_FIX_FIT_X+0.5);if(PINP_FIX_RATE){PINP_FIXSIZE_Y=Math.floor(PINP_FIXSIZE_X*PINP_FIX_RATE+0.5)}else{if(PINP_FIX_FIT_Y){PINP_FIXSIZE_Y=Math.floor(window.innerHeight*PINP_FIX_FIT_Y+0.5)}}}else{if(PINP_FIX_FIT_Y){PINP_FIXSIZE_Y=Math.floor(window.innerHeight*PINP_FIX_FIT_Y+0.5)}}SLIDE_HALF_WIDTH=Math.floor(PINP_FIXSIZE_X/2+0.5);SLIDE_HALF_HEIGHT=Math.floor(PINP_FIXSIZE_Y/2+0.5);PINP_FIXSIZE_X=SLIDE_HALF_WIDTH+SLIDE_HALF_WIDTH;PINP_FIXSIZE_Y=SLIDE_HALF_HEIGHT+SLIDE_HALF_HEIGHT;var node=document.getElementById("pinp-fix-style");if(node){node.parentNode.removeChild(node)}var iTmp=SLIDE_HALF_WIDTH+SLIDE_HALF_WIDTH;var sTmp=".slides.pinp-fixsize > article {margin-left:-"+SLIDE_HALF_WIDTH+"px; margin-top:-"+SLIDE_HALF_HEIGHT+"px; width:"+PINP_FIXSIZE_X+"px; height:"+PINP_FIXSIZE_Y+"px;}";sTmp+=".slides.pinp-fixsize > article.far-past {display:block; -o-transform:translate(-"+iTmp+"px,0); -moz-transform: translate(-"+iTmp+"px,0); -webkit-transform: translate3d(-"+iTmp+"px,0,0); -ms-transform: translate(-"+iTmp+"px,0); transform: translate(-"+iTmp+"px,0);}";sTmp+=".slides.pinp-fixsize > article.past {display:block; -o-transform:translate(-"+PINP_FIXSIZE_X+"px,0); -moz-transform: translate(-"+PINP_FIXSIZE_X+"px,0); -webkit-transform: translate3d(-"+PINP_FIXSIZE_X+"px,0,0); -ms-transform: translate(-"+PINP_FIXSIZE_X+"px,0); transform: translate(-"+PINP_FIXSIZE_X+"px,0);}";sTmp+=".slides.pinp-fixsize > article.next {display:block; -o-transform:translate("+PINP_FIXSIZE_X+"px,0); -moz-transform: translate("+PINP_FIXSIZE_X+"px,0); -webkit-transform: translate3d("+PINP_FIXSIZE_X+"px,0,0); -ms-transform: translate("+PINP_FIXSIZE_X+"px,0); transform: translate("+PINP_FIXSIZE_X+"px,0);}";sTmp+=".slides.pinp-fixsize > article.far-next {display:block; -o-transform:translate("+iTmp+"px,0); -moz-transform: translate("+iTmp+"px,0); -webkit-transform: translate3d("+iTmp+"px,0,0); -ms-transform: translate("+iTmp+"px,0); transform: translate("+iTmp+"px,0);}";node=document.createElement("style");node.id="pinp-fix-style";node.innerHTML=sTmp;document.body.appendChild(node);node=document.querySelector("section.slides");if(node){node.classList.add("pinp-fixsize");node.style.width=PINP_FIXSIZE_X+"px";node.style.height=PINP_FIXSIZE_Y+"px"}};if(PINP_FIX_SIZE){updateFixSize()}if(startByReadonly_&&(!param.size||param.size=="0x0"||param.size=="0X0")&&PINP_FIX_AUTO==0){var iTmp=parseInt(param["no-ctrlbar"]||"0");if(iTmp==0){setTimeout(function(){var el=document.createElement("script");el.async=1;el.src=(location.hostname=="localhost"?"":"//www.pinp.me")+"/software/slide11/$script/ctrlbar.js";headNode.appendChild(el)},500)}}var bltOnFullsize=function(owner){var iWd=SLIDE_HALF_WIDTH+SLIDE_HALF_WIDTH;var iHi=SLIDE_HALF_HEIGHT+SLIDE_HALF_HEIGHT;owner.setAttribute("_left",(-SLIDE_HALF_WIDTH)+"");owner.setAttribute("_top",(-SLIDE_HALF_HEIGHT)+"");owner.setAttribute("_width",iWd+"");owner.setAttribute("_height",iHi+"");owner.style.left="0px";owner.style.top="0px";owner.style.width=iWd+"px";owner.style.height=iHi+"px";setTimeout(function(){apiNode.unselect()},0)};var bltOnFixsize=function(owner){owner.setAttribute("_width","500");owner.setAttribute("_height","400");owner.style.width="500px";owner.style.height="400px";setTimeout(function(){apiNode.unselect()},0)};var item=pluginOf("svg-paper");item.title="svg paper";item["fullsize-fixed"]=bltOnFullsize;item["fixed-fullsize"]=bltOnFixsize;var markRemake_=function(node){if(!node){return}var txtNode=node.querySelector("div.rotate-txt > pre");if(!txtNode){return}var tailNode=txtNode.parentNode;if(!tailNode||tailNode.parentNode!==node){return}for(var i=node.children.length-1;i>=0;i--){var item2=node.children[i];if(item2.nodeName=="DIV"&&item2.classList.contains("pinp-maked")){node.removeChild(item2)}}var sHtml=marked(txtNode.textContent);var newOne=document.createElement("div");newOne.classList.add("pinp-maked");newOne.innerHTML=sHtml;node.insertBefore(newOne,tailNode)};item=pluginOf("pinp-mark");item.title="pinp markdown";item["fullsize-fixed"]=bltOnFullsize;item["fixed-fullsize"]=bltOnFixsize;item.remake=markRemake_;item.oncreated=function(event){markRemake_(event.target)};var nodes=document.querySelectorAll("article > div.pinp-mark");for(var i=0,node;node=nodes[i];i++){markRemake_(node)}if(PINP_FIX_FIT_X||PINP_FIX_FIT_Y){var paperResize_=function(){var wd=SLIDE_HALF_WIDTH+SLIDE_HALF_WIDTH,hi=SLIDE_HALF_HEIGHT+SLIDE_HALF_HEIGHT;var nodes=document.querySelectorAll("article > div.fullsize-fixed");for(var i=0,node;node=nodes[i];i++){node.style.left="0px";node.style.top="0px";node.style.width=wd+"px";node.style.height=hi+"px"}};paperResize_();window.addEventListener("resize",function(event){setTimeout(function(){paperResize_()},0)},false)}var cacheResWhenErr=function(event){var node=event.target;node.onerror=null;var sAttr=node.nodeName=="LINK"?"href":"src";var sPath=node.getAttribute(sAttr);if(sPath){var sPrefix=node.getAttribute("_prefix");if(sPrefix){sPath=sPath.slice(sPrefix.length)}}var sHost=node.getAttribute("host");if(sHost&&sPath&&sPath[0]=="/"){var loc=location__(sHost);if(loc.hostname!=location.hostname){var sAlias=sPath.split("/")[1]||"";node.setAttribute(sAttr,sHost+sPath);if(beenReadonly_&&!window.PINP_DISABLE_NOTICE&&sAlias.indexOf("u-")!=0){if(window.parent.window&&window.parent.window!==window){var s="[PINPSLIDE_11]"+JSON.stringify({method:"cache",param:[sHost,sPath]});window.parent.window.postMessage(s,"*")}}}}};var setupPreload_=function(sType,sClsList,sHost,sPath,sArg){if(sType=="text/css"){if(sClsList){var bTmp=[sHost,sPath,sClsList,sType];if(sArg){bTmp.push(sArg)}usedPlugins_[sHost+sPath]=bTmp}if(sArg){var el=document.createElement("link");el.type="text/css";el.rel="stylesheet";if(PINP_WEB_BASE){el.setAttribute("_prefix",PINP_WEB_BASE)}if(sHost){el.setAttribute("host",sHost);el.onerror=cacheResWhenErr}document.body.appendChild(el);el.setAttribute("href",PINP_WEB_BASE+sPath)}}else{if(sType=="text/javascript"){if(sClsList){var bTmp=[sHost,sPath,sClsList,sType];if(sArg){bTmp.push(sArg)}usedPlugins_[sHost+sPath]=bTmp}if(sArg){var el=document.createElement("script");el.type="text/javascript";if(PINP_WEB_BASE){el.setAttribute("_prefix",PINP_WEB_BASE)}if(sArg=="*"){var sPath_;if(sPath.slice(sPath.length-3).toUpperCase()==".JS"){if(sPath[0]=="/"){sPath_=sPath.slice(1,sPath.length-3)}else{sPath_=sPath.slice(0,sPath.length-3)}}else{if(sPath[0]=="/"){sPath_=sPath.slice(1)}else{sPath_=sPath}}sHtml='require(["'+sPath_+'"],function(mod){}';if(sHost&&sPath[0]=="/"){var sRemote=location__(sHost).href;if(sRemote&&sRemote!=location__("/").href){sHtml+=",function(sErr){";if(beenReadonly_&&!window.PINP_DISABLE_NOTICE){var sAlias=sPath.split("/")[1]||"";if(sAlias.indexOf("u-")!=0&&window.parent.window&&window.parent.window!==window){sHtml+='notifyCache("'+sHost+'","'+sPath+'");'}}sHtml+='require(["'+sRemote+sPath_+'"],function(mod){});}'}}sHtml+=");";el.innerHTML=sHtml}else{if(sHost){el.setAttribute("host",sHost);el.onerror=cacheResWhenErr}el.setAttribute("onload",sArg);el.setAttribute("src",PINP_WEB_BASE+sPath)}document.body.appendChild(el)}}else{if(sType.indexOf("text/")==0||sType.indexOf("image/")==0){if(sClsList){usedPlugins_[sHost+sPath]=[sHost,sPath,sClsList,sType]}}}}};var addDepends_=function(sRelate,sDomain,sPath,sType,sArg){var sKey=sDomain+sPath;if(!usedPlugins_[sKey]){setupPreload_(sType||"",sRelate,sDomain,sPath,sArg)}};var addAssistor_=function(sCls,sHost){var iLen=arguments.length;var b=usedAssistor_[sCls];if(!(b instanceof Array)){usedAssistor_[sCls]=b=[sHost];for(var i=2;i<iLen;i++){b.push(arguments[i])}}};window.cacheFrom=cacheResWhenErr;var nodes=document.head.querySelectorAll('link[rel="bookmark"]');for(var i=0,item;item=nodes[i];i++){var sClsList=item.getAttribute("plugs");var sHRef=(item.getAttribute("href")||"").trim();if(sClsList&&sHRef&&(sHRef[0]=="/"||sHRef[0]==".")){var sType=item.getAttribute("type")||"";var sHost=item.getAttribute("host")||"";var sArg=item.getAttribute("onload")||"";setupPreload_(sType,sClsList,sHost,sHRef,sArg)}}if(beenReadonly_){var els=document.querySelectorAll("div.code-block > pre");for(var i=0;el=els[i];i++){if(!el.classList.contains("noprettyprint")){el.classList.add("prettyprint")}}}var onDelayEnd=function(node){removePrebuildCls(node);LAST_PREPOST_NODE=null;if(node.classList.contains("turning-none")){apiNode.nextSlide()}else{var curr=getSlideEl(curSlide);if(curr){var nextBld=curr.querySelectorAll('article > div[class*="prebuild-"]');processJoinedStep(curr,nextBld,false)}}};var autoTurnClick=function(event){if(event.stopPropagation){event.stopPropagation()}var targ=event.target;if(targ.classList.contains("pinp-delay")&&!targ.classList.contains("hidden-default")){if(targ.classList.contains("is-playing")){targ.classList.remove("is-playing");targ.classList.add("is-paused");var tm=targ.timerId;if(tm){targ.timerId=null;clearTimeout(tm)}}else{if(targ.classList.contains("is-paused")){targ.classList.remove("is-paused");var tm=targ.timerId;if(tm){targ.timerId=null;clearTimeout(tm)}onDelayEnd(targ)}}}};var checkAutoTurning=function(curr,event){if(!startByReadonly_){return false}var x=event._clientX||event.clientX;var y=event._clientY||event.clientY;var nodes=curr.querySelectorAll("article > div.pinp-delay");for(var i=0,item;item=nodes[i];i++){if(item.classList.contains("hidden-default")){continue}if(!item.classList.contains("is-playing")&&!item.classList.contains("is-paused")){continue}var r=item.getBoundingClientRect();if(x>=r.left&&x<r.left+r.width&&y>=r.top&&y<r.top+r.height){autoTurnClick({target:item});return true}}return false};var item=document.querySelector("section.slides");if(item&&(!beenReadonly_||!SLIDE_NO_TURNING)){el=document.createElement("div");el.className="slide-area";el.id="prev-slide-area";if(!beenReadonly_){el.style.width="110px";el.style.marginLeft="-550px"}else{var wdCss=PINP_FIX_SIZE?";left:0%;width:100%":"";if(window.SLIDE_PAGE_UPDN&&!SLIDE_NO_TURNING){el.innerHTML="<div class='slide-updn left' style='top:"+window.SLIDE_PAGE_UPDN+wdCss+"'></div>"}if(PINP_FIX_SIZE){el.style.left=SLIDE_HALF_WIDTH+"px";el.style.top=SLIDE_HALF_HEIGHT+"px";el.style.width="50px";el.style.height=PINP_FIXSIZE_Y+"px";el.style.marginLeft="-"+SLIDE_HALF_WIDTH+"px";el.style.marginTop="-"+SLIDE_HALF_HEIGHT+"px"}}el.addEventListener("click",function(event){var curr=getSlideEl(curSlide);if(curr){event.stopPropagation();if(checkAutoTurning(curr,event)){return}else{apiNode.prevSlide()}}},false);item.appendChild(el);if(PINP_FIX_AUTO){el.style.display="none"}el=document.createElement("div");el.className="slide-area";el.id="next-slide-area";if(!beenReadonly_){el.style.width="110px";el.style.marginLeft="440px"}else{var wdCss=PINP_FIX_SIZE?";left:0%;width:100%":"";if(window.SLIDE_PAGE_UPDN&&!SLIDE_NO_TURNING){el.innerHTML="<div class='slide-updn right' style='top:"+window.SLIDE_PAGE_UPDN+wdCss+"'></div>"}if(PINP_FIX_SIZE){el.style.left=SLIDE_HALF_WIDTH+"px";el.style.top=SLIDE_HALF_HEIGHT+"px";el.style.width="50px";el.style.height=PINP_FIXSIZE_Y+"px";el.style.marginLeft=(SLIDE_HALF_WIDTH-50)+"px";el.style.marginTop="-"+SLIDE_HALF_HEIGHT+"px"}}el.addEventListener("click",function(event){var curr=getSlideEl(curSlide);if(curr){event.stopPropagation();if(checkAutoTurning(curr,event)){return}else{apiNode.nextSlide()}}},false);item.appendChild(el);if(PINP_FIX_AUTO){el.style.display="none"}}if(item){noSlideFrame_=item.classList.contains("no-frame");noSlideTrans_=item.classList.contains("no-trans");noSlideGround_=item.classList.contains("no-ground")}el=document.createElement("div");el.id="item-holder";el.onmousedown=itemMovMouseDown;document.body.appendChild(el);el=document.createElement("div");el.id="item-resizer";el.onmousedown=itemResizeMouseDown;document.body.appendChild(el);el=document.createElement("div");el.style.position="absolute";el.style.zIndex="19999";el.style.border="1px dotted gray";el.style.display="none";document.body.appendChild(el);widgetSelector=el;el=document.createElement("div");el.id="page-tag";document.body.appendChild(el);if(!PINP_FIX_SIZE&&(SLIDE_PAGE_TAG&1)==1){el.style.display="block"}el=document.createElement("div");el.id="page-tag2";document.body.appendChild(el);if(!PINP_FIX_SIZE&&(SLIDE_PAGE_TAG&3)==2){el.style.display="block"}slideEls=document.querySelectorAll("section.slides > article");resetChapterSects(slideEls);if(!initJump&&startByReadonly_&&slideEls.length){delayRestoreRes(slideEls[0])}else{delayRestoreRes()}if(slideEls.length&&curSlide>=slideEls.length){curSlide=slideEls.length-1}saveWidgetStyle();setupSvgPaper();setupFrames();if(beenReadonly_){for(var i=0,slide;slide=slideEls[i];i++){var items=slide.querySelectorAll("div.build > *,ul.build > *");for(var j=0,item;item=items[j];j++){if(item.classList){item.classList.add("to-build")}}items=slide.querySelectorAll("iframe.build");for(var j=0,item;item=items[j];j++){item.classList.add("to-build")}}}var nodes=document.querySelectorAll("div.img-resource > link");for(var i=0,item;item=nodes[i];i++){requestOneSvg(item)}el=document.querySelector("section.slides > article > div.ebook-title");if(el&&el.textContent){sArticleTitle=extractDocTitle(el);document.title=sArticleTitle}if(!sArticleTitle){sArticleTitle=window.SLIDE_TITLE||"Presentation";document.title=sArticleTitle}window.SLIDE_TITLE=sArticleTitle;if(contentsIndex>=0){el=slideEls[contentsIndex].querySelector("div.ebook-contents");el.innerHTML="";for(var i2=0,item2;item2=bChapterSects[i2];i2++){for(var i3=0,key;key=item2[i3];i3+=2){if(key=="chapter"){var oneRow=document.createElement("ul");el.appendChild(oneRow);var nameNode=document.createElement("li");nameNode.innerHTML=item2[i3+1];nameNode.classList.add("echapter");oneRow.appendChild(nameNode);var pgNode=document.createElement("li");pgNode.innerHTML="<a href='javascript:apiNode.gotoPage("+i2+")'>"+(i2+1)+"</a>";oneRow.appendChild(pgNode)}else{if(key=="section"){var oneRow=document.createElement("ul");el.appendChild(oneRow);var nameNode=document.createElement("li");nameNode.innerHTML="&nbsp;&nbsp;"+item2[i3+1];nameNode.classList.add("esection");oneRow.appendChild(nameNode);var pgNode=document.createElement("li");pgNode.innerHTML="<a href='javascript:apiNode.gotoPage("+i2+")'>"+(i2+1)+"</a>";oneRow.appendChild(pgNode)}}}}bChapterSects=[]}el=document.querySelector("section.slides > article > div.ebook-chartindex");if(el){el.innerHTML="";for(var i2=0,bInfo;bInfo=bTableCharts[i2];i2++){var iPage=bInfo[0];var oneRow=document.createElement("ul");el.appendChild(oneRow);var nameNode=document.createElement("li");nameNode.innerHTML=bInfo[1];oneRow.appendChild(nameNode);var pgNode=document.createElement("li");pgNode.innerHTML="<a href='javascript:apiNode.gotoPage("+iPage+")'>"+(iPage+1)+"</a>";oneRow.appendChild(pgNode)}}bTableCharts=[];if(beenReadonly_){var nodes=document.querySelectorAll("section.slides > article > div.pinp-goto");for(var i=0,item;item=nodes[i];i++){item.addEventListener("click",jumpInDoc,false)}}var delayPlayFn=function(node){return function(iSpeed){if(!startByReadonly_){return}if(node&&node.parentNode){var fTm=parseFloat(node.getAttribute("_widget")||"0")*1000;fTm=Math.floor(fTm);if(fTm<200){onDelayEnd(node);return}node.classList.add("is-playing");node.classList.remove("is-paused");node.timerId=setTimeout(function(){if(node.parentNode){node.classList.remove("is-playing");node.classList.remove("is-paused");if(node.timerId){node.timerId=null;onDelayEnd(node)}}},fTm)}}};var delayPauseFn=function(node){return function(){if(!startByReadonly_){return}if(node&&node.parentNode){var inPlay=false;if(node.classList.contains("is-playing")){node.classList.remove("is-playing");inPlay=true}if(node.classList.contains("is-paused")){node.classList.remove("is-paused");inPlay=true}if(inPlay){var tm=node.timerId;if(tm){node.timerId=null;clearTimeout(tm)}if(node.classList.contains("turning-none")){var allLeft=document.querySelectorAll('article > div.pinp-delay.turning-none[class*="prebuild-"]');for(var i=0,item;item=allLeft[i];i++){removePrebuildCls(item)}}}}}};var nodes=document.querySelectorAll("section.slides > article > div.pinp-delay");for(var i=0,item;item=nodes[i];i++){item.play=delayPlayFn(item);item.pause=delayPauseFn(item);item.stop=item.pause;if(startByReadonly_){item.addEventListener("click",autoTurnClick,false)}}var audioPlayFn=function(node){return function(iSpeed){if(!startByReadonly_){return}if(node&&node.parentNode){var player=node.querySelector("audio");if(player){player.play()}}}};var audioPauseFn=function(node){return function(){if(!startByReadonly_){return}if(node&&node.parentNode){var player=node.querySelector("audio");if(player){player.pause()}}}};var nodes=document.querySelectorAll("section.slides > article > div.pinp-audio");for(var i=0,item;item=nodes[i];i++){item.play=audioPlayFn(item);item.pause=audioPauseFn(item);item.stop=item.pause;if(item.classList.contains("is-playing")){item.classList.remove("is-playing");item.classList.add("is-paused")}var audioNode=item.querySelector("audio");if(startByReadonly_&&audioNode){audioNode.onended=function(event){var owner=event.target.parentNode;if(owner&&owner.classList.contains("pinp-audio")){if(owner.onPlayDone){owner.onPlayDone()}}};if(item.classList.contains("is-paused")){item.addEventListener("click",function(event){var targ_=event.target,targ=null;while(targ_){if(targ_.nodeName=="DIV"&&targ_.classList.contains("pinp-audio")){targ=targ_;break}else{targ_=targ_.parentNode}}if(targ){var audio=targ.querySelector("audio");if(audio){if(audio.paused){audio.play()}else{audio.pause()}}}},false);audioNode.onplay=function(event){var owner=event.target.parentNode;if(owner&&owner.classList.contains("pinp-audio")){owner.classList.remove("is-paused");owner.classList.add("is-playing")}};audioNode.onpause=function(event){var owner=event.target.parentNode;if(owner&&owner.classList.contains("pinp-audio")){owner.classList.remove("is-playing");owner.classList.add("is-paused")}}}}}if(!beenReadonly_||!SLIDE_NO_TURNING){document.addEventListener("keydown",handleDocKeyDown,false)}var cfgMenu=document.getElementById("slide-menu");el=document.getElementById("slide-api");window.apiNode=el;var reLineComment=/##.*?\n/gm;el.addDepends=addDepends_;el.addAssistor=addAssistor_;el.pluginModified=function(node,s){if(beenReadonly_||!node.classList.contains("web-item")){return}var scriptNode=null,commentNode=null;apiNode.innerHTML=s;for(var i=0,item;item=apiNode.childNodes[i];i++){if(item.nodeType==1&&item.nodeName=="SCRIPT"&&(item.getAttribute("type")||"").toLowerCase()=="text/ractive"){scriptNode=item}else{if(item.nodeType==8){commentNode=item}}}apiNode.innerHTML="";if(scriptNode){if(window.Ractive&&Ractive.updateContent&&Ractive.updateContent(node,scriptNode,commentNode)){setPageModified_()}}};el.pluginSetProp=function(node,b){if(beenReadonly_||!node.classList.contains("web-item")){return}if(window.Ractive&&Ractive.updateProperty&&Ractive.updateProperty(node,b)){setPageModified_()}};el.canPlay=function(node){if(node&&node.classList.contains("web-item")&&node.play){return 1}else{return 0}};el.addPlugCode=function(sCls,sCode,needRet){if(sCls&&sCode){var codeRoot=document.querySelector("body > div.plugin-code");if(!codeRoot){codeRoot=document.createElement("div");codeRoot.className="plugin-code";document.body.appendChild(codeRoot)}var node=codeRoot.querySelector('div.plugin-code > div[name="'+sCls+'"]');if(node){if(needRet){return node}else{return null}}node=document.createElement("div");node.setAttribute("name",sCls);node.innerHTML=sCode;codeRoot.appendChild(node);var jsNode=node.querySelector('script[type="text/javascript"]');if(!jsNode){jsNode=node.querySelector("script");if(jsNode.getAttribute("type")){jsNode=null}}if(jsNode){setTimeout(function(){window.eval(jsNode.innerHTML)},0)}if(needRet){return node}else{return null}}return undefined};el.callPlugin=function(sId,sMethod){var m=pluginOf(sId,true),fn=m[sMethod];if(fn){var b=Array.prototype.slice.apply(arguments,[2]);return fn.apply(null,b)}else{return null}};el.remakeContent=function(txtNode){var owner=txtNode.parentNode;if(owner&&owner.classList.contains("pinp-make")){for(var i=0,sCls;sCls=owner.classList[i];i++){var dSpace=pluginOf(sCls,true);if(dSpace&&dSpace.remake){try{dSpace.remake(owner)}catch(e){}break}}}};el.setPageModified=setPageModified_;el.savePageImg=function(){return false};el.saveSlideDoc=function(){if(window.inPreview__==2){var node=slideEls[curSlide];if(node&&node.id==lastModifyPageId&&window.parent.window&&window.parent.window!==window){var b=apiNode.getPageHtml(node);if(b&&b.length==3){b[2]="COMPONENT_OF_PINP_SLIDE,0,"+b[2];var s="[PINPSLIDE_11]"+JSON.stringify({method:"previewPageModi",param:b});window.parent.window.postMessage(s,"*");return true}}}return false};var textOfCopied_="";el.copyToClipboard=function(sClip,x,y){if(window.location.protocol=="file:"){return}var maskArea=document.getElementById("dialog-mask");if(!maskArea){maskArea=document.createElement("div");maskArea.id="dialog-mask";maskArea.style.cssText="display:none; background-color:rgba(255,255,255,0); left:0px; top:0px; width:100%; height:100%; position:absolute; z-index:2010;";document.body.appendChild(maskArea);var noReplyEvent=function(event){event.stopPropagation();event.preventDefault()};maskArea.onclick=noReplyEvent;maskArea.ondblclick=noReplyEvent;maskArea.onmousedown=noReplyEvent;maskArea.onmouseup=noReplyEvent;maskArea.oncontextmenu=noReplyEvent}if(window.inPreview__==2){textOfCopied_=sClip}else{if(typeof x=="number"){x=x-90+30}else{x=parseInt((window.innerWidth-180)/2)}if(typeof y=="number"){y=y-60+30}else{y=parseInt((window.innerHeight-120)/2)}maskArea.clipString=sClip;maskArea.innerHTML='<iframe frameborder="no" border="0" src="'+PINP_WEB_BASE+'/software/slide11/$plugins/copy_clipboard.html" style="position:absolute; border:0px; overflow:hidden; left:'+x+"px; top:"+y+'px; width:180px; height:120px" />';maskArea.style.display="block"}};el.textOfClipboard=function(){if(window.inPreview__==2){return textOfCopied_}else{return""}};el.editContent=function(){};el.dbclickEdit=function(node,bottomNode){var cfgMenu=document.getElementById("slide-menu");cfgMenu.style.display="none";if(!node){node=getCurrSelected()}if(!node){return}if(node.classList.contains("read-only")){return}if(beenReadonly_){alert("Slide does not in design mode, run in maximized window?")}else{apiNode.hidePopContent();if(node.classList.contains("web-item")){tryEditWebItem(node,true)}else{apiNode.editContent(node.toId(),true,bottomNode.toId())}}};el.moveDesignItem=function(iX,iY){moveDesignItem_(iX,iY)};el.renewCurrSlide=function(){updateSlideClass(curSlide,"current")};el.popDesignItem=function(step){if(beenReadonly_){return}var node=getCurrSelected();if(node){var iLevel=parseInt(node.getAttribute("_zindex")||"1000");if(!step){var nodes=document.querySelectorAll("div.in-design");var maxNodes=[],iMax=1;for(var i=0,item;item=nodes[i];i++){var iTmp=parseInt(item.getAttribute("_zindex")||"1000");if(iTmp<2000){if(iTmp>iMax){iMax=iTmp;maxNodes=[item]}else{if(iTmp==iMax){maxNodes.push(item)}}}}if(iMax==iLevel&&maxNodes.length==1){return}else{if(iMax>iLevel||iMax==iLevel){node.setAttribute("_zindex",Math.min(iMax+1,1999)+"");renewDesignPos(node);setPageModified_()}}}else{if(step<=0){step=1}node.setAttribute("_zindex",Math.min(iLevel+step,1999)+"");renewDesignPos(node);setPageModified_()}}};el.pushDesignItem=function(step){if(beenReadonly_){return}var node=getCurrSelected();if(node){var iLevel=parseInt(node.getAttribute("_zindex")||"1000");if(!step){var nodes=document.querySelectorAll("div.in-design");var minNodes=[],iMin=1999;for(var i=0,item;item=nodes[i];i++){var iTmp=parseInt(item.getAttribute("_zindex")||"1000");if(iTmp>0){if(iTmp<iMin){iMin=iTmp;minNodes=[item]}else{if(iTmp==iMin){minNodes.push(item)}}}}if(iMin==iLevel&&minNodes.length==1){return}else{if(iMin<iLevel||iMin==iLevel){node.setAttribute("_zindex",Math.max(iMin-1,1)+"");renewDesignPos(node);setPageModified_()}}}else{if(step<=0){step=1}node.setAttribute("_zindex",Math.max(iLevel-step,1)+"");renewDesignPos(node);setPageModified_()}}};el.delDesignItem=function(){cfgMenu.style.display="none";if(beenReadonly_){return false}hideWidgetHint();var node=getCurrSelected();if(node){apiNode.unselect();node.classList.add("in-moving");setTimeout(function(){node.classList.remove("in-moving");node.parentNode.removeChild(node);setPageModified_()},0);return true}return false};el.configDesignItem=function(){if(beenReadonly_){return}var node=getCurrSelected();if(node){apiNode.editContent(node.toId(),false,node.toId())}};el.reselect=function(){if(!lastSelectedItem){return}var owner=lastSelectedItem.parentNode;if(owner&&owner.nodeName=="ARTICLE"){var holder=document.getElementById("item-holder");if(holder.parentNode!==lastSelectedItem){holder.parentNode.removeChild(holder);lastSelectedItem.appendChild(holder);holder.style.display="block"}var resizer=document.getElementById("item-resizer");if(resizer.parentNode!==lastSelectedItem){resizer.parentNode.removeChild(resizer);lastSelectedItem.appendChild(resizer);resizer.style.display="block"}var selects=document.querySelectorAll("article > div.curr-design");for(var i=0,item;item=selects[i];i++){item.classList.remove("curr-design")}lastSelectedItem.classList.add("curr-design");var currLayer=lastSelectedItem.style.zIndex;if(currLayer){currLayer=parseInt(currLayer);if(currLayer>0&&currLayer<10000){lastSelectedItem.style.zIndex=(10000+currLayer)+""}}}};el.selectLastAdded=function(){if(beenReadonly_){return 0}var node=getSlideEl(curSlide);if(!node){return 0}var node=node.lastChild,lastOne=null;while(node){if(node.nodeName!="DIV"){node=node.previousElementSibling;continue}else{if(node.classList.contains("in-design")){lastOne=node;selectOneItem(node)}}break}return(lastOne?lastOne.toId():0)};el.loadSvgRes=function(){var bSvg=document.querySelectorAll("div.svg-shape");for(var i=0,item;item=bSvg[i];i++){if(!item._hasBuild){var b=item.querySelectorAll("div.img-resource > link");for(var i2=0,item2;item2=b[i2];i2++){requestOneSvg(item2)}}}};el.unselect=function(){if(beenReadonly_){return}var resizer=document.getElementById("item-resizer");var holder=document.getElementById("item-holder");if(!resizer||!holder){return false}var owner=resizer.parentNode;if(owner!==document.body&&owner===holder.parentNode&&owner.nodeName=="DIV"){lastSelectedItem=owner;owner.classList.remove("curr-design");owner.classList.add("in-moving");setTimeout(function(){owner.classList.remove("in-moving")},0);resizer.style.display="none";owner.removeChild(resizer);document.body.appendChild(resizer);holder.style.display="none";owner.removeChild(holder);document.body.appendChild(holder);var currLayer=lastSelectedItem.style.zIndex;if(currLayer){currLayer=parseInt(currLayer);if(currLayer>=10000){lastSelectedItem.style.zIndex=(currLayer-10000)+""}}hideWidgetHint();if(!startByReadonly_){try{if(lastPopEditId_&&apiNode.getPopContent&&isValidContent(lastPopEditNode_)){var sNew=apiNode.getPopContent(lastPopEditId_);if(typeof sNew=="string"&&sNew!="<nochange/>"&&sNew!="<error/>"){lastPopEditNode_.innerHTML=sNew;if(lastPopEditNode_.classList.contains("ebook-title")){updateDocTitle(lastPopEditNode_)}if(lastPopEditNode_.classList.contains("rotate-txt")){apiNode.remakeContent(lastPopEditNode_)}apiNode.setPageModified()}}}catch(e){}cancelInlineEdit()}return true}else{lastSelectedItem=null;return false}};el.swithScreen=function(){cfgMenu.style.display="none";if(PINP_FIX_SIZE){return}if(window.inPreview__==2){return}if(SLIDE_START_STYLE=="narrow"){if(!beenReadonly_){SLIDE_START_STYLE="wide";setSlideScreenStyle("wide");apiNode.setPageModified()}else{setSlideScreenStyle(SLIDE_HALF_WIDTH==450?"wide":"narrow")}}else{if(SLIDE_START_STYLE=="wide"){if(!beenReadonly_){SLIDE_START_STYLE="ebook";setSlideScreenStyle("ebook");apiNode.setPageModified()}else{setSlideScreenStyle(SLIDE_HALF_WIDTH==450?"wide":"narrow")}}else{if(!beenReadonly_){SLIDE_START_STYLE="narrow";setSlideScreenStyle("narrow");apiNode.setPageModified()}}}};el.currSlideIndex=function(){return curSlide||0};el.currSlideId=function(){var node=slideEls[curSlide];if(node){return node.id}else{return""}};el.totalSlides=function(){return slideEls.length};el.newSlideId=function(){var i=slideEls.length||0,sId="article-"+i;while(document.getElementById(sId)){i++;sId="article-"+i}return sId};var lastSvgPaperId=-1;el.newSvgPaper=function(){if(lastSvgPaperId<0){var b=document.querySelectorAll("div.svg-paper");lastSvgPaperId=b.length}while(document.querySelector('div.svg-paper[name="pp'+lastSvgPaperId+'"]')){lastSvgPaperId+=1}return"pp"+lastSvgPaperId};el.moveSlideTo=function(iFrom,iTo){if(beenReadonly_||apiNode.inEditing()){return false}if(iFrom<0||iFrom>=slideEls.length){return false}if(iFrom==iTo||iFrom+1==iTo){return false}var sourNode=slideEls[iFrom];if(iTo>=slideEls.length){sourNode.parentNode.appendChild(sourNode)}else{var targNode=slideEls[iTo];targNode.parentNode.insertBefore(sourNode,targNode)}apiNode.renewSlides();if(window.inPreview__==2){if(window.parent.window&&window.parent.window!==window){var b=[curSlide];for(var i=0,item;item=slideEls[i];i++){b.push(item.id||"")}var s="[PINPSLIDE_11]"+JSON.stringify({method:"slideChangeOrder",param:b});window.parent.window.postMessage(s,"*")}}else{setCookie__("nav_moveto"+SLIDE_GROUP_ID,"["+iFrom+","+iTo+"]")}return true};el.initPagePos=function(sId){var items=document.querySelectorAll("#"+sId+" > div");for(var i=0,item;item=items[i];i++){initDesignPos(item)}};el.renewSlides=function(){if(!PINP_IS_READY){return 0}slideEls=document.querySelectorAll("section.slides > article");resetChapterSects(slideEls);var len=slideEls.length;if(len&&curSlide>=len){curSlide=len-1}cancelInlineEdit();updateSlides();return len};var getUsePlugItem_=function(dUsed){var usedItem=[];for(var sUrl in usedPlugins_){var item=usedPlugins_[sUrl];var bCls=(item[2]||"").split(",");var added=false;for(var i=0,sCls;sCls=bCls[i];i++){if(dUsed[sCls]){usedItem.push(item);added=true;break}}if(!added){for(var i=0,sCls;sCls=bCls[i];i++){try{var node=document.querySelector("article > div."+sCls);if(node){dUsed[sCls]=true;usedItem.push(item);break}}catch(e){console.log(e)}}}}return usedItem};el.notifySaveSlide=function(){var dUsed={},usedItem=getUsePlugItem_(dUsed);var dAssit={},iAssitNum=0;for(var sCls in usedAssistor_){var item=usedAssistor_[sCls];if(dUsed[sCls]){dAssit[sCls]=item;iAssitNum+=1}else{try{var node=document.querySelector("article > div."+sCls);if(node){dUsed[sCls]=true;dAssit[sCls]=item;iAssitNum+=1}}catch(e){console.log(e)}}}var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else{if(window.ActiveXObject){req=new ActiveXObject("Microsoft.XMLHTTP")}}if(req){req.onreadystatechange=function(){if(req.readyState==4){if(req.status==200&&req.responseText=="OK"){if(apiNode.removePipeCache){apiNode.removePipeCache()}}else{alert("Save document failed!")}req=null}};var sUrl="/$update?title="+encodeURIComponent(document.title||"Presentation");sUrl+="&plugin="+encodeURIComponent(JSON.stringify(usedItem));var sKey=apiNode.keywordText();if(sKey){sUrl+="&key="+encodeURIComponent(sKey)}if(iAssitNum){sUrl+="&assist="+encodeURIComponent(JSON.stringify(dAssit))}req.open("GET",sUrl,true);req.send(null)}};el.setPageTagFrmt=function(i,s){var iTmp=SLIDE_PAGE_TAG&3;if(iTmp!=i||SLIDE_PAGE_FORMAT!=s){SLIDE_PAGE_TAG=(SLIDE_PAGE_TAG&4)+i;SLIDE_PAGE_FORMAT=s;if((SLIDE_PAGE_TAG&1)==1){document.getElementById("page-tag").style.display="block";document.getElementById("page-tag2").style.display="none"}else{if((SLIDE_PAGE_TAG&2)==2){document.getElementById("page-tag").style.display="none";document.getElementById("page-tag2").style.display="block"}else{document.getElementById("page-tag").style.display="none";document.getElementById("page-tag2").style.display="none"}}var titleNode=document.querySelector("section.slides > article > div.ebook-title");if(titleNode&&titleNode.textContent){sArticleTitle=extractDocTitle(titleNode)}setTimeout(function(){apiNode.renewSlides()},800)}};el.pageTurnPos=function(){return window.SLIDE_PAGE_UPDN||""};el.setPageTurnPos=function(s){var nodeL=document.getElementById("prev-slide-area"),nodeR=document.getElementById("next-slide-area");if(s){window.SLIDE_PAGE_UPDN=s;if(beenReadonly_&&nodeL&&nodeR){if(SLIDE_NO_TURNING){nodeL.innerHTML="";nodeR.innerHTML=""}else{nodeL.innerHTML="<div class='slide-updn left' style='top:"+window.SLIDE_PAGE_UPDN+"'></div>";nodeR.innerHTML="<div class='slide-updn right' style='top:"+window.SLIDE_PAGE_UPDN+"'></div>"}}}else{window.SLIDE_PAGE_UPDN="";if(nodeL&&nodeR){nodeL.innerHTML="";nodeR.innerHTML=""}}};el.setUseFrame=function(useFrame){noSlideFrame_=!useFrame;var item=document.querySelector("section.slides");if(item){if(useFrame){item.classList.remove("no-frame")}else{item.classList.add("no-frame")}}};el.setUseTrans=function(useTrans){noSlideTrans_=!useTrans;var item=document.querySelector("section.slides");if(item){if(useTrans){item.classList.remove("no-trans")}else{item.classList.add("no-trans")}}};el.setUseGround=function(useGround){noSlideGround_=!useGround;var item=document.querySelector("section.slides");if(item){if(useGround){item.classList.remove("no-ground")}else{item.classList.add("no-ground")}}};el.noPgTurning=function(){return SLIDE_NO_TURNING?1:0};el.setUseTurning=function(useTurning){window.SLIDE_NO_TURNING=useTurning?0:1};el.getDocTitle=function(){return document.title||"Presentation"};el.setWinTitle=function(s){};el.nextSlide=function(){if(!apiNode.inEditing()){nextSlide()}return curSlide||0};el.prevSlide=function(){if(!apiNode.inEditing()){prevSlide()}return curSlide||0};el.gotoPage=function(index,callback){if(!PINP_IS_READY){return}if(apiNode.inEditing()){return}if(index===curSlide){return}if(index===undefined){index=0}if(index<0){index+=slideEls.length}if(index>=slideEls.length){index=slideEls.length-1}if(index<0){index=0}cancelInlineEdit();curSlide=index;updateSlides(false,false,callback)};el.gotoSlide=function(index){var iPage=null;if(typeof index=="string"){var s=index.trim();if(s[0]=="+"){iPage=curSlide+parseInt(s.slice(1))}else{if(s[0]=="-"){iPage=curSlide-parseInt(s.slice(1))}else{iPage=parseInt(s)-1}}}else{if(typeof index=="number"){iPage=index-1}}if(typeof iPage=="number"){apiNode.gotoPage(iPage)}};el.gotoPage2=function(){if(beenReadonly_){var sPage=prompt("Goto page",lastGotoPage_+"");if(sPage){var iPage=parseInt(sPage);if(iPage<=0){iPage=1}if(iPage>slideEls.length){iPage=slideEls.length}lastGotoPage_=iPage;apiNode.gotoPage(iPage-1)}}};el.inEditing=function(){var maskArea=document.getElementById("dialog-mask");if(maskArea&&maskArea.style.display!="none"){return true}else{return false}};el.beenReadonly=function(){return beenReadonly_};el.runCseFile=function(sFile){};el.runJsFile=function(sFile){};el.delayBuildShape=function(node){setTimeout(function(){buildShape(node,true)},500)};el.setWidgetName=function(){if(!PINP_IS_READY){return}var node=getCurrSelected();if(node){var sName=window.prompt("Please enter widget name",node.getAttribute("name")||"");if(typeof sName=="string"){if(sName){node.setAttribute("name",sName);updateSlidesEx()}else{node.removeAttribute("name")}setPageModified_()}}};el.removePage=function(sId){if(!sId){return false}if(slideEls.length<=1){alert("can not delete last page!");return}var idx=0,node=null;for(var item;item=slideEls[idx];idx++){if(item.id==sId){node=item;break}}if(!node){return}if(idx==curSlide){if(apiNode.delCurrPage){apiNode.delCurrPage()}}else{apiNode.gotoPage(idx,function(){if(apiNode.delCurrPage){apiNode.delCurrPage()}})}};function getSvgPaperHtml(paper){var sHtml="";for(var i=0,item;item=paper.children[i];i++){if(item.classList.contains("svg-shape")){if(i==0){sHtml+="\n"}sHtml+=getCompnentHtml(item,true)}}return sHtml}var localUrlHead_="url("+location.protocol+"//"+location.hostname;if(location.port){localUrlHead_+=":"+location.port}localUrlHead_+="/";var localUrlHead2_="url("+window.CURR_USR_PATH;var leftRE=/;[ ]*left:.*?;/gm;var leftRE2=/^[ ]*left:.*?;/gm;var topRE=/;[ ]*top:.*?;/gm;var topRE2=/^[ ]*top:.*?;/gm;var widthRE=/;[ ]*width:.*?;/gm;var widthRE2=/^[ ]*width:.*?;/gm;var heightRE=/;[ ]*height:.*?;/gm;var heightRE2=/^[ ]*height:.*?;/gm;var inDesignRE=/\bin-design\u0020/g;var currDesignRE=/\bcurr-design\u0020/g;var multiSeleRE=/\bmulti-select\u0020/g;var inMovingRE=/\bin-moving\u0020/g;var preBuildRE=/\bprebuild-\d\u0020/g;var postBuildRE=/\bpostbuild-\d\u0020/g;function getCompnentHtml(item,inPaper){var css=item.style.cssText;css=css.replace(/\bz-index:.*;/gm,"");var zLevel=parseInt(item.getAttribute("_zindex")||"1000");if(zLevel>=10000){zLevel-=10000}var sPos=' _zindex="'+zLevel+'"';var sTitle=item.getAttribute("title");if(sTitle){sPos+=' title="'+sTitle.replace(/"/gm,"")+'"'}var sCfg=item.getAttribute("_config");if(sCfg){sPos+=' _config="'+sCfg+'"'}var sWidget=item.getAttribute("_widget");if(sWidget){sPos+=' _widget="'+sWidget.replace(/"/gm,"'")+'"'}var sPrepost=item.getAttribute("_prepost");if(sPrepost){sPos+=' _prepost="'+sPrepost+'"'}var sRotate=item.getAttribute("_rotate");if(sRotate){sPos+=' _rotate="'+sRotate+'"'}var sDefs=item.getAttribute("_defs");if(sDefs){sPos+=' _defs="'+sDefs+'"'}if(zLevel>=1){css=css.replace(leftRE,";").replace(leftRE2,"");css=css.replace(topRE,";").replace(topRE2,"");css=css.replace(widthRE,";").replace(widthRE2,"");css=css.replace(heightRE,";").replace(heightRE2,"");sPos+=' _left="'+(item.getAttribute("_left")||"0")+'"';sPos+=' _top="'+(item.getAttribute("_top")||"0")+'"';sPos+=' _width="'+(item.getAttribute("_width")||"200")+'"';if(item.hasAttribute("_height")){sPos+=' _height="'+item.getAttribute("_height")+'"'}}var sWdName=(item.getAttribute("name")||"");if(sWdName){sPos+=' name="'+sWdName+'"'}if(inPaper){var sFrom=item.getAttribute("_from");if(sFrom){sPos+=' _from="'+sFrom+'"'}var sAlign=item.getAttribute("_align");if(sAlign){sPos+=' _align="'+sAlign+'"'}var sToArr=item.getAttribute("_toarrow");if(sToArr){sPos+=' _toarrow="'+sToArr.replace(/"/gm,"'")+'"'}var sFromArr=item.getAttribute("_fromarrow");if(sFromArr){sPos+=' _fromarrow="'+sFromArr.replace(/"/gm,"'")+'"'}}css=css.trim();var sAddStyle=(item.getAttribute("_style")||"");if(sAddStyle){css=' style="'+sAddStyle+'"'}else{if(css){if(inPaper){css=""}else{css=css.replace(localUrlHead_,"url(/");css=css.replace(localUrlHead2_,"url(");css=' style="'+css.replace(/"/gm,"'")+'"'}}}var sClass=item.className+" ";sClass=sClass.replace(inDesignRE,"").replace(currDesignRE,"").replace(multiSeleRE,"").replace(inMovingRE,"");if(beenReadonly_){sClass=sClass.replace(preBuildRE,"").replace(postBuildRE,"")}sClass=sClass.trim();var sOnePg="<div";if(sClass){sOnePg+=' class="'+sClass+'"'}sOnePg+=sPos;if(css){sOnePg+=css}sOnePg+=">";if(!inPaper&&item.classList.contains("svg-paper")){sOnePg+=getSvgPaperHtml(item)}else{var inShape=item.classList.contains("pinp-shape")||item.classList.contains("svg-shape");var inMaker=item.classList.contains("pinp-make");for(var i4=0,item2;item2=item.childNodes[i4];i4++){var iType=item2.nodeType;if(iType==3){sOnePg+=item2.nodeValue}else{if(iType==1&&item2.id!="item-holder"&&item2.id!="item-resizer"){if(inShape){if(item2.classList.contains("shape-canvas")){var shapeStyle=item2.getAttribute("style");if(shapeStyle){sOnePg+="<div class='shape-canvas' style=\""+shapeStyle.replace(/"/gm,"'")+'"></div>'}else{sOnePg+="<div class='shape-canvas'></div>"}}else{sOnePg+=item2.outerHTML}}else{if(inMaker&&item2.classList.contains("pinp-maked")){}else{if(item2.nodeName=="IFRAME"){var ss,sCode="<iframe";var bTmp=["id","class","frameborder","border","display","_widget"];for(var i5=0,item3;item3=bTmp[i5];i5++){ss=item2.getAttribute(item3);if(ss){sCode+=" "+item3+'="'+ss+'"'}}ss=item2.getAttribute("_src");if(ss&&ss!="about:blank"){sCode+=' src="'+ss+'"'}else{ss=item2.getAttribute("src");if(ss){sCode+=' src="'+ss+'"'}}sOnePg+=sCode+">"+item2.innerHTML+"</iframe>"}else{sOnePg+=item2.outerHTML}}}}else{if(iType==8){sOnePg+="<!--"+item2.nodeValue+"-->"}}}}}sOnePg+="</div>\n";return sOnePg}var LastContentMenuAtX=0;var LastContentMenuAtY=0;var reuseOrCloneNode=function(item,noLazy){if(noLazy){if(hasRestoreAll_){return item}var targNode=item.cloneNode(true);var imgNodes=targNode.querySelectorAll("img[_lazy]");for(var i=0,item;item=imgNodes[i];i++){item.setAttribute("src",item.getAttribute("_lazy"));item.removeAttribute("_lazy")}return targNode}else{var targNode=item.cloneNode(true);var imgNodes=targNode.querySelectorAll("img[src]");for(var i=0,item;item=imgNodes[i];i++){item.setAttribute("_lazy",item.getAttribute("src"));item.removeAttribute("src")}return targNode}};var copyCurrItem_=function(byCtrlC){if(apiNode.inEditing()){return null}var node=getCurrSelected();if(!node){if(widgetSelector){var sLib="";var hasAny=false;var s="COMPONENT_OF_PINP_SLIDE,1,";for(var i=0,item;item=currSelectNode[i];i++){s+=getCompnentHtml(reuseOrCloneNode(item,true));hasAny=true;try{for(var i2=0,item2;item2=item.classList[i2];i2++){var libNode=document.querySelector('body > div.plugin-code > div[name="'+item2+'"]');if(libNode){sLib+="COMPONENT_OF_PINP_PLGIN,"+item2+","+libNode.outerHTML;break}}}catch(e){}}if(hasAny){return sLib+s}}var CurrSlide=slideEls[curSlide];if(CurrSlide&&!byCtrlC){var x=LastContentMenuAtX-CurrSlide.offsetLeft;var y=LastContentMenuAtY-CurrSlide.offsetTop;var hits=[];for(var i=0,item;item=CurrSlide.children[i];i++){if(x>=item.offsetLeft&&x<item.offsetLeft+item.clientWidth&&y>=item.offsetTop&&y<item.offsetTop+item.clientHeight){hits.push(item)}}var iLastLevel=1;for(var i=0,item;item=hits[i];i++){var z=parseInt(item.getAttribute("_zindex")||"0");if(z>=iLastLevel){node=item;iLastLevel=z}}if(node){var sLib="";for(var i2=0,item2;item2=node.classList[i2];i2++){var libNode=document.querySelector('body > div.plugin-code > div[name="'+item2+'"]');if(libNode){sLib="COMPONENT_OF_PINP_PLGIN,"+item2+","+libNode.outerHTML;break}}return sLib+"COMPONENT_OF_PINP_SLIDE,0,"+getCompnentHtml(reuseOrCloneNode(node,true))}}return null}if(node.nodeName!="DIV"){return null}var sLib="";for(var i2=0,item2;item2=node.classList[i2];i2++){var libNode=document.querySelector('body > div.plugin-code > div[name="'+item2+'"]');if(libNode){sLib="COMPONENT_OF_PINP_PLGIN,"+item2+","+libNode.outerHTML;break}}return sLib+"COMPONENT_OF_PINP_SLIDE,0,"+getCompnentHtml(reuseOrCloneNode(node,true))};el.copyItem=function(byCtrlC){cfgMenu.style.display="none";var s=copyCurrItem_(byCtrlC);if(typeof s=="string"){if(!byCtrlC){apiNode.copyToClipboard(s,LastContentMenuAtX,LastContentMenuAtY)}else{apiNode.copyToClipboard(s)}return true}return false};el.cutItem=function(){cfgMenu.style.display="none";if(beenReadonly_||apiNode.inEditing()){return}if(apiNode.copyItem(false)){apiNode.delDesignItem()}};var pastWdgtInPage=function(node,s,added,links,plugs,libDict,checkSvg){apiNode.innerHTML=s;var iOldNum=added.length;for(var i2=0,item2;item2=apiNode.children[i2];i2++){added.push(item2)}var childNum=added.length;if(childNum>iOldNum){for(var i2=iOldNum,item2;item2=added[i2];i2++){if(item2.classList.contains("svg-paper")){var sName=apiNode.newSvgPaper();item2.setAttribute("name",sName);var b=item2.querySelectorAll("div.svg-shape[_defs]");for(var i3=0,item3;item3=b[i3];i3++){var sName_=item3.getAttribute("_defs");item3.setAttribute("_defs",sName_.replace(/.*?-/,sName+"-"))}b=item2.querySelectorAll("div.img-resource > link");for(var i3=0,item3;item3=b[i3];i3++){links.push(item3)}setupSvgPaper(item2)}else{if(item2.classList.contains("svg-shape")){var iTmp=parseInt(item2.getAttribute("_left")||"0");if(checkSvg&&iTmp>400){item2.setAttribute("_left","400")}iTmp=parseInt(item2.getAttribute("_top")||"0");if(checkSvg&&iTmp>300){item2.setAttribute("_top","300")}var b=item2.querySelectorAll("div.img-resource > link");for(var i3=0,item3;item3=b[i3];i3++){links.push(item3)}}else{for(var i3=0,item3;item3=item2.classList[i3];i3++){var fn=libDict[item3];if(fn){plugs.push([fn,item2]);break}}}}node.appendChild(item2)}}apiNode.innerHTML="";return childNum-iOldNum};el.pasteItem=function(){cfgMenu.style.display="none";if(beenReadonly_||apiNode.inEditing()){return}var s=apiNode.textOfClipboard();var sPrefix="COMPONENT_OF_PINP_SLIDE,";var sPrefix2="COMPONENT_OF_PINP_PLGIN,";var iPosA=s.indexOf(sPrefix);var iPosB=s.indexOf(sPrefix2);var bLibCode=[];if(iPosB==0&&iPosA>0){while(true){var iPos=s.indexOf(sPrefix2,iPosB+1);if(iPos>0&&iPos<iPosA){bLibCode.push(s.slice(iPosB+sPrefix2.length,iPos));iPosB=iPos}else{bLibCode.push(s.slice(iPosB+sPrefix2.length,iPosA));break}}}if(iPosA>=0){s=s.slice(iPosA+sPrefix.length);var i=s.indexOf(",");if(i>=0){s=s.slice(i+1)}var node=slideEls[curSlide];if(node){var libDict={},b=[];for(var i2=0,item2;item2=bLibCode[i2];i2++){var iTmp=item2.indexOf(",");if(iTmp>0&&iTmp<64){var sName=item2.slice(0,iTmp);var libNode=apiNode.addPlugCode(sName,item2.slice(iTmp+1),true);if(libNode){b.push(sName)}}}setTimeout(function(){for(var i=0,sName;sName=b[i];i++){var dSpace=pluginOf(sName,true);if(dSpace&&dSpace.oncreated){libDict[sName]=dSpace.oncreated}}var currId=node.id;if(currId){var links=[],plugs=[],added=[];var childNum=pastWdgtInPage(node,s,added,links,plugs,libDict,true);if(childNum){apiNode.initPagePos(currId);apiNode.renewCurrSlide();setTimeout(function(){for(var i2=0,item2;item2=links[i2];i2++){requestOneSvg(item2)}for(var i2=0,item2;item2=plugs[i2];i2++){item2[0]({target:item2[1]})}},0);if(childNum==1){apiNode.selectLastAdded()}else{if(widgetSelector){for(var i3=0,item3;item3=added[i3];i3++){item3.classList.add("multi-select");currSelectNode.push(item3)}}}apiNode.setPageModified(currId)}}},10)}}};el.adjustSvgPaper=function(node){var links=[],papers=node.querySelectorAll("div.svg-paper");for(var i2=0,item2;item2=papers[i2];i2++){var sName=apiNode.newSvgPaper();item2.setAttribute("name",sName);var b=item2.querySelectorAll("div.svg-shape[_defs]");for(var i3=0,item3;item3=b[i3];i3++){var sName_=item3.getAttribute("_defs");item3.setAttribute("_defs",sName_.replace(/.*?-/,sName+"-"));item3._hasBuild=false;var b4=item2.querySelectorAll("div.img-resource > link");for(var i4=0,item4;item4=b4[i4];i4++){links.push(item4)}}}for(var i2=0,item2;item2=links[i2];i2++){requestOneSvg(item2)}};el.getPluginCode=function(formated){var bRet=[],sCode="";var codeRoot=document.querySelector("body > div.plugin-code");if(codeRoot){for(var i=0,item;item=codeRoot.children[i];i++){var sCls=item.getAttribute("name");if(item.nodeName=="DIV"&&sCls){var needAdd=false;if(formated&&sCls.indexOf("slideshow-")==0){needAdd=true}else{if(document.querySelector("section.slides > article > div."+sCls)){needAdd=true}}if(needAdd){if(formated){bRet.push([sCls,item.outerHTML])}else{if(sCode&&sCode[sCode.length-1]!="\n"){sCode+="\n"+item.outerHTML}else{sCode+=item.outerHTML}}}}}}return formated?bRet:sCode};el.getPageHtml=function(slide){if(!slide){return null}var sClass="",sOnePg="";for(var i2=0,ss;ss=slide.classList[i2];i2++){if(SLIDE_CLASSES.indexOf(ss)<0&&ss!="wide-screen"){if(sClass){sClass+=" "}sClass+=ss}}for(var i3=0,item;item=slide.children[i3];i3++){if(item.nodeName=="DIV"){sOnePg+=getCompnentHtml(reuseOrCloneNode(item,false))}}return[slide.id,sClass,sOnePg]};el.slideshowText=function(){var sOut="COMPONENT_OF_PINP_SLIDE,2,<page/>\n\n";var dUsed={},bPlugin=getUsePlugItem_(dUsed);var sPlugHtml="";for(var i=0,item;item=bPlugin[i];i++){var sHost=item[0]||"";var sPlgFile=item[1]||"";var sClsList=item[2]||"";var sType=item[3]||"";var sArg=item[4]||"";if(sPlgFile&&(sType.indexOf("text/")==0||sType.indexOf("image/")==0)){sPlugHtml+='<link rel="bookmark" type="'+sType+'"';if(sClsList){sPlugHtml+=' plugs="'+sClsList+'"'}if(sHost){sPlugHtml+=' host="'+sHost+'"'}sPlugHtml+=' href="'+sPlgFile+'"';if((sType=="text/javascript"||sType=="text/css")&&sArg){sPlugHtml+=' onload="'+sArg+'"'}sPlugHtml+=" />\n"}}if(sPlugHtml){sOut+="COMPONENT_OF_PINP_EXTFL,0,"+sPlugHtml}var bLib=apiNode.getPluginCode(true);for(var i=0,item;item=bLib[i];i++){sOut+="COMPONENT_OF_PINP_PLGIN,"+item[0]+","+item[1]+"\n"}var slides=document.querySelectorAll("section.slides > article");for(var i=0,slide;slide=slides[i];i++){var sOnePg="COMPONENT_OF_PINP_SLIDE,1,",iPgLen=sOnePg.length;for(var i3=0,item;item=slide.children[i3];i3++){if(item.nodeName=="DIV"){if(sOnePg.length>iPgLen){sOnePg+="\n"}sOnePg+=getCompnentHtml(reuseOrCloneNode(item,false))}}if(i>0){sOut+="COMPONENT_OF_PINP_SLIDE,2,<page/>\n"}if(sOnePg.length>iPgLen){sOut+="\n"+sOnePg+"\n"}}return sOut};el.articleHTML=function(){var slides=document.querySelectorAll("section.slides > article");var cssNode1=document.querySelector("#background-css");var cssNode2=document.querySelector("#logo-css");var s='<script type="text/javascript">\n';s+='SLIDE_START_STYLE = "'+SLIDE_START_STYLE+'";\n';s+="SLIDE_NO_TURNING = "+(SLIDE_NO_TURNING?1:0)+";\n";s+="SLIDE_PAGE_TAG = "+SLIDE_PAGE_TAG+";\n";s+='SLIDE_PAGE_FORMAT = "'+SLIDE_PAGE_FORMAT+'";\n';s+='SLIDE_PAGE_UPDN = "'+(window.SLIDE_PAGE_UPDN||"")+'";\n';s+='SLIDE_TITLE = "'+document.title.replace(/"/gm,"'")+'";\n';s+="<\/script>\n";var sCode=apiNode.getPluginCode();if(sCode){s+='<div class="plugin-code">\n'+sCode+"\n</div>\n"}s+="<section class='slides";if(noSlideFrame_){s+=" no-frame"}if(noSlideTrans_){s+=" no-trans"}if(noSlideGround_){s+=" no-ground"}s+=" template-default'>\n\n";if(cssNode1){s+="<style id='background-css'>\n"+cssNode1.innerHTML.trim()+"\n</style>\n"}if(cssNode2){s+="<style id='logo-css'>\n"+cssNode2.innerHTML.trim()+"\n</style>\n"}s+="\n";for(var i=0,slide;slide=slides[i];i++){var sClass="";for(var i2=0,ss;ss=slide.classList[i2];i2++){if(SLIDE_CLASSES.indexOf(ss)<0&&ss!="wide-screen"){if(sClass){sClass+=" "}sClass+=ss}}if(sClass){sClass=" class='"+sClass+"'"}var sOnePg="<article id='"+slide.id+"'"+sClass+">\n";for(var i3=0,item;item=slide.children[i3];i3++){if(item.nodeName=="DIV"){sOnePg+=getCompnentHtml(reuseOrCloneNode(item,false))}}s+=sOnePg+"</article>\n\n"}s+="</section>\n";return s};el.abstractText=function(){var node=document.querySelector("article > div.ebook-abstract");if(node){return node.textContent.trim()}else{return""}};el.keywordText=function(){var node=document.querySelector("article > div.ebook-keyword");if(node){return node.textContent.trim()}else{return""}};var lastSlidePgIndex=-1;window.onSlidePageChange=function(id){if(lastSlidePgIndex!=id){lastSlidePgIndex=id;if(window.inPreview__==2){if(window.parent.window&&window.parent.window!==window){var sMsg="[PINPSLIDE_11]"+JSON.stringify({method:"nav_shift",param:[id]});window.parent.window.postMessage(sMsg,"*")}}else{if(!SLIDE_HAS_PARENT){setCookie__("nav_shift"+SLIDE_GROUP_ID,id+"")}}}};window.addEventListener("resize",function(e){if(beenReadonly_&&PINP_FIX_SIZE&&(PINP_FIXSIZE_X||PINP_FIXSIZE_Y)){updateFixSize();var node=document.getElementById("prev-slide-area");if(node){if(window.SLIDE_PAGE_UPDN&&!SLIDE_NO_TURNING){node.innerHTML="<div class='slide-updn left' style='top:"+window.SLIDE_PAGE_UPDN+";left:0%;width:100%'></div>"}node.style.left=SLIDE_HALF_WIDTH+"px";node.style.top=SLIDE_HALF_HEIGHT+"px";node.style.width="50px";node.style.height=PINP_FIXSIZE_Y+"px";node.style.marginLeft="-"+SLIDE_HALF_WIDTH+"px";node.style.marginTop="-"+SLIDE_HALF_HEIGHT+"px"}node=document.getElementById("next-slide-area");if(node){if(window.SLIDE_PAGE_UPDN&&!SLIDE_NO_TURNING){node.innerHTML="<div class='slide-updn right' style='top:"+window.SLIDE_PAGE_UPDN+";left:0%;width:100%'></div>"}node.style.left=SLIDE_HALF_WIDTH+"px";node.style.top=SLIDE_HALF_HEIGHT+"px";node.style.width="50px";node.style.height=PINP_FIXSIZE_Y+"px";node.style.marginLeft=(SLIDE_HALF_WIDTH-50)+"px";node.style.marginTop="-"+SLIDE_HALF_HEIGHT+"px"}}var rootSect=document.querySelector("section.slides");if(rootSect){resetRootSect(rootSect,PINP_FIX_SIZE)}},false);updateSlides_();window.addEventListener("message",function(msg){if(typeof msg=="object"&&msg.data){msg=msg.data}try{msg=JSON.parse(msg.slice(14));if(msg instanceof Object){if(msg.method=="keydown"){if(!SLIDE_NO_TURNING){var event=msg.param[0];setTimeout(function(){handleDocKeyDown(event)},0)}}else{if(msg.method=="goto"){var sCmd=msg.param[0];if(sCmd=="prev"){setTimeout(function(){apiNode.prevSlide()},0)}else{if(sCmd=="next"){setTimeout(function(){apiNode.nextSlide()},0)}else{if(sCmd=="page"){var iPage=msg.param[1];setTimeout(function(){apiNode.gotoPage(iPage)},0)}}}}else{if(window.EXTERN_MSG_CALL){window.EXTERN_MSG_CALL(msg)}}}}}catch(e){console.log(e)}},false);setInterval(function(){if(apiNode.inEditing()){return}var sNav="";if(!SLIDE_HAS_PARENT){sNav=getCookie__("nav_index"+SLIDE_GROUP_ID)}if(lastModifyPageId&&!beenReadonly_){var nowTime=new Date();if(sNav||(nowTime.valueOf()-lastModifyTime.valueOf())>=800){var node=slideEls[curSlide];if(node&&node.id==lastModifyPageId){if(apiNode.savePageImg(lastModifyPageId)){var resUrl=CURR_USR_PATH+"$res/"+lastModifyPageId+".png";setCookie__("nav_setimg"+SLIDE_GROUP_ID,"["+curSlide+",'"+resUrl+"']")}apiNode.saveSlideDoc()}lastModifyPageId=""}}if(sNav){delCookie__("nav_index"+SLIDE_GROUP_ID);var i=parseInt(sNav);if(i!=curSlide){apiNode.gotoPage(i)}}if(!beenReadonly_&&!SLIDE_HAS_PARENT){var sPgId=getCookie__("nav_delete"+SLIDE_GROUP_ID);if(sPgId){delCookie__("nav_delete"+SLIDE_GROUP_ID);if(window.inPreview__!=2){apiNode.removePage(sPgId)}}}},1000);cfgMenu.innerHTML=(window.inPreview__==2?"<li class='by-widget' onclick='apiNode.dbclickEdit()'><a id='menu-0'>edit or config&nbsp;&nbsp;(double click)</a></li>":"")+(PINP_FIX_SIZE||window.inPreview__==2?"":"<li _allshow='1' onclick='apiNode.swithScreen()'><a id='menu-2' href='javascript:void(0)'>narrow/wide screen (F2)</a></li>")+(PINP_FIX_SIZE?"":"<li "+(window.inPreview__==2?"class='by-widget'":"_allshow='1'")+" onclick='apiNode.copyItem(false)'><a id='menu-9' href='javascript:void(0)'>copy widget"+(window.inPreview__==2?"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ctrl + c)":"")+"</a></li>")+(window.inPreview__==2?"<li class='by-widget' onclick='apiNode.cutItem()'><a id='menu-10' href='javascript:void(0)'>cut selected&nbsp;&nbsp;&nbsp;&nbsp;(ctrl + x)</a></li>":"")+(window.inPreview__==2?"<li class='by-widget' onclick='apiNode.pasteItem()'><a id='menu-11' href='javascript:void(0)'>paste widget&nbsp;&nbsp;&nbsp;&nbsp;(ctrl + v)</a></li>":"")+(window.inPreview__==2?"<li class='by-widget' onclick='apiNode.delDesignItem()'><a id='menu-12' href='javascript:void(0)'>delete selected&nbsp;(ctrl + del)</a></li>":"")+(window.inPreview__==2?"<li class='by-widget' onclick='apiNode.setPrePost()'><a id='menu-15' href='javascript:void(0)'>set widget pre-post</a></li>":"")+(window.inPreview__==2?"":"<li _allshow='1' onclick='apiNode.gotoPage2()'><a id='menu-22' href='javascript:void(0)'>goto page</a></li>");var pluinMenuCallback_=function(fn,node){return function(ev){ev.preventDefault();ev.stopPropagation();document.getElementById("slide-menu").style.display="none";apiNode.unselect();fn(node)}};document.oncontextmenu=function(ev){ev.preventDefault();LastContentMenuAtX=ev.clientX;LastContentMenuAtY=ev.clientY;var bList=cfgMenu.querySelectorAll("li.design-item");for(var index=0,item;item=bList[index];index++){item.parentNode.removeChild(item)}var node=getCurrSelected();var firstMenu=document.querySelector("#menu-0");if(node&&firstMenu){firstMenu=firstMenu.parentNode;var addCount=0,sCfg=node.getAttribute("_config")||"";sCfg=sCfg.trim();if(sCfg){var b=sCfg.split(/\u0020+/g);for(var i=0,item;item=b[i];i++){var b2=item.split("-"),iLen=b2.length;if(iLen){var sFound=item;for(var i2=0;i2<iLen;i2++){var ss=b2.join("-");if(node.classList.contains(ss)){sFound=ss;break}b2.push(b2.shift())}b2=sFound.split("-");if(b2.length>=2){var sMenuL=b2[0].replace("_"," ");var sMenuR=b2[1].replace("_"," ");var sTitle=sMenuL+" --&gt; "+sMenuR;if(b2.length>2){sTitle+=" --&gt; "}var newMenu=document.createElement("li");newMenu.className="design-item";newMenu.setAttribute("_config",sFound);newMenu.innerHTML="<a>"+sTitle+"</a>";newMenu.onclick=changeDesignCls;cfgMenu.insertBefore(newMenu,firstMenu);addCount++}}}if(node.classList.contains("code-block")){var preNode=node.querySelector("pre");if(preNode){var newMenu=document.createElement("li");newMenu.className="design-item";if(preNode.className.indexOf("linenums")>=0){newMenu.innerHTML="<a>remove "+preNode.className+"</a>";newMenu.onclick=onDelPreLnNum}else{newMenu.innerHTML="<a>add line number</a>";newMenu.onclick=onAddPreLnNum}cfgMenu.insertBefore(newMenu,firstMenu);addCount++}}else{if(node.classList.contains("pinp-goto")){var newMenu=document.createElement("li");newMenu.className="design-item";newMenu.innerHTML="<a>set goto page</a>";newMenu.onclick=onSetGotoPage;cfgMenu.insertBefore(newMenu,firstMenu);addCount++}else{if(node.classList.contains("pinp-delay")){var newMenu=document.createElement("li");newMenu.className="design-item";newMenu.innerHTML="<a>set delay time</a>";newMenu.onclick=onSetTimeDelay;cfgMenu.insertBefore(newMenu,firstMenu);addCount++}}}}for(var i2=0,sCls;sCls=node.classList[i2];i2++){var dSpace=pluginOf(sCls,true);if(dSpace&&dSpace.getPluginMenu){var b3=dSpace.getPluginMenu(node);if(b3&&b3.length){for(var i3=0,item3;item3=b3[i3];i3++){if(typeof item3[1]=="function"){var newMenu=document.createElement("li");newMenu.className="design-item";newMenu.innerHTML="<a>"+item3[0]+"</a>";newMenu.onclick=pluinMenuCallback_(item3[1],node);cfgMenu.insertBefore(newMenu,firstMenu);addCount++}}}}}if(addCount){var newMenu=document.createElement("li");newMenu.className="design-item";newMenu.innerHTML="<hr/>";cfgMenu.insertBefore(newMenu,firstMenu)}}if(beenReadonly_){var wdgtItems=cfgMenu.querySelectorAll("li");for(var index=0,wdgt;wdgt=wdgtItems[index];index++){var sVisible="none";if(!node&&wdgt.getAttribute("_allshow")){sVisible="block"}wdgt.style.display=sVisible}}else{var sVisible="none",sVisible2="block";if(node){sVisible="block";sVisible2="none"}var wdgtItems=cfgMenu.querySelectorAll("li.by-widget");for(var index=0;index<wdgtItems.length;index++){wdgtItems[index].style.display=sVisible}var wdgtItems2=cfgMenu.querySelectorAll("li.by-page");for(var index2=0;index2<wdgtItems2.length;index2++){wdgtItems2[index2].style.display=sVisible2}var cfgWdgt=cfgMenu.querySelector("li.cfg-widget");if(cfgWdgt){if(node&&(node.classList.contains("svg-shape")||node.classList.contains("pinp-mask")||node.classList.contains("pinp-gradient")||node.classList.contains("pinp-image")||node.classList.contains("pinp-shape"))){cfgWdgt.style.display="block"}else{cfgWdgt.style.display="none"}}}var iUsed=0;var menuItems=cfgMenu.getElementsByTagName("li");for(var index=0,item;item=menuItems[index];index++){if(item.style.display!="none"){iUsed+=1}item.onmouseover=function(){this.classList.add("active")};item.onmouseout=function(){this.classList.remove("active")}}if(iUsed==0){cfgMenu.style.display="none"}else{cfgMenu.style.display="block";cfgMenu.style.left=ev.clientX+"px";cfgMenu.style.top=ev.clientY+"px"}};if(!beenReadonly_){document.onmousedown=handleDomMouseDown;document.onmousemove=handleDomMouseMove;document.onmouseup=handleDomMouseUp;document.body.onunload=function(event){if(lastModifyPageId){lastModifyPageId="";apiNode.saveSlideDoc()}}}else{document.onmouseup=function(event){if(event.button==0){cfgMenu.style.display="none"}}}if(SLIDE_START_STYLE!="narrow"){setSlideScreenStyle(SLIDE_START_STYLE)}if(!SLIDE_HAS_PARENT){setCookie__("list_goto"+SLIDE_GROUP_ID,"1,/software/"+SOFTWARE_PRJ_NAME+"/shared");setCookie__("nav_shift"+SLIDE_GROUP_ID,curSlide+"")}}var regExprRgb=/\b(rgb|rgba)\s*\(([^)]*)\)/m;function parseRgbColor(e){var a=regExprRgb.exec(e);if(a){var c=a[2].split(",");for(var d=0,f;f=c[d];d++){if(d<3){c[d]=parseInt(f)||0}else{c[d]=parseFloat(f)}}return c}else{return null}}function quickShapeData(e,y,k,z){var v=e[0];var c=e[1];var j=e[2];var D=e[3];if(D===undefined){D=1}D=Math.min(Math.max(0,D),1);var h=Math.floor(D*255+0.5);var t=y[0];var E=y[1];var f=y[2];var C=y[3];if(C===undefined){C=1}C=Math.min(Math.max(0,C),1);var p=Math.floor(C*255+0.5);var n=z.data;var w=n.length/4;for(var u=0,q=-1;u<w;u++){var m=n[++q];var x=n[++q];var A=n[++q];var B=n[++q];var o=false,d=false,l=false,s=false;if(B==255){if(x==0&&A==0&&m==0){d=true}else{if(m==192&&x==192&&A==192){l=true}else{if(m==255&&x==255&&A==255){o=true}else{if(m==128&&x==128&&A==128){s=true}}}}}if(o){n[q]=0;n[q-3]=0;n[q-2]=0;n[q-1]=0}else{if(l){n[q]=h;n[q-3]=v;n[q-2]=c;n[q-1]=j}else{if(d){n[q]=p;n[q-3]=t;n[q-2]=E;n[q-1]=f}else{if(s){n[q]=Math.floor(C*128+0.5);n[q-3]=t;n[q-2]=E;n[q-1]=f}}}}}}function buildShape(node,rebuild){while(node){if(node.classList.contains("pinp-shape")){break}node=node.parentNode}if(!node){return}var imgNodes=node.querySelectorAll("div.img-resource > img");var imgNum=imgNodes.length;if(imgNum<1||imgNum>5){return}for(var i=0,img;img=imgNodes[i];i++){if(!img.complete){return}}if(node._hasBuild&&!rebuild){return}node._hasBuild=true;var iForeGate,bForeColor,iBackGate,bBackColor,bBackFill,scaleRate;var cfgData=node.getAttribute("_widget")||"null";cfgData=window.eval(cfgData);if(cfgData instanceof Array&&cfgData.length>=4){iForeGate=cfgData[0];iForeGate=iForeGate=="outline"?2:(iForeGate=="shape"?1:0);bForeColor=parseRgbColor(cfgData[1]);if(!(bForeColor instanceof Array)){return}iBackGate=cfgData[2];iBackGate=iBackGate=="outline"?2:(iBackGate=="shape"?1:0);bBackColor=parseRgbColor(cfgData[3]);if(!(bBackColor instanceof Array)){return}bBackFill=parseRgbColor(cfgData[4]||"rgba(0,0,0,0)");if(!(bBackFill instanceof Array)){return}scaleRate=parseFloat(cfgData[5]||"0")}else{return}if(imgNum==1&&iForeGate==2&&iBackGate==1){var item=imgNodes[0];item.crossOrigin="Anonymous";var cvs=document.createElement("canvas");cvs.width=item.naturalWidth;cvs.height=item.naturalHeight;var ctx=cvs.getContext("2d");ctx.drawImage(item,0,0);var imgData=ctx.getImageData(0,0,cvs.width,cvs.height);quickShapeData(bBackColor,bForeColor,cvs,imgData);ctx.putImageData(imgData,0,0);var ownerNode=node.querySelector("div.shape-canvas");ownerNode.innerHTML="";var targCanvas=document.createElement("canvas");targCanvas.width=parseInt(node.getAttribute("_width")||"0")||ownerNode.clientWidth;targCanvas.height=parseInt(node.getAttribute("_height")||"0")||ownerNode.clientHeight;var targCtx=targCanvas.getContext("2d");targCtx.drawImage(cvs,0,0,targCanvas.width,targCanvas.height);ownerNode.appendChild(targCanvas)}}function setupSvgDataUrl(j,i,c,d,k){var h="",g=0,b=/<g\b.*?\b_widget=.*?>/gm;var a=/\bstroke='.*?'/m,f=/\bfill='.*?'/m,l=/\bstroke-width='.*?'/m,n=/\bstroke-dasharray='.*?'/m;var e=b.exec(j);while(e){var o=e[0];h+=j.slice(g,e.index);g=e.index+o.length;o=o.replace(a,"stroke='"+i+"'").replace(f,"fill='"+c+"'").replace(l,"stroke-width='"+d+"'").replace(n,"stroke-dasharray='"+k+"'");h+=o;e=b.exec(j)}if(g<j.length){h+=j.slice(g)}return h}function getAngleLen(b,j,a,h){var e=a-b,d=h-j;var k=Math.abs(e);var g=Math.abs(d);var f=Math.sqrt(k*k+g*g);var i=Math.acos(g/f);var c=180/(Math.PI/i);if(e>0){return[f,(d>0)?(90-c):(270+c)]}else{return[f,(d>0)?(90+c):(270-c)]}}function getCtrlPoint(v,f,t,e,r,d,q,c){var l=0.35,k=0.333;if(v===undefined){if(q===undefined){return[t,e,r,d]}var g=getAngleLen(t,e,r,d),A=g[0];var o=getAngleLen(r,d,q,c),h=o[0];var y=Math.abs(o[1]-g[1]);if(y>180){y=360-y}if(y>=90){l=0.38;k=0.333-0.266*(y-90)/180}else{k=0.2+0.266*y/180}var x=(A*l)/h;var b=r-x*(q-r);var B=d-x*(c-d);var j=b-(b-t)*k;var i=B-(B-e)*k;var u=t+(b-t)*k;var s=e+(B-e)*k;return[u,s,j,i]}else{var w=getAngleLen(v,f,t,e),p=w[0];var g=getAngleLen(t,e,r,d),A=g[0];var y=Math.abs(g[1]-w[1]);if(y>180){y=360-y}if(y>=90){l=0.38;k=0.333-0.266*(y-90)/180}else{k=0.2+0.266*y/180}var z=(A*l)/p;var n=t+z*(t-v);var m=e+z*(e-f);var u=n+(r-n)*k;var s=m+(d-m)*k;var j,i;if(q===undefined){j=r-(r-n)*k;i=d-(d-m)*k}else{var o=getAngleLen(r,d,q,c),h=o[0];var y=Math.abs(o[1]-g[1]);if(y>180){y=360-y}if(y>=90){l=0.38;k=0.333-0.266*(y-90)/180}else{k=0.2+0.266*y/180}var x=(A*l)/h;var b=r-x*(q-r);var B=d-x*(c-d);j=b-(b-t)*k;i=B-(B-e)*k}return[u,s,j,i]}}var ARROW_SIDE_FACTOR=4;function buildShape2(node,rebuild,resizing){while(node){if(node.classList.contains("svg-shape")){break}node=node.parentNode}if(!node){return}var bTmp=[],imgNodes=node.querySelectorAll("div.img-resource > link");var imgNum=imgNodes.length;if(imgNum<1||imgNum>3){return}for(var i=0,item;item=imgNodes[i];i++){var data=jsonOfSvg_[item.href];if(!data||data instanceof Array){return}bTmp.push(data)}imgNodes=bTmp;if(node._hasBuild&&!rebuild){return}node._hasBuild=true;var sForeColor,sBackColor,iStyle,iStrokeWd=3,sStrokeDash="",fixFirst=false;var cfgData=node.getAttribute("_widget")||"null";cfgData=window.eval(cfgData);if(cfgData instanceof Array&&cfgData.length>=3){sForeColor=cfgData[0];sBackColor=cfgData[1];iStyle=parseInt(cfgData[2]);if(iStyle>=8){fixFirst=true;iStyle-=8}if(cfgData.length>=4){iStrokeWd=parseInt(cfgData[3]);if(iStrokeWd<=0){iStrokeWd=1}}if(cfgData.length>=5){var subCfg=cfgData[4];if(subCfg instanceof Array&&subCfg.length>=1){sStrokeDash=subCfg[0]}}}else{return}var iWholeWd,iWholeHi,ownerNode=node.querySelector("div.shape-canvas");if(!ownerNode){return}if(resizing){iWholeWd=node.clientWidth;iWholeHi=node.clientHeight}else{iWholeWd=parseInt(node.getAttribute("_width")||"200");iWholeHi=parseInt(node.getAttribute("_height")||"60")}if((iStyle==-1||iStyle==-2)&&cfgData.length>=5&&imgNum==1){var _svg=imgNodes[0],arrowCfg=cfgData[4],iLen=arrowCfg.length;if(iLen<8){return}var preType=arrowCfg[2],postType=arrowCfg[3];var sDashArray="stroke-dasharray='"+sStrokeDash+"' ";var defId=node.getAttribute("_defs")||"mrk_";var preMarker="",preDef="";if(preType>=1){var preTag="mrk"+preType+"_start";preDef=_svg[preTag];if(!preDef){return}var preTag2=defId+"_start";preDef=preDef.replace(preTag,preTag2);preMarker="marker-start='url(#"+preTag2+")' "}var postMarker="",postDef="";if(postType>=1){var postTag="mrk"+postType+"_end";postDef=_svg[postTag];if(!postDef){return}var postTag2=defId+"_end";postDef=postDef.replace(postTag,postTag2);postMarker="marker-end='url(#"+postTag2+")' "}var iSideGap=Math.floor(iStrokeWd*2.5+0.5);iSideGap*=ARROW_SIDE_FACTOR;if(iWholeWd<=iSideGap+iSideGap||iWholeHi<=iSideGap+iSideGap){ownerNode.innerHTML="";return}var iWd=0,iHi=0;for(var i=5;i<iLen;i+=2){var x=arrowCfg[i-1],y=arrowCfg[i];if(x>iWd){iWd=x}if(y>iHi){iHi=y}}var rateX=iWd==0?0:(iWholeWd-iSideGap-iSideGap)/iWd;var rateY=iHi==0?0:(iWholeHi-iSideGap-iSideGap)/iHi;var bNew=[],lastPtX=undefined,lastPtY=undefined;for(var i=5;i<iLen;i+=2){var iCurX=arrowCfg[i-1]*rateX+iSideGap;var iCurY=arrowCfg[i]*rateY+iSideGap;if(lastPtX!==iCurX||lastPtY!==iCurY){bNew.push(iCurX,iCurY);lastPtX=iCurX;lastPtY=iCurY}}var sPoints="",sPath="";if(iStyle==-1){var iNewLen=bNew.length;for(var i=1;i<iNewLen;i+=2){if(i>1){sPoints+=" "}sPoints+=bNew[i-1]+","+bNew[i]}}else{var iNewLen=bNew.length;if(iNewLen==4){sPath="M"+bNew[0]+" "+bNew[1]+"L"+bNew[2]+" "+bNew[3]}else{bNew.unshift(undefined,undefined);iNewLen+=2;sPath="M"+bNew[2]+" "+bNew[3];for(var i=3;i<iNewLen;i+=2){var x1=bNew[i-3],y1=bNew[i-2],x2=bNew[i-1],y2=bNew[i];if(i<=iNewLen-3){var x3=bNew[i+1],y3=bNew[i+2],x4=undefined,y4=undefined;if(i<=iNewLen-5){x4=bNew[i+3];y4=bNew[i+4]}var ctrls=getCtrlPoint(x1,y1,x2,y2,x3,y3,x4,y4);sPath+="C"+ctrls[0]+" "+ctrls[1]+" "+ctrls[2]+" "+ctrls[3]+" "+x3+" "+y3}else{break}}}}var sRect='width="'+iWholeWd+'" height="'+iWholeHi+'" viewPort="0 0 '+iWholeWd+" "+iWholeHi+'" ';var sHtml="<svg "+sRect+'version="1.1" xmlns="http://www.w3.org/2000/svg">';sHtml+="<g _widget='null' stroke='rgb(54,54,54)' fill='rgb(54,54,54)' "+sDashArray+"stroke-width='3'>";if(preDef||postDef){sHtml+="<defs>"+preDef+postDef+"</defs>"}if(iStyle==-1){sHtml+="<polyline "+preMarker+postMarker+"fill='rgba(0,0,0,0)' points='"+sPoints+"'/>"}else{sHtml+="<path "+preMarker+postMarker+"fill='rgba(0,0,0,0)' d='"+sPath+"'/>"}sHtml+="</g></svg>";ownerNode.innerHTML=setupSvgDataUrl(sHtml,sForeColor,sBackColor,iStrokeWd,sStrokeDash);return}if(imgNum==1){var _svg=imgNodes[0],sHtml=_svg.svg,iWd=_svg.width,iHi=_svg.height;var sRect='width="'+iWholeWd+'" height="'+iWholeHi+'" viewPort="0 0 '+iWd+" "+iHi+'" ';if(!_svg.scalable){sHtml='<g transform="scale('+iWholeWd/iWd+","+iWholeHi/iHi+')">'+sHtml+"</g>"}sHtml="<svg "+sRect+'version="1.1" xmlns="http://www.w3.org/2000/svg">'+sHtml+"</svg>";ownerNode.innerHTML=setupSvgDataUrl(sHtml,sForeColor,sBackColor,iStrokeWd,sStrokeDash)}else{if(imgNum==2){var _svg=imgNodes[0],_svg2=imgNodes[1];var sHtml=_svg.svg,sHtml2=_svg2.svg;var iWd=_svg.width,iHi=_svg.height,iWd2=_svg2.width,iHi2=_svg2.height;if(iStyle==1){if(iHi!=iHi2){return}if(_svg.scalable||_svg2.scalable){return}var x,x2,svgWd=iHi*iWholeWd/iWholeHi;if(fixFirst){x=iWd;x2=svgWd-iWd;if(x2<=0){ownerNode.innerHTML="";return}sHtml2='<g transform="translate('+(x-1)+",0) scale("+((x2+1)/iWd2)+',1)">'+sHtml2+"</g>";sHtml=sHtml+sHtml2}else{x=svgWd-iWd2;x2=iWd2;if(x<=0){ownerNode.innerHTML="";return}sHtml='<g transform="scale('+((x+1)/iWd)+',1)">'+sHtml+"</g>";sHtml2='<g transform="translate('+x+',0)">'+sHtml2+"</g>";sHtml=sHtml2+sHtml}var sRect='width="'+iWholeWd+'" height="'+iWholeHi+'" viewPort="0 0 '+svgWd+" "+iHi+'" ';var fScale=iWholeHi/iHi;sHtml="<svg "+sRect+'version="1.1" xmlns="http://www.w3.org/2000/svg"><g transform="scale('+fScale+","+fScale+')">'+sHtml+"</g></svg>";ownerNode.innerHTML=setupSvgDataUrl(sHtml,sForeColor,sBackColor,iStrokeWd,sStrokeDash)}else{if(iStyle==2){if(iWd!=iWd2){return}if(_svg.scalable||_svg2.scalable){return}var y,y2,svgHi=iWd*iWholeHi/iWholeWd;if(fixFirst){y=iHi;y2=svgHi-iHi;if(y2<=0){ownerNode.innerHTML="";return}sHtml2='<g transform="translate(0,'+(y-1)+") scale(1,"+((y2+1)/iHi2)+')">'+sHtml2+"</g>";sHtml=sHtml+sHtml2}else{y=svgHi-iHi2;y2=iHi2;if(y<=0){ownerNode.innerHTML="";return}sHtml='<g transform="scale(1,'+((y+1)/iHi)+')">'+sHtml+"</g>";sHtml2='<g transform="translate(0,'+y+')">'+sHtml2+"</g>";sHtml=sHtml2+sHtml}var sRect='width="'+iWholeWd+'" height="'+iWholeHi+'" viewPort="0 0 '+iWd+" "+svgHi+'" ';var fScale=iWholeWd/iWd;sHtml="<svg "+sRect+'version="1.1" xmlns="http://www.w3.org/2000/svg"><g transform="scale('+fScale+","+fScale+')">'+sHtml+"</g></svg>";ownerNode.innerHTML=setupSvgDataUrl(sHtml,sForeColor,sBackColor,iStrokeWd,sStrokeDash)}}}else{if(imgNum==3){var _svg=imgNodes[0],_svg2=imgNodes[1],_svg3=imgNodes[2];var sHtml=_svg.svg,sHtml2=_svg2.svg,sHtml3=_svg3.svg;var iWd=_svg.width,iHi=_svg.height,iWd2=_svg2.width,iHi2=_svg2.height,iWd3=_svg3.width,iHi3=_svg3.height;if(iStyle==1){if(iHi!=iHi2||iHi2!=iHi3){return}if(_svg.scalable||_svg2.scalable||_svg3.scalable){return}var x,x2,x3,svgWd=iHi*iWholeWd/iWholeHi;if(fixFirst){x=iWd;x2=svgWd-iWd-iWd3;x3=iWd3;if(x2<=0){ownerNode.innerHTML="";return}sHtml2='<g transform="translate('+(x-1)+",0) scale("+((x2+2)/iWd2)+',1)">'+sHtml2+"</g>";sHtml3='<g transform="translate('+(x+x2)+',0)">'+sHtml3+"</g>";sHtml=sHtml+sHtml3+sHtml2}else{x=(svgWd-iWd2)*iWd/(iWd+iWd3);x2=iWd2;x3=svgWd-x-iWd2;if(x<=0||x3<=0){ownerNode.innerHTML="";return}sHtml='<g transform="scale('+((x+1)/iWd)+',1)">'+sHtml+"</g>";sHtml2='<g transform="translate('+x+',0)">'+sHtml2+"</g>";sHtml3='<g transform="translate('+(x+x2-1)+",0) scale("+((x3+1)/iWd3)+',1)">'+sHtml3+"</g>";sHtml=sHtml2+sHtml+sHtml3}var sRect='width="'+iWholeWd+'" height="'+iWholeHi+'" viewPort="0 0 '+svgWd+" "+iHi+'" ';var fScale=iWholeHi/iHi;sHtml="<svg "+sRect+'version="1.1" xmlns="http://www.w3.org/2000/svg"><g transform="scale('+fScale+","+fScale+')">'+sHtml+"</g></svg>";ownerNode.innerHTML=setupSvgDataUrl(sHtml,sForeColor,sBackColor,iStrokeWd,sStrokeDash)}else{if(iStyle==2){if(iWd!=iWd2||iWd2!=iWd3){return}if(_svg.scalable||_svg2.scalable||_svg3.scalable){return}var y,y2,y3,svgHi=iWd*iWholeHi/iWholeWd;if(fixFirst){y=iHi;y2=svgHi-iHi-iHi3;y3=iHi3;if(y2<=0){ownerNode.innerHTML="";return}sHtml2='<g transform="translate(0,'+(y-1)+") scale(1,"+((y2+2)/iHi2)+')">'+sHtml2+"</g>";sHtml3='<g transform="translate(0,'+(y+y2)+')">'+sHtml3+"</g>";sHtml=sHtml+sHtml3+sHtml2}else{y=(svgHi-iHi2)*iHi/(iHi+iHi3);y2=iHi2;y3=svgHi-y-y2;if(y<=0||y3<=0){ownerNode.innerHTML="";return}sHtml='<g transform="scale(1,'+((y+1)/iHi)+')">'+sHtml+"</g>";sHtml2='<g transform="translate(0,'+y+')">'+sHtml2+"</g>";sHtml3='<g transform="translate(0,'+(y+y2-1)+") scale(1,"+((y3+1)/iHi3)+')">'+sHtml3+"</g>";sHtml=sHtml2+sHtml+sHtml3}var sRect='width="'+iWholeWd+'" height="'+iWholeHi+'" viewPort="0 0 '+iWd+" "+svgHi+'" ';var fScale=iWholeWd/iWd;sHtml="<svg "+sRect+'version="1.1" xmlns="http://www.w3.org/2000/svg"><g transform="scale('+fScale+","+fScale+')">'+sHtml+"</g></svg>";ownerNode.innerHTML=setupSvgDataUrl(sHtml,sForeColor,sBackColor,iStrokeWd,sStrokeDash)}}}}}}var jsonOfSvg_={};function requestOneSvg(c){var d=jsonOfSvg_[c.href];if(d){if(d instanceof Array){d.push(c)}else{buildShape2(c)}return}var b=null;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{if(window.ActiveXObject){b=new ActiveXObject("Microsoft.XMLHTTP")}}if(!b){return}var a=[c];jsonOfSvg_[c.href]=a;b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200||b.status==0){jsonOfSvg_[c.href]=JSON.parse(b.responseText);for(var e=0,f;f=a[e];e++){buildShape2(f)}}a=null;b=null}};b.open("GET",c.href,true);b.send(null)}function prepareSvgRes(c){if(jsonOfSvg_[c.href]){return}var b=null;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{if(window.ActiveXObject){b=new ActiveXObject("Microsoft.XMLHTTP")}}if(!b){return}var a=[c];jsonOfSvg_[c.href]=a;b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200||b.status==0){jsonOfSvg_[c.href]=JSON.parse(b.responseText);for(var d=0,e;e=a[d];d++){buildShape2(e)}}a=null;b=null}};b.open("GET",c.href,true);b.send(null)}function resetSvgColor(node,sStrokeClr,sFillClr,fOpacity){var sWidget=node.getAttribute("_widget")||"null";var cfgData=window.eval(sWidget);var iStrokeWd=3;if(cfgData instanceof Array&&cfgData.length>=3){if(!sStrokeClr){sStrokeClr=cfgData[0]}if(!sFillClr){sFillClr=cfgData[1]}if(cfgData.length>=4){iStrokeWd=parseInt(cfgData[3]);if(iStrokeWd<1){iStrokeWd=1}}}else{return}if(typeof fOpacity=="number"){var b=parseRgbColor(sStrokeClr);if(b.length>=3){sStrokeClr="rgba("+b[0]+","+b[1]+","+b[2]+","+fOpacity+")"}else{return}b=parseRgbColor(sFillClr);if(b.length>=3){sFillClr="rgba("+b[0]+","+b[1]+","+b[2]+","+fOpacity+")"}else{return}}cfgData[0]=sStrokeClr;cfgData[1]=sFillClr;node.setAttribute("_widget",JSON.stringify(cfgData).replace(/"/gm,"'"));var groups=node.querySelectorAll("g[_widget]");for(var i=0,item;item=groups[i];i++){item.setAttribute("stroke",sStrokeClr);item.setAttribute("fill",sFillClr);if(item.hasAttribute("stroke-width")){item.setAttribute("stroke-width",iStrokeWd)}}}(function(){var d={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:l,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:l,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:l,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};d.bullet=/(?:[*+-]|\d+\.)/;d.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/;d.item=c(d.item,"gm")(/bull/g,d.bullet)();d.list=c(d.list)(/bull/g,d.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+d.def.source+")")();d.blockquote=c(d.blockquote)("def",d.def)();d._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b";d.html=c(d.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,d._tag)();d.paragraph=c(d.paragraph)("hr",d.hr)("heading",d.heading)("lheading",d.lheading)("blockquote",d.blockquote)("tag","<"+d._tag)("def",d.def)();d.normal=i({},d);d.gfm=i({},d.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/});d.gfm.paragraph=c(d.paragraph)("(?!","(?!"+d.gfm.fences.source.replace("\\1","\\2")+"|"+d.list.source.replace("\\1","\\3")+"|")();d.tables=i({},d.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/});function b(m){this.tokens=[];this.tokens.links={};this.options=m||a.defaults;this.rules=d.normal;if(this.options.gfm){if(this.options.tables){this.rules=d.tables}else{this.rules=d.gfm}}}b.rules=d;b.lex=function(o,m){var n=new b(m);return n.lex(o)};b.prototype.lex=function(m){m=m.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n");return this.token(m,true)};b.prototype.token=function(n,t,x){var n=n.replace(/^ +$/gm,""),r,p,v,s,u,w,m,q,o;while(n){if(v=this.rules.newline.exec(n)){n=n.substring(v[0].length);if(v[0].length>1){this.tokens.push({type:"space"})}}if(v=this.rules.code.exec(n)){n=n.substring(v[0].length);v=v[0].replace(/^ {4}/gm,"");this.tokens.push({type:"code",text:!this.options.pedantic?v.replace(/\n+$/,""):v});continue}if(v=this.rules.fences.exec(n)){n=n.substring(v[0].length);this.tokens.push({type:"code",lang:v[2],text:v[3]});continue}if(v=this.rules.heading.exec(n)){n=n.substring(v[0].length);this.tokens.push({type:"heading",depth:v[1].length,text:v[2]});continue}if(t&&(v=this.rules.nptable.exec(n))){n=n.substring(v[0].length);w={type:"table",header:v[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:v[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:v[3].replace(/\n$/,"").split("\n")};for(q=0;q<w.align.length;q++){if(/^ *-+: *$/.test(w.align[q])){w.align[q]="right"}else{if(/^ *:-+: *$/.test(w.align[q])){w.align[q]="center"}else{if(/^ *:-+ *$/.test(w.align[q])){w.align[q]="left"}else{w.align[q]=null}}}}for(q=0;q<w.cells.length;q++){w.cells[q]=w.cells[q].split(/ *\| */)}this.tokens.push(w);continue}if(v=this.rules.lheading.exec(n)){n=n.substring(v[0].length);this.tokens.push({type:"heading",depth:v[2]==="="?1:2,text:v[1]});continue}if(v=this.rules.hr.exec(n)){n=n.substring(v[0].length);this.tokens.push({type:"hr"});continue}if(v=this.rules.blockquote.exec(n)){n=n.substring(v[0].length);this.tokens.push({type:"blockquote_start"});v=v[0].replace(/^ *> ?/gm,"");this.token(v,t,true);this.tokens.push({type:"blockquote_end"});continue}if(v=this.rules.list.exec(n)){n=n.substring(v[0].length);s=v[2];this.tokens.push({type:"list_start",ordered:s.length>1});v=v[0].match(this.rules.item);r=false;o=v.length;q=0;for(;q<o;q++){w=v[q];m=w.length;w=w.replace(/^ *([*+-]|\d+\.) +/,"");if(~w.indexOf("\n ")){m-=w.length;w=!this.options.pedantic?w.replace(new RegExp("^ {1,"+m+"}","gm"),""):w.replace(/^ {1,4}/gm,"")}if(this.options.smartLists&&q!==o-1){u=d.bullet.exec(v[q+1])[0];if(s!==u&&!(s.length>1&&u.length>1)){n=v.slice(q+1).join("\n")+n;q=o-1}}p=r||/\n\n(?!\s*$)/.test(w);if(q!==o-1){r=w.charAt(w.length-1)==="\n";if(!p){p=r}}this.tokens.push({type:p?"loose_item_start":"list_item_start"});this.token(w,false,x);this.tokens.push({type:"list_item_end"})}this.tokens.push({type:"list_end"});continue}if(v=this.rules.html.exec(n)){n=n.substring(v[0].length);this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:v[1]==="pre"||v[1]==="script"||v[1]==="style",text:v[0]});continue}if((!x&&t)&&(v=this.rules.def.exec(n))){n=n.substring(v[0].length);this.tokens.links[v[1].toLowerCase()]={href:v[2],title:v[3]};continue}if(t&&(v=this.rules.table.exec(n))){n=n.substring(v[0].length);w={type:"table",header:v[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:v[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:v[3].replace(/(?: *\| *)?\n$/,"").split("\n")};for(q=0;q<w.align.length;q++){if(/^ *-+: *$/.test(w.align[q])){w.align[q]="right"}else{if(/^ *:-+: *$/.test(w.align[q])){w.align[q]="center"}else{if(/^ *:-+ *$/.test(w.align[q])){w.align[q]="left"}else{w.align[q]=null}}}}for(q=0;q<w.cells.length;q++){w.cells[q]=w.cells[q].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */)}this.tokens.push(w);continue}if(t&&(v=this.rules.paragraph.exec(n))){n=n.substring(v[0].length);this.tokens.push({type:"paragraph",text:v[1].charAt(v[1].length-1)==="\n"?v[1].slice(0,-1):v[1]});continue}if(v=this.rules.text.exec(n)){n=n.substring(v[0].length);this.tokens.push({type:"text",text:v[0]});continue}if(n){throw new Error("Infinite loop on byte: "+n.charCodeAt(0))}}return this.tokens};var h={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:l,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:l,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};h._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/;h._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/;h.link=c(h.link)("inside",h._inside)("href",h._href)();h.reflink=c(h.reflink)("inside",h._inside)();h.normal=i({},h);h.pedantic=i({},h.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/});h.gfm=i({},h.normal,{escape:c(h.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:c(h.text)("]|","~]|")("|","|https?://|")()});h.breaks=i({},h.gfm,{br:c(h.br)("{2,}","*")(),text:c(h.gfm.text)("{2,}","*")()});function j(m,n){this.options=n||a.defaults;this.links=m;this.rules=h.normal;this.renderer=this.options.renderer||new f;this.renderer.options=this.options;if(!this.links){throw new Error("Tokens array requires a `links` property.")}if(this.options.gfm){if(this.options.breaks){this.rules=h.breaks}else{this.rules=h.gfm}}else{if(this.options.pedantic){this.rules=h.pedantic}}}j.rules=h;j.output=function(p,m,n){var o=new j(m,n);return o.output(p)};j.prototype.output=function(r){var n="",p,q,m,o;while(r){if(o=this.rules.escape.exec(r)){r=r.substring(o[0].length);n+=o[1];continue}if(o=this.rules.autolink.exec(r)){r=r.substring(o[0].length);if(o[2]==="@"){q=o[1].charAt(6)===":"?this.mangle(o[1].substring(7)):this.mangle(o[1]);m=this.mangle("mailto:")+q}else{q=k(o[1]);m=q}n+=this.renderer.link(m,null,q);continue}if(!this.inLink&&(o=this.rules.url.exec(r))){r=r.substring(o[0].length);q=k(o[1]);m=q;n+=this.renderer.link(m,null,q);continue}if(o=this.rules.tag.exec(r)){if(!this.inLink&&/^<a /i.test(o[0])){this.inLink=true}else{if(this.inLink&&/^<\/a>/i.test(o[0])){this.inLink=false}}r=r.substring(o[0].length);n+=this.options.sanitize?k(o[0]):o[0];continue}if(o=this.rules.link.exec(r)){r=r.substring(o[0].length);this.inLink=true;n+=this.outputLink(o,{href:o[2],title:o[3]});this.inLink=false;continue}if((o=this.rules.reflink.exec(r))||(o=this.rules.nolink.exec(r))){r=r.substring(o[0].length);p=(o[2]||o[1]).replace(/\s+/g," ");p=this.links[p.toLowerCase()];if(!p||!p.href){n+=o[0].charAt(0);r=o[0].substring(1)+r;continue}this.inLink=true;n+=this.outputLink(o,p);this.inLink=false;continue}if(o=this.rules.strong.exec(r)){r=r.substring(o[0].length);n+=this.renderer.strong(this.output(o[2]||o[1]));continue}if(o=this.rules.em.exec(r)){r=r.substring(o[0].length);n+=this.renderer.em(this.output(o[2]||o[1]));continue}if(o=this.rules.code.exec(r)){r=r.substring(o[0].length);n+=this.renderer.codespan(k(o[2],true));continue}if(o=this.rules.br.exec(r)){r=r.substring(o[0].length);n+=this.renderer.br();continue}if(o=this.rules.del.exec(r)){r=r.substring(o[0].length);n+=this.renderer.del(this.output(o[1]));continue}if(o=this.rules.text.exec(r)){r=r.substring(o[0].length);n+=k(this.smartypants(o[0]));continue}if(r){throw new Error("Infinite loop on byte: "+r.charCodeAt(0))}}return n};j.prototype.outputLink=function(n,o){var m=k(o.href),p=o.title?k(o.title):null;return n[0].charAt(0)!=="!"?this.renderer.link(m,p,this.output(n[1])):this.renderer.image(m,p,k(n[1]))};j.prototype.smartypants=function(m){if(!this.options.smartypants){return m}return m.replace(/--/g,"\u2014").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")};j.prototype.mangle=function(q){var n="",m=q.length,o=0,p;for(;o<m;o++){p=q.charCodeAt(o);if(Math.random()>0.5){p="x"+p.toString(16)}n+="&#"+p+";"}return n};function f(m){this.options=m||{}}f.prototype.code=function(n,p,o){if(this.options.highlight){var m=this.options.highlight(n,p);if(m!=null&&m!==n){o=true;n=m}}if(!p){return"<pre><code>"+(o?n:k(n,true))+"\n</code></pre>"}return'<pre><code class="'+this.options.langPrefix+k(p,true)+'">'+(o?n:k(n,true))+"\n</code></pre>\n"};f.prototype.blockquote=function(m){return"<blockquote>\n"+m+"</blockquote>\n"};f.prototype.html=function(m){return m};f.prototype.heading=function(n,o,m){return"<h"+o+' id="'+this.options.headerPrefix+m.toLowerCase().replace(/[^\w]+/g,"-")+'">'+n+"</h"+o+">\n"};f.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"};f.prototype.list=function(m,n){var o=n?"ol":"ul";return"<"+o+">\n"+m+"</"+o+">\n"};f.prototype.listitem=function(m){return"<li>"+m+"</li>\n"};f.prototype.paragraph=function(m){return"<p>"+m+"</p>\n"};f.prototype.table=function(n,m){return"<table>\n<thead>\n"+n+"</thead>\n<tbody>\n"+m+"</tbody>\n</table>\n"};f.prototype.tablerow=function(m){return"<tr>\n"+m+"</tr>\n"};f.prototype.tablecell=function(p,n){var o=n.header?"th":"td";var m=n.align?"<"+o+' style="text-align:'+n.align+'">':"<"+o+">";return m+p+"</"+o+">\n"};f.prototype.strong=function(m){return"<strong>"+m+"</strong>"};f.prototype.em=function(m){return"<em>"+m+"</em>"};f.prototype.codespan=function(m){return"<code>"+m+"</code>"};f.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"};f.prototype.del=function(m){return"<del>"+m+"</del>"};f.prototype.link=function(m,r,q){if(this.options.sanitize){try{var o=decodeURIComponent(g(m)).replace(/[^\w:]/g,"").toLowerCase()}catch(p){return""}if(o.indexOf("javascript:")===0||o.indexOf("vbscript:")===0){return""}}var n='<a href="'+m+'"';if(r){n+=' title="'+r+'"'}n+=">"+q+"</a>";return n};f.prototype.image=function(m,p,o){var n='<img src="'+m+'" alt="'+o+'"';if(p){n+=' title="'+p+'"'}n+=this.options.xhtml?"/>":">";return n};function e(m){this.tokens=[];this.token=null;this.options=m||a.defaults;this.options.renderer=this.options.renderer||new f;this.renderer=this.options.renderer;this.renderer.options=this.options}e.parse=function(o,m,n){var p=new e(m,n);return p.parse(o)};e.prototype.parse=function(n){this.inline=new j(n.links,this.options,this.renderer);this.tokens=n.reverse();var m="";while(this.next()){m+=this.tok()}return m};e.prototype.next=function(){return this.token=this.tokens.pop()};e.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0};e.prototype.parseText=function(){var m=this.token.text;while(this.peek().type==="text"){m+="\n"+this.next().text}return this.inline.output(m)};e.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var q="",s="",o,u,t,m,n;t="";for(o=0;o<this.token.header.length;o++){m={header:true,align:this.token.align[o]};t+=this.renderer.tablecell(this.inline.output(this.token.header[o]),{header:true,align:this.token.align[o]})}q+=this.renderer.tablerow(t);for(o=0;o<this.token.cells.length;o++){u=this.token.cells[o];t="";for(n=0;n<u.length;n++){t+=this.renderer.tablecell(this.inline.output(u[n]),{header:false,align:this.token.align[n]})}s+=this.renderer.tablerow(t)}return this.renderer.table(q,s);case"blockquote_start":var s="";while(this.next().type!=="blockquote_end"){s+=this.tok()}return this.renderer.blockquote(s);case"list_start":var s="",r=this.token.ordered;while(this.next().type!=="list_end"){s+=this.tok()}return this.renderer.list(s,r);case"list_item_start":var s="";while(this.next().type!=="list_item_end"){s+=this.token.type==="text"?this.parseText():this.tok()}return this.renderer.listitem(s);case"loose_item_start":var s="";while(this.next().type!=="list_item_end"){s+=this.tok()}return this.renderer.listitem(s);case"html":var p=!this.token.pre&&!this.options.pedantic?this.inline.output(this.token.text):this.token.text;return this.renderer.html(p);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};function k(m,n){return m.replace(!n?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function g(m){return m.replace(/&([#\w]+);/g,function(o,p){p=p.toLowerCase();if(p==="colon"){return":"}if(p.charAt(0)==="#"){return p.charAt(1)==="x"?String.fromCharCode(parseInt(p.substring(2),16)):String.fromCharCode(+p.substring(1))}return""})}function c(o,n){o=o.source;n=n||"";return function m(p,q){if(!p){return new RegExp(o,n)}q=q.source||q;q=q.replace(/(^|[^\[])\^/g,"$1");o=o.replace(p,q);return m}}function l(){}l.exec=l;function i(p){var n=1,o,m;for(;n<arguments.length;n++){o=arguments[n];for(m in o){if(Object.prototype.hasOwnProperty.call(o,m)){p[m]=o[m]}}}return p}function a(m,o,u){if(u||typeof o==="function"){if(!u){u=o;o=null}o=i({},a.defaults,o||{});var p=o.highlight,t,n,r=0;try{t=b.lex(m,o)}catch(s){return u(s)}n=t.length;var q=function(w){if(w){o.highlight=p;return u(w)}var v;try{v=e.parse(t,o)}catch(x){w=x}o.highlight=p;return w?u(w):u(null,v)};if(!p||p.length<3){return q()}delete o.highlight;if(!n){return q()}for(;r<t.length;r++){(function(v){if(v.type!=="code"){return --n||q()}return p(v.text,v.lang,function(x,w){if(x){return q(x)}if(w==null||w===v.text){return --n||q()}v.text=w;v.escaped=true;--n||q()})})(t[r])}return}try{if(o){o=i({},a.defaults,o)}return e.parse(b.lex(m,o),o)}catch(s){s.message+="\nPlease report this to https://github.com/chjj/marked.";if((o||a.defaults).silent){return"<p>An error occured:</p><pre>"+k(s.message+"",true)+"</pre>"}throw s}}a.options=a.setOptions=function(m){i(a.defaults,m);return a};a.defaults={gfm:true,tables:true,breaks:false,pedantic:false,sanitize:false,smartLists:false,silent:false,highlight:null,langPrefix:"lang-",smartypants:false,headerPrefix:"",renderer:new f,xhtml:false};a.Parser=e;a.parser=e.parse;a.Renderer=f;a.Lexer=b;a.lexer=b.lex;a.InlineLexer=j;a.inlineLexer=j.output;a.parse=a;this.marked=a}).call(function(){return this||(typeof window!=="undefined"?window:global)}());(function(){if(!window.HTMLCanvasElement||!document.addEventListener){alert("The version of your web browser is too low for PINP Slide");return}window.addEventListener("load",function(c){PINP_IS_READY=true;var d=slideEls[curSlide];if(!d){return}var e=d.parentNode;e.ontouchstart=function(b){};resetRootSect(e,PINP_FIX_SIZE);updateSlides();if(window.parent.window&&window.parent.window!==window&&beenReadonly_){window.onSwitchSlideOk=function(l){var i=l.target;i.removeEventListener(TRANS_END_FUNC,window.onSwitchSlideOk);var b="[PINPSLIDE_11]"+JSON.stringify({method:"enter",param:[curSlide,slideEls.length]});window.parent.window.postMessage(b,"*")};var h=[];for(var f=0,j;j=slideEls[f];f++){h.push(j.id||"")}var a=slideEls[0].getBoundingClientRect();var k="[PINPSLIDE_11]"+JSON.stringify({method:"loaded",param:[SOFTWARE_PRJ_NAME,a.left,a.top,a.width,a.height,h]});window.parent.window.postMessage(k,"*")}if(PINP_FIX_AUTO&&slideEls.length>1){var g=!e.classList.contains("no-trans");setInterval(function(){if(curSlide<slideEls.length-1){apiNode.nextSlide()}else{if(g){e.classList.add("no-trans");apiNode.gotoPage(0);setTimeout(function(){e.classList.remove("no-trans")},0)}else{apiNode.gotoPage(0)}}},PINP_FIX_AUTO*1000)}},false);document.addEventListener("DOMContentLoaded",handleDomLoaded,false)})();
