(function(){var a=this,c,b,f;if(typeof exports!=="undefined"){c=exports}else{c=a.Gh3={}}c.VERSION="1.0.0";c.access_token="";b=function(){};b.inherits=function(g,e,i){var k,h=function(){},j=function(l,m){for(var n in m){l[n]=m[n]}};if(e&&e.hasOwnProperty("constructor")){k=e.constructor}else{k=function(){g.apply(this,arguments)}}j(k,g);h.prototype=g.prototype;k.prototype=new h();if(e){j(k.prototype,e)}if(i){j(k,i)}k.prototype.constructor=k;k.__super__=g.prototype;return k};b.extend=function(e,g){var h=b.inherits(this,e,g);h.extend=this.extend;return h};f={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decode:function(h){var e="";var p,n,l;var o,m,k,j;var g=0;h=h.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(g<h.length){o=this._keyStr.indexOf(h.charAt(g++));m=this._keyStr.indexOf(h.charAt(g++));k=this._keyStr.indexOf(h.charAt(g++));j=this._keyStr.indexOf(h.charAt(g++));p=(o<<2)|(m>>4);n=((m&15)<<4)|(k>>2);l=((k&3)<<6)|j;e=e+String.fromCharCode(p);if(k!=64){e=e+String.fromCharCode(n)}if(j!=64){e=e+String.fromCharCode(l)}}e=f._utf8_decode(e);return e},encode:function(h){var e="";var p,n,l,o,m,k,j;var g=0;h=f._utf8_encode(h);while(g<h.length){p=h.charCodeAt(g++);n=h.charCodeAt(g++);l=h.charCodeAt(g++);o=p>>2;m=((p&3)<<4)|(n>>4);k=((n&15)<<2)|(l>>6);j=l&63;if(isNaN(n)){k=j=64}else{if(isNaN(l)){j=64}}e=e+this._keyStr.charAt(o)+this._keyStr.charAt(m)+this._keyStr.charAt(k)+this._keyStr.charAt(j)}return e},_utf8_decode:function(e){var g="";var h=0;var j=c1=c2=0;while(h<e.length){j=e.charCodeAt(h);if(j<128){g+=String.fromCharCode(j);h++}else{if((j>191)&&(j<224)){c2=e.charCodeAt(h+1);g+=String.fromCharCode(((j&31)<<6)|(c2&63));h+=2}else{c2=e.charCodeAt(h+1);c3=e.charCodeAt(h+2);g+=String.fromCharCode(((j&15)<<12)|((c2&63)<<6)|(c3&63));h+=3}}}return g},_utf8_encode:function(g){g=g.replace(/\r\n/g,"\n");var e="";for(var i=0;i<g.length;i++){var h=g.charCodeAt(i);if(h<128){e+=String.fromCharCode(h)}else{if((h>127)&&(h<2048)){e+=String.fromCharCode((h>>6)|192);e+=String.fromCharCode((h&63)|128)}else{e+=String.fromCharCode((h>>12)|224);e+=String.fromCharCode(((h>>6)&63)|128);e+=String.fromCharCode((h&63)|128)}}}return e}};c.Base64=f;if(window.XDomainRequest!=null){try{new XDomainRequest();$.support.cors=true;$.ajaxSetup.xhr=function(){return new XDomainRequest()}}catch(d){}}c.Helper=b.extend({},{protocol:"https",domain:"api.github.com",callHttpApi:function(e){var su=c.Helper.protocol+"://"+c.Helper.domain+"/"+e.service;if(Gh3.access_token)su+=(su.indexOf("?")>=0?"&":"?")+"access_token="+Gh3.access_token;e.url=su;if($.support.cors){var g=e.success;if($.isFunction(g)){e.success=function(i,j,h){g.call(this,{data:i},j,h)}}}else{e.dataType="jsonp"}$.ajax(e)}});c.Users=b.extend({},{users:[],search:function(e,g,h){c.Users.users=[];c.Helper.callHttpApi({service:"legacy/user/search/"+e,data:g,success:function(i){_.each(i.data.users,function(j){c.Users.users.push(new c.User(j.login,j))});if(h){h(null,c.Users)}},error:function(i){if(h){h(new Error(i.responseJSON.message),i)}}})},reverse:function(){c.Users.users.reverse()},sort:function(e){if(e){c.Users.users.sort(e)}else{c.Users.users.sort()}},getAll:function(){return c.Users.users},getByName:function(e){return _.find(c.Users.users,function(g){return g.name==e})},each:function(e){_.each(c.Users.users,function(g){e(g)})},filter:function(e){return _.filter(c.Users.users,e)}});c.User=b.extend({constructor:function(e,g){if(g){for(var h in g){this[h]=g[h]}}if(e){this.login=e}else{throw"login !"}},fetch:function(g){var e=this;c.Helper.callHttpApi({service:"users/"+e.login,success:function(h){for(var i in h.data){e[i]=h.data[i]}if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})}},{});c.GistComment=b.extend({constructor:function(e){for(var g in e){this[g]=e[g]}}},{});c.Gist=b.extend({constructor:function(e){for(var g in e){this[g]=e[g]}},fetchContents:function(g){var e=this;e.files=[];c.Helper.callHttpApi({service:"gists/"+e.id,success:function(i){for(var h in i.data.files){e.files.push(i.data.files[h])}delete i.data.files;for(var j in i.data){e[j]=i.data[j]}if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},fetchComments:function(g){var e=this;e.comments=[];c.Helper.callHttpApi({service:"gists/"+e.id+"/comments",success:function(h){_.each(h.data,function(i){e.comments.push(new c.GistComment(i))});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},getFileByName:function(e){return _.find(this.files,function(g){return g.filename==e})},getFiles:function(){return this.files},eachFile:function(e){_.each(this.files,function(g){e(g)})},getComments:function(){return this.comments},eachComment:function(e){_.each(this.comments,function(g){e(g)})},filterComments:function(e){return _.filter(this.comments,e)}},{});c.Gists=b.extend({constructor:function(e){if(e){this.user=e}this.gists=[]},fetch:function(e,h,i){var g=this;c.Helper.callHttpApi({service:"users/"+g.user.login+"/gists",data:e,success:function(j){_.each(j.data,function(k){g.gists.push(new c.Gist(k))});if(i){i(null,g)}},error:function(j){if(i){i(new Error(j.responseJSON.message),j)}}})},getGists:function(){return this.gists},eachGist:function(e){_.each(this.gists,function(g){e(g)})},filter:function(e){return _.filter(this.gists,e)}},{});c.CommitComment=b.extend({constructor:function(e){for(var g in e){this[g]=e[g]}}},{});c.Commit=b.extend({constructor:function(g,e,h){this.author=g.commit.author;this.date=g.commit.author.date;this.message=g.commit.message;this.sha=g.sha;this.url=g.url;if(e){this.user=e}if(h){this.repositoryName=h}},fetchComments:function(g){var e=this;e.comments=[];c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.repositoryName+"/commits/"+e.sha+"/comments",success:function(h){_.each(h.data,function(i){e.comments.push(new c.CommitComment(i))});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}},beforeSend:function(h){h.setRequestHeader("Accept","application/vnd.github.v3.full+json")}})},getComments:function(){return this.comments},eachComment:function(e){_.each(this.comments,function(g){e(g)})}},{});c.ItemContent=b.extend({constructor:function(g,h,i,e){for(var j in g){this[j]=g[j]}if(h){this.user=h}if(i){this.repositoryName=i}if(e){this.branchName=e}}},{});c.File=c.ItemContent.extend({constructor:function(g,h,i,e){c.File.__super__.constructor.call(this,g,h,i,e)},fetchContent:function(g){var e=this;c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.repositoryName+"/contents/"+e.path,success:function(h){e.content=h.data.content;e.rawContent=f.decode(h.data.content);e.sha=h.data.sha;e.size=h.data.size;if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},fetchCommits:function(g){var e=this;e.commits=[];c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.repositoryName+"/commits",data:{path:e.path,sha:e.branchName},success:function(h){_.each(h.data,function(i){e.commits.push(new c.Commit(i,e.user,e.repositoryName))});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},getRawContent:function(){return this.rawContent},getCommits:function(){return this.commits},getLastCommit:function(){return this.commits[0]},getFirstCommit:function(){return this.commits[this.commits.length-1]},eachCommit:function(e){_.each(this.commits,function(g){e(g)})},filterCommits:function(e){return _.filter(this.commits,e)},reverseCommits:function(){this.commits.reverse()},sortCommits:function(e){if(e){this.commits.sort(e)}else{this.commits.sort()}}},{});c.Dir=c.ItemContent.extend({constructor:function(g,h,i,e){c.Dir.__super__.constructor.call(this,g,h,i,e)},fetchContents:function(g){var e=this;e.contents=[];c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.repositoryName+"/contents/"+e.path,data:{ref:e.branchName},success:function(h){_.each(h.data,function(i){if(i.type=="file"){e.contents.push(new c.File(i,e.user,e.repositoryName,e.branchName))}if(i.type=="dir"){e.contents.push(new c.Dir(i,e.user,e.repositoryName,e.branchName))}});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},reverseContents:function(){this.contents.reverse()},sortContents:function(e){if(e){this.contents.sort(e)}else{this.contents.sort()}},getContents:function(){return this.contents},getFileByName:function(e){return _.find(this.contents,function(g){return g.name==e&&g.type=="file"})},getDirByName:function(e){return _.find(this.contents,function(g){return g.name==e&&g.type=="dir"})},eachContent:function(e){_.each(this.contents,function(g){e(g)})},filterContents:function(e){return _.filter(this.contents,e)}},{});c.Branch=b.extend({constructor:function(h,e,g,i,j){if(h){this.name=h}if(e){this.sha=e}if(g){this.url=g}if(i){this.user=i}if(j){this.repositoryName=j}},fetchContents:function(g){var e=this;e.contents=[];c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.repositoryName+"/contents/",data:{ref:e.name},success:function(h){_.each(h.data,function(i){if(i.type=="file"){e.contents.push(new c.File(i,e.user,e.repositoryName,e.name))}if(i.type=="dir"){e.contents.push(new c.Dir(i,e.user,e.repositoryName,e.name))}});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},reverseContents:function(){this.contents.reverse()},sortContents:function(e){if(e){this.contents.sort(e)}else{this.contents.sort()}},getContents:function(){return this.contents},getFileByName:function(e){return _.find(this.contents,function(g){return g.name==e&&g.type=="file"})},getDirByName:function(e){return _.find(this.contents,function(g){return g.name==e&&g.type=="dir"})},eachContent:function(e){_.each(this.contents,function(g){e(g)})},filterContents:function(e){return _.filter(this.contents,e)}},{});c.Issue=b.extend({constructor:function(g,e,h,i){if(g){this.number=g}if(e){this.user=e}if(h){this.repositoryName=h}if(i){for(var j in i){this[j]=i[j]}}},fetchContents:function(g){var e=this;c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.repositoryName+"/issues/"+e.id,success:function(h){_.each(h.data,function(i){for(var j in h.data){e[j]=h.data[j]}});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})}},{});c.Pull=b.extend({constructor:function(g,e,h,i){if(g){this.number=g}if(e){this.user=e}if(h){this.repositoryName=h}if(i){for(var j in i){this[j]=i[j]}}},fetchContents:function(g){var e=this;c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.repositoryName+"/pulls/"+e.id,success:function(h){_.each(h.data,function(i){for(var j in h.data){e[j]=h.data[j]}});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})}},{});c.Repository=b.extend({constructor:function(e,g,h){if(h){for(var i in h){this[i]=h[i]}}if(e){this.name=e}if(g){this.user=g}},fetch:function(g){var e=this;c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.name,success:function(h){for(var i in h.data){e[i]=h.data[i]}if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},fetchBranches:function(g){var e=this;e.branches=[];c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.name+"/branches",success:function(h){_.each(h.data,function(i){e.branches.push(new c.Branch(i.name,i.commit.sha,i.commit.url,e.user,e.name))});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},fetchIssues:function(g){var e=this;e.issues=[];c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.name+"/issues",data:{sort:"updated"},success:function(h){_.each(h.data,function(i){e.issues.push(new c.Issue(i.number,i.user,e.name,i))});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},fetchClosedIssues:function(g){var e=this;e.issues=[];c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.name+"/issues",data:{state:"closed",sort:"updated"},success:function(h){_.each(h.data,function(i){e.issues.push(new c.Issue(i.number,i.user,e.name,i))});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},fetchPulls:function(g){var e=this;e.pulls=[];c.Helper.callHttpApi({service:"repos/"+e.user.login+"/"+e.name+"/pulls",data:{sort:"updated"},success:function(h){_.each(h.data,function(i){e.pulls.push(new c.Pull(i.number,i.user,e.name,i))});if(g){g(null,e)}},error:function(h){if(g){g(new Error(h.responseJSON.message),h)}}})},getBranches:function(){return this.branches},getBranchByName:function(e){return _.find(this.branches,function(g){return g.name==e})},eachBranch:function(e){_.each(this.branches,function(g){e(g)})},reverseBranches:function(){this.branches.reverse()},sortBranches:function(e){if(e){this.branches.sort(e)}else{this.branches.sort()}},getIssues:function(){return this.issues},eachIssue:function(e){_.each(this.issues,function(g){e(g)})},reverseIssues:function(){this.issues.reverse()},getPulls:function(){return this.pulls},eachPull:function(e){_.each(this.pulls,function(g){e(g)})},reversePulls:function(){this.pulls.reverse()}},{});c.Repositories=b.extend({constructor:function(e){if(e){this.user=e}},fetch:function(e,h,i){var g=this;g.repositories=[];c.Helper.callHttpApi({service:"users/"+g.user.login+"/repos",data:e,success:function(j){_.each(j.data,function(k){g.repositories.push(new c.Repository(k.name,g.user))});if(i){i(null,g)}},error:function(j){if(i){i(new Error(j.responseJSON.message),j)}}})},reverseRepositories:function(){this.repositories.reverse()},sortRepositories:function(e){if(e){this.repositories.sort(e)}else{this.repositories.sort()}},getRepositories:function(){return this.repositories},getRepositoryByName:function(e){return _.find(this.repositories,function(g){return g.name==e})},eachRepository:function(e){_.each(this.repositories,function(g){e(g)})},filterRepositories:function(e){return _.filter(this.repositories,e)}},{repositories:[],search:function(e,g,h){c.Repositories.repositories=[];c.Helper.callHttpApi({service:"legacy/repos/search/"+e,data:g,success:function(i){_.each(i.data.repositories,function(j){c.Repositories.repositories.push(new c.Repository(j.name,new c.User(j.owner),j))});if(h){h(null,c.Repositories)}},error:function(i){if(h){h(new Error(i.responseJSON.message),i)}}})},reverse:function(){c.Repositories.repositories.reverse()},sort:function(e){if(e){c.Repositories.repositories.sort(e)}else{c.Repositories.repositories.sort()}},getAll:function(){return c.Repositories.repositories},getByName:function(e){return _.find(c.Repositories.repositories,function(g){return g.name==e})},each:function(e){_.each(c.Repositories.repositories,function(g){e(g)})},filter:function(e){return _.filter(c.Repositories.repositories,e)}});c.Search=b.extend({},{repos:function(g,e,h){c.Search._template(g,e,h,"search/repositories",function(i){return new c.Repository(i.name,new c.User(i.owner),i)})},code:function(g,e,h){c.Search._template(g,e,h,"search/code")},issues:function(h,e,i){var g=/.*\/(.*)\/issues\/.*/;c.Search._template(h,e,i,"search/issues",function(j){var k=g.exec(j.html_url);if(k&&k[1]){return new c.Issue(j.number,j.user,k[1],j)}else{return null}})},users:function(g,e,h){c.Search._template(g,e,h,"search/users",function(i){return new c.User(i.login,i)})},_template:function(j,h,k,e,g){var i=$.extend({},j,h);c.Helper.callHttpApi({service:e+"?"+decodeURIComponent($.param(i)),success:function(m,n,o){var l=[];if(g){_.each(m.data.items,function(p){var q=g(p);if(q){l.push(q)}})}else{l=m.data.items}if(k){k(null,l)}},error:function(l){if(k){k(new Error(l.responseJSON.message),l)}}})}})}).call(this);
